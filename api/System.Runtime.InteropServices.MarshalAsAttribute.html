<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class MarshalAsAttribute
   | CoreCLR site </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class MarshalAsAttribute
   | CoreCLR site ">
    
    <link rel="shortcut icon" href="../images/Logo_DotNet.png" type="image/x-icon">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/style.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-63735192-1', 'auto');
    ga('send', 'pageview');
    </script>
  </head>  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav class="navbar navbar-inverse">
             <div class="container">
               <a href="../"><img height="50px" src="../images/Logo_DotNet.png" style="float:right;"></a>
               <div class="navbar-header ">
                 <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                   <span class="sr-only">Toggle navigation</span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                 </button>
                 <a class="navbar-brand" href="../"><span class="dotnet">.NET Core</span></a>
               </div>
               <div id="navbar" class="collapse navbar-collapse">
               </div><!--/.nav-collapse -->
             </div>
           </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content">
              
              <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="pull-right mobile-hide"><span class="fa fa-github"></span>Improve this Doc</a>
              <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L656" class="pull-right mobile-hide">View Source</a>
              <h1 id="System_Runtime_InteropServices_MarshalAsAttribute" data-uid="System.Runtime.InteropServices.MarshalAsAttribute">Class MarshalAsAttribute
              </h1>
              <div class="markdown level0 summary"><p>Indicates how to marshal the data between managed and unmanaged code.</p>
</div>
              <div class="markdown level0 conceptual"></div>
              <div class="inheritance">
                <h5>Inheritance</h5>
                  <div class="level0"><a class="xref" href="System.Object.html#System_Object">Object</a></div>
                  <div class="level1"><span class="xref">MarshalAsAttribute</span></div>
              </div>
              <h6><strong>Namespace</strong>:System.Runtime.InteropServices</h6>
              <h6><strong>Assembly</strong>:System.Runtime.InteropServices.dll</h6>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_syntax">Syntax</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public sealed class MarshalAsAttribute : Attribute</code></pre>
              </div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_remarks"><strong>Remarks</strong></h5>
              <div class="markdown level0 remarks"><p>You can apply this attribute to parameters, fields, or return values.</p>
<p>This attribute is optional, as each data type has a default marshaling behavior. This attribute is only necessary when a given type can be marshaled to multiple types. For example, you can marshal a string to unmanaged code as either a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPStr">LPStr</a>, a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPWStr">LPWStr</a>, a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPTStr">LPTStr</a>, or a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_BStr">BStr</a>. By default, the common language runtime marshals a string parameter as a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_BStr">BStr</a> to COM methods. You can apply the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute">MarshalAsAttribute</a> attribute to an individual field or parameter to cause that particular string to be marshaled as a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPStr">LPStr</a> instead of a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_BStr">BStr</a>. The Tlbexp.exe (Type Library Exporter) passes your marshaling preferences to the common language runtime.</p>
<p>Some parameters and return values have different default marshaling behavior when used with COM interop or platform invoke. By default, the runtime marshals a string parameter (and fields in a value type) as a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPStr">LPStr</a> to a platform invoke method or function. For additional information, see Default Marshaling Behavior.</p>
<p>In most cases, the attribute simply identifies the format of the unmanaged data using the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> enumeration, as shown in the following C# signature: </p>system.runtime.interopservices.MarshalAsAttribute#2<p>Some <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> enumeration members require additional information. For example, additional information is needed when the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> is <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPArray">LPArray</a>. For a complete description of how to use this attribute with arrays, see Default Marshaling for Arrays.</p><p>The Tlbimp.exe (Type Library Importer) also applies this attribute to parameters, fields, and return values to indicate that the data type in the input type library is not the default type for the corresponding managed data type. Tlbimp.exe always applies the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute">MarshalAsAttribute</a> to <a class="xref" href="System.String.html#System_String">String</a> and <a class="xref" href="System.Object.html#System_Object">Object</a> types for clarity, regardless of the type specified in the input type library.</p><p>The <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute">MarshalAsAttribute</a> does not support marshaling of generic types.</p></div>
              <h3 id="constructors">Constructors
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Int16_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.%23ctor(System.Int16)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L668">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Int16_" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.#ctor(System.Int16)">MarshalAsAttribute(Int16)</h4>
              <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute">MarshalAsAttribute</a> class with the specified <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> value.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Int16__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This constructor takes an underlying 16-bit signed integer that represents each <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> enumeration member. The Tlbimp.exe (Type Library Importer)  uses this constructor.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public MarshalAsAttribute(short unmanagedType)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a></td>
                    <td><em>unmanagedType</em></td>
                    <td><p>The value the data is to be marshaled as. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Runtime_InteropServices_UnmanagedType_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.%23ctor(System.Runtime.InteropServices.UnmanagedType)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L669">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Runtime_InteropServices_UnmanagedType_" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.#ctor(System.Runtime.InteropServices.UnmanagedType)">MarshalAsAttribute(UnmanagedType)</h4>
              <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute">MarshalAsAttribute</a> class with the specified <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> enumeration member.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute__ctor_System_Runtime_InteropServices_UnmanagedType__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For readable code that is less prone to error, always use this constructor.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public MarshalAsAttribute(UnmanagedType unmanagedType)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a></td>
                    <td><em>unmanagedType</em></td>
                    <td><p>The value the data is to be marshaled as. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <h3 id="fields">Fields
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_ArraySubType.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L659">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_ArraySubType" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.ArraySubType">ArraySubType</h4>
              <div class="markdown level1 summary"><p>Specifies the element type of the unmanaged <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPArray">LPArray</a> or <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_ByValArray">ByValArray</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_ArraySubType_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can set this parameter to a value from the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> enumeration to specify the type of the array&#39;s elements. If a type is not specified, the default unmanaged type corresponding to the managed array&#39;s element type is used. For example, the <strong>ArraySubType</strong> for a <strong>LPWStr</strong> array in COM is <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPWStr">LPWStr</a>. For additional information, see Default Marshaling for Arrays.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public UnmanagedType ArraySubType</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_IidParameterIndex.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.IidParameterIndex%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L660">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_IidParameterIndex" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.IidParameterIndex">IidParameterIndex</h4>
              <div class="markdown level1 summary"><p>Specifies the parameter index of the unmanaged <strong>iid_is</strong> attribute used by COM.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public int IidParameterIndex</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_MarshalCookie.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.MarshalCookie%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L661">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_MarshalCookie" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.MarshalCookie">MarshalCookie</h4>
              <div class="markdown level1 summary"><p>Provides additional information to a custom marshaler.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_MarshalCookie_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This field is optional when using a custom marshaler.</p>
<p>You can set this field to a string that supplies additional information to a custom marshaler. For example, the same marshaler can be used to provide a number of wrappers, where the cookie is used to indicate the specific wrapper.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public string MarshalCookie</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_MarshalType.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.MarshalType%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L662">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_MarshalType" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.MarshalType">MarshalType</h4>
              <div class="markdown level1 summary"><p>Specifies the fully qualified name of a custom marshaler.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_MarshalType_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use either the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType">MarshalType</a> or <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef">MarshalTypeRef</a> field specify a custom marshaler type for the attributed parameter, field, or return type. The <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType">MarshalType</a> field enables you to specify a string representing the fully qualified name of a custom marshaler. It is useful for late-bound references, but is less preferred than <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef">MarshalTypeRef</a> for specifying a custom marshaler. For additional information about creating and using custom marshalers, see Custom Marshaling.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public string MarshalType</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.MarshalTypeRef%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L663">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.MarshalTypeRef">MarshalTypeRef</h4>
              <div class="markdown level1 summary"><p>Implements <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType">MarshalType</a> as a type.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use either the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef">MarshalTypeRef</a> or <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType">MarshalType</a> field to specify a custom marshaler type for the attributed parameter, field, or return type. The <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef">MarshalTypeRef</a> field allows easier usage of <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType">MarshalType</a> by shortening the syntax. In the following example, the first line represents syntax using <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalType">MarshalType</a> and the second line represents syntax using <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_MarshalTypeRef">MarshalTypeRef</a>.</p>
<pre><code>[MarshalAs(UnmanagedType.CustomMarshaler, MarshalType = "Assembly, NameSpace.TypeName")] </code></pre>
<pre><code>[MarshalAs(UnmanagedType.CustomMarshaler, MarshalTypeRef = typeof(NameSpace.TypeName)]</code></pre>
<p>You can set a <a class="xref" href="System.Type.html#System_Type">Type</a> object using <strong>typeof</strong> in C#, <strong>GetType</strong> in Visual Basic, or <strong>typeid</strong> in C++. For additional information about creating and using custom marshalers, see Custom Marshaling.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Type MarshalTypeRef</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_SafeArraySubType.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L664">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_SafeArraySubType" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.SafeArraySubType">SafeArraySubType</h4>
              <div class="markdown level1 summary"><p>Indicates the element type of the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_SafeArray">SafeArray</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_SafeArraySubType_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can set this field to a value from the <a class="xref" href="System.Runtime.InteropServices.VarEnum.html#System_Runtime_InteropServices_VarEnum">VarEnum</a> enumeration to specify the type of the safe array&#39;s elements. If a type is not specified, the managed element type&#39;s default type (if passed as a VARIANT) is used. For example, the <strong>SafeArraySubType</strong> for an <strong>int</strong> array in COM is <a class="xref" href="System.Runtime.InteropServices.VarEnum.html#System_Runtime_InteropServices_VarEnum_VT_I4">VT_I4</a>. For additional information, see Default Marshaling for Arrays.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public VarEnum SafeArraySubType</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_SafeArrayUserDefinedSubType.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L665">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_SafeArrayUserDefinedSubType" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.SafeArrayUserDefinedSubType">SafeArrayUserDefinedSubType</h4>
              <div class="markdown level1 summary"><p>Indicates the user-defined element type of the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_SafeArray">SafeArray</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_SafeArrayUserDefinedSubType_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Initialize this field with your custom type to enable the elements of the <strong>SAFEARRAY</strong> to be marshaled successfully. This field is only needed when the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_SafeArraySubType">SafeArraySubType</a> is either <a class="xref" href="System.Runtime.InteropServices.VarEnum.html#System_Runtime_InteropServices_VarEnum_VT_UNKNOWN">VT_UNKNOWN</a>, <a class="xref" href="System.Runtime.InteropServices.VarEnum.html#System_Runtime_InteropServices_VarEnum_VT_DISPATCH">VT_DISPATCH</a>, or <a class="xref" href="System.Runtime.InteropServices.VarEnum.html#System_Runtime_InteropServices_VarEnum_VT_RECORD">VT_RECORD</a>. For additional information, see Default Marshaling for Arrays.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Type SafeArrayUserDefinedSubType</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_SizeConst.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.SizeConst%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L666">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_SizeConst" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.SizeConst">SizeConst</h4>
              <div class="markdown level1 summary"><p>Indicates the number of elements in the fixed-length array or the number of characters (not bytes) in a string to import.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_SizeConst_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This field is required for the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_ByValArray">ByValArray</a> and <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_ByValTStr">ByValTStr</a> members of the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> enumeration. Because the compressed format of the metadata is limited to 0x1FFFFFFF, the range of allowed values for <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_SizeConst">SizeConst</a> are (&gt;= 0 and &lt;= 0x1FFFFFFF).</p>
<p>For additional information, see Default Marshaling for Arrays.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public int SizeConst</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L667">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.SizeParamIndex">SizeParamIndex</h4>
              <div class="markdown level1 summary"><p>Indicates the zero-based parameter that contains the count of array elements, similar to <strong>size_is</strong> in COM.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex">SizeParamIndex</a> field supports managed-to-unmanaged and unmanaged-to-managed calls. It does not have any effect on managed code that calls COM objects.</p>
<p>Depending on the managed type and the attributes applied to it, the array can be passed as a safe array or C-style array.</p>
<p>When arrays are passed as C-style arrays, the marshaler cannot determine the size of the array. Therefore, to pass an managed array to an unmanaged function or method, you must provide two arguments:</p>
<ul><li>
<p>The array, defined by reference or value.</p>
</li><li>
<p>The array size, defined by reference or value.</p>
</li></ul>
<p>The zero-based index of the array size parameter is defined by using the <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex">SizeParamIndex</a> field.</p>
<p>If you specify both <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_SizeParamIndex">SizeParamIndex</a> and <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute_SizeConst">SizeConst</a> with a <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_LPArray">LPArray</a> field, the sum of the fields&#39; values produces a size total.</p>
<p>For more information, see Default Marshaling for Arrays.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public short SizeParamIndex</code></pre>
              </div>
              <h3 id="properties">Properties
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_MarshalAsAttribute_Value.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.MarshalAsAttribute.Value%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime.InteropServices/ref/System.Runtime.InteropServices.cs/#L670">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_MarshalAsAttribute_Value" data-uid="System.Runtime.InteropServices.MarshalAsAttribute.Value">Value</h4>
              <div class="markdown level1 summary"><p>Gets the <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> value the data is to be marshaled as.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_MarshalAsAttribute_Value_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This value is used with <a class="xref" href="System.Runtime.InteropServices.MarshalAsAttribute.html#System_Runtime_InteropServices_MarshalAsAttribute">MarshalAsAttribute</a> to indicate how types should be marshaled between managed and unmanaged code. In some cases, you can use this field with certain <strong>UnmanagedType</strong> enumeration members. For <span class="xref">System.Runtime.InteropServices.UnmanagedType.CustomMarshaler</span> and <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType_ByValArray">ByValArray</a>, you must use additional named parameters.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public UnmanagedType Value { get; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a></td>
                    <td><p>The <a class="xref" href="System.Runtime.InteropServices.UnmanagedType.html#System_Runtime_InteropServices_UnmanagedType">UnmanagedType</a> value the data is to be marshaled as.</p>
</td>
                  </tr>
                </tbody>
              </table>
            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
            <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
            </nav>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="inner-footer">
          <p>© .NET Foundation</p>
          <p>
            <a href="https://www.github.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-github fa-stack-1x"></span>
            </span></a>
            <a href="https://twitter.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-twitter fa-stack-1x"></span>
            </span></a>
            <a href="https://www.facebook.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-facebook fa-stack-1x"></span>
            </span></a>
      
          </p>
          </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
