<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class Registry
   | CoreCLR site </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class Registry
   | CoreCLR site ">
    
    <link rel="shortcut icon" href="../images/Logo_DotNet.png" type="image/x-icon">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/style.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-63735192-1', 'auto');
    ga('send', 'pageview');
    </script>
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav class="navbar navbar-inverse">
             <div class="container">
               <a href="../"><img height="50px" src="../images/Logo_DotNet.png" style="float:right;"></a>
               <div class="navbar-header ">
                 <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                   <span class="sr-only">Toggle navigation</span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                 </button>
                 <a class="navbar-brand" href="../"><span class="dotnet">.NET Core</span></a>
               </div>
               <div id="navbar" class="collapse navbar-collapse">
               </div><!--/.nav-collapse -->
             </div>
           </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content">
              
              <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="pull-right mobile-hide"><span class="fa fa-github"></span>Improve this Doc</a>
              <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L18" class="pull-right mobile-hide">View Source</a>
              <h1 id="Microsoft_Win32_Registry" data-uid="Microsoft.Win32.Registry">Class Registry
              </h1>
              <div class="markdown level0 summary"><p>Provides <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> objects that represent the root keys in the Windows registry, and <strong>static</strong> methods to access key/value pairs.</p>
</div>
              <div class="markdown level0 conceptual"></div>
              <div class="inheritance">
                <h5>Inheritance</h5>
                  <div class="level0"><a class="xref" href="System.Object.html#System_Object">Object</a></div>
                  <div class="level1"><span class="xref">Registry</span></div>
              </div>
              <h6><strong>Namespace</strong>:Microsoft.Win32</h6>
              <h6><strong>Assembly</strong>:Microsoft.Win32.Registry.dll</h6>
              <h5 id="Microsoft_Win32_Registry_syntax">Syntax</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[ComVisible(true)]
public class Registry</code></pre>
              </div>
              <h5 id="Microsoft_Win32_Registry_examples"><strong>Examples</strong></h5>
              <p>This section contains two code examples. The first example demonstrates root keys, and the second example demonstrates the <strong>static</strong><a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object_">GetValue(String, String, Object)</a> and <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> methods.</p>
<p>Example 1</p>
<p>The following code example demonstrates how to retrieve the subkeys of the HKEY_USERS key, and print their names to the screen. Use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_OpenSubKey_System_String_System_Boolean_">OpenSubKey(String, Boolean)</a> method to create an instance of the particular subkey of interest. You can then use other operations in <strong>RegistryKey</strong> to manipulate that key.</p>Classic Registry.Users Example#1<p>Example 2</p><p>The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values. The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of <em>defaultValue</em> when a name/value pair does not exist.</p>Microsoft.Win32.Registry.GetSet#1
              <h3 id="fields">Fields
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_ClassesRoot.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.ClassesRoot%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L44">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_ClassesRoot" data-uid="Microsoft.Win32.Registry.ClassesRoot">ClassesRoot</h4>
              <div class="markdown level1 summary"><p>Defines the types (or classes) of documents and the properties associated with those types. This field reads the Windows registry base key HKEY_CLASSES_ROOT.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_ClassesRoot_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Both conventional applications and OLE applications use data that is stored under this key. This key also provides backward compatibility with the Windows 3.1 registration database by storing information for DDE and OLE support. File viewers and user interface extensions store their OLE class identifiers in this key, and processing servers are registered in this key.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly RegistryKey ClassesRoot</code></pre>
              </div>
              <h5 id="Microsoft_Win32_Registry_ClassesRoot_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Both conventional applications and OLE applications use data that is stored under this key. This key also provides backward compatibility with the Windows 3.1 registration database by storing information for DDE and OLE support. File viewers and user interface extensions store their OLE class identifiers in this key, and processing servers are registered in this key.</p>
</div>
              <h5 id="Microsoft_Win32_Registry_ClassesRoot_examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen. Use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_OpenSubKey_System_String_System_Boolean_">OpenSubKey(String, Boolean)</a> method to create an instance of the particular subkey of interest. You can then use other operations in <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> to manipulate that key.</p>Classic Registry.ClassesRoot Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_CurrentConfig.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.CurrentConfig%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L65">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_CurrentConfig" data-uid="Microsoft.Win32.Registry.CurrentConfig">CurrentConfig</h4>
              <div class="markdown level1 summary"><p>Contains configuration information pertaining to the hardware that is not specific to the user. This field reads the Windows registry base key HKEY_CURRENT_CONFIG.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_CurrentConfig_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This member is mapped to a subkey within <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_LocalMachine">LocalMachine</a>.</p>
<p>An example of using this member is an application that stores a different server name for its data depending on whether the system is attached to a network.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly RegistryKey CurrentConfig</code></pre>
              </div>
              <h5 id="Microsoft_Win32_Registry_CurrentConfig_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This member is mapped to a subkey within <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_LocalMachine">LocalMachine</a>.</p>
<p>An example of using this member is an application that stores a different server name for its data depending on whether the system is attached to a network.</p>
</div>
              <h5 id="Microsoft_Win32_Registry_CurrentConfig_examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen. Use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_OpenSubKey_System_String_System_Boolean_">OpenSubKey(String, Boolean)</a> method to create an instance of the particular subkey of interest. You can then use other operations in <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> to manipulate that key.</p>Classic Registry.CurrentConfig Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_CurrentUser.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.CurrentUser%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L30">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_CurrentUser" data-uid="Microsoft.Win32.Registry.CurrentUser">CurrentUser</h4>
              <div class="markdown level1 summary"><p>Contains information about the current user preferences. This field reads the Windows registry base key HKEY_CURRENT_USER </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_CurrentUser_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Information stored in this key includes the settings of environment variables and data about program groups, colors, printers, network connections, and application preferences. This key makes it easier to establish the current user&#39;s settings. In this key, software vendors store the current user-specific preferences to be used within their applications. Microsoft, for example, creates the HKEY_CURRENT_USER\Software\Microsoft key for its applications to use, with each application creating its own subkey under the Microsoft key.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly RegistryKey CurrentUser</code></pre>
              </div>
              <h5 id="Microsoft_Win32_Registry_CurrentUser_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Information stored in this key includes the settings of environment variables and data about program groups, colors, printers, network connections, and application preferences. This key makes it easier to establish the current user&#39;s settings. In this key, software vendors store the current user-specific preferences to be used within their applications. Microsoft, for example, creates the HKEY_CURRENT_USER\Software\Microsoft key for its applications to use, with each application creating its own subkey under the Microsoft key.</p>
</div>
              <h5 id="Microsoft_Win32_Registry_CurrentUser_examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen. Use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_OpenSubKey_System_String_System_Boolean_">OpenSubKey(String, Boolean)</a> method to create an instance of the particular subkey of interest. You can then use other operations in <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> to manipulate that key.</p>Classic Registry.CurrentUser Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_LocalMachine.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.LocalMachine%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L37">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_LocalMachine" data-uid="Microsoft.Win32.Registry.LocalMachine">LocalMachine</h4>
              <div class="markdown level1 summary"><p>Contains the configuration data for the local machine. This field reads the Windows registry base key HKEY_LOCAL_MACHINE.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_LocalMachine_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<strong>LocalMachine</strong> contains five keys: </p>           Hardware <p>Describes the physical hardware in the computer, the way device drivers use that hardware, and mappings and related data that link kernel-mode drivers with user-mode code. All data in this key is recreated each time the system is started. The Description subkey describes the actual computer hardware. The DeviceMap subkey contains miscellaneous data in formats specific to particular classes of drivers. The ResourceMap subkey describes which device drivers claim which hardware resources. The Windows NT Diagnostics program (Winmsdp.exe) can report on its contents in an easy-to-read form. </p>           SAM<p>The directory services database of security information for user and group accounts, and for the domains in Windows 2000 Server (SAM is the Security Account Manager, known as the directory services database). </p>           Security <p>Contains the local security policy, such as specific user rights. This key is used only by the Windows 2000 security subsystem. </p>           Software <p>The per-computer software database. This key contains data about software installed on the local computer, along with various items of miscellaneous configuration data. </p>           System <p>Controls system startup, device driver loading, Windows 2000 services, and operating system behavior. </p><p>By convention, if similar data exists under <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_CurrentUser">CurrentUser</a> and under <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_LocalMachine">LocalMachine</a>, the data in <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_CurrentUser">CurrentUser</a> takes precedence. However, values in this key can also extend (rather than replace) data in Registry.LocalMachine. Also, some items (such as device driver loading entries) are meaningless if they occur outside of Registry.LocalMachine.</p></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly RegistryKey LocalMachine</code></pre>
              </div>
              <h5 id="Microsoft_Win32_Registry_LocalMachine_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<strong>LocalMachine</strong> contains five keys: </p>           Hardware <p>Describes the physical hardware in the computer, the way device drivers use that hardware, and mappings and related data that link kernel-mode drivers with user-mode code. All data in this key is recreated each time the system is started. The Description subkey describes the actual computer hardware. The DeviceMap subkey contains miscellaneous data in formats specific to particular classes of drivers. The ResourceMap subkey describes which device drivers claim which hardware resources. The Windows NT Diagnostics program (Winmsdp.exe) can report on its contents in an easy-to-read form. </p>           SAM<p>The directory services database of security information for user and group accounts, and for the domains in Windows 2000 Server (SAM is the Security Account Manager, known as the directory services database). </p>           Security <p>Contains the local security policy, such as specific user rights. This key is used only by the Windows 2000 security subsystem. </p>           Software <p>The per-computer software database. This key contains data about software installed on the local computer, along with various items of miscellaneous configuration data. </p>           System <p>Controls system startup, device driver loading, Windows 2000 services, and operating system behavior. </p><p>By convention, if similar data exists under <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_CurrentUser">CurrentUser</a> and under <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_LocalMachine">LocalMachine</a>, the data in <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_CurrentUser">CurrentUser</a> takes precedence. However, values in this key can also extend (rather than replace) data in Registry.LocalMachine. Also, some items (such as device driver loading entries) are meaningless if they occur outside of Registry.LocalMachine.</p></div>
              <h5 id="Microsoft_Win32_Registry_LocalMachine_examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen. Use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_OpenSubKey_System_String_System_Boolean_">OpenSubKey(String, Boolean)</a> method to create an instance of the particular subkey of interest. You can then use other operations in <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> to manipulate that key.</p>Classic Registry.LocalMachine Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_PerformanceData.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.PerformanceData%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L58">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_PerformanceData" data-uid="Microsoft.Win32.Registry.PerformanceData">PerformanceData</h4>
              <div class="markdown level1 summary"><p>Contains performance information for software components. This field reads the Windows registry base key HKEY_PERFORMANCE_DATA.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_PerformanceData_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Each software component creates keys for its objects, counters when it is installed, and writes counter data while it is executing. You can access this data as you would access any other registry data, using the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> functions.</p>
<p>Although you use the registry to collect performance data, the data is not stored in the registry database. Instead, accessing the registry with this key causes the system to collect the data from the appropriate system object managers.</p>
<p>To obtain performance data from the local system, use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> method, with the Registry.PerformanceData key. The first call opens the key (you do not need to explicitly open the key first). However, be sure to use the <span class="xref">Microsoft.Win32.RegistryKey.Close</span> method to close the handle to the key when you are finished obtaining performance data. The user cannot install or remove a software component while its performance data is in use.</p>
<p>To obtain performance data from a remote system, you must use the <span class="xref">Microsoft.Win32.RegistryKey.OpenRemoteBaseKey(Microsoft.Win32.RegistryHive,System.String)</span> method, with the computer name of the remote system and the Registry.PerformanceData key. This call retrieves a key representing the performance data for the remote system. To retrieve the data, call <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> using this key, rather than the Registry.PerformanceData key.</p>
<p>On Windows Server 2003, a user must at least belong to the Performance Monitor Users group in order to access subkeys of this base key. </p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly RegistryKey PerformanceData</code></pre>
              </div>
              <h5 id="Microsoft_Win32_Registry_PerformanceData_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Each software component creates keys for its objects, counters when it is installed, and writes counter data while it is executing. You can access this data as you would access any other registry data, using the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> functions.</p>
<p>Although you use the registry to collect performance data, the data is not stored in the registry database. Instead, accessing the registry with this key causes the system to collect the data from the appropriate system object managers.</p>
<p>To obtain performance data from the local system, use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> method, with the Registry.PerformanceData key. The first call opens the key (you do not need to explicitly open the key first). However, be sure to use the <span class="xref">Microsoft.Win32.RegistryKey.Close</span> method to close the handle to the key when you are finished obtaining performance data. The user cannot install or remove a software component while its performance data is in use.</p>
<p>To obtain performance data from a remote system, you must use the <span class="xref">Microsoft.Win32.RegistryKey.OpenRemoteBaseKey(Microsoft.Win32.RegistryHive,System.String)</span> method, with the computer name of the remote system and the Registry.PerformanceData key. This call retrieves a key representing the performance data for the remote system. To retrieve the data, call <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> using this key, rather than the Registry.PerformanceData key.</p>
<p>On Windows Server 2003, a user must at least belong to the Performance Monitor Users group in order to access subkeys of this base key. </p>
</div>
              <h5 id="Microsoft_Win32_Registry_PerformanceData_examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen. Use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_OpenSubKey_System_String_System_Boolean_">OpenSubKey(String, Boolean)</a> method to create an instance of the particular subkey of interest. You can then use other operations in <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> to manipulate that key. Note that this example can often return no results, since there might be no performance data.</p>Classic Registry.PerformanceData Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_Users.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.Users%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L51">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_Users" data-uid="Microsoft.Win32.Registry.Users">Users</h4>
              <div class="markdown level1 summary"><p>Contains information about the default user configuration. This field reads the Windows registry base key HKEY_USERS.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_Users_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This key contains a branch for each user of the computer. The default configuration is supplied for new users on the local computer and for the default current user if the user has not changed preferences. Because Windows 98/ME also supports Registry.Users, applications can access the user-specific information the same way they do under Windows 2000. Each user&#39;s information is stored in a separate file, which can be stored locally or on a network server. Windows 98/ME can copy this file to the user&#39;s current system so that settings can move from one computer to another with the user.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly RegistryKey Users</code></pre>
              </div>
              <h5 id="Microsoft_Win32_Registry_Users_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This key contains a branch for each user of the computer. The default configuration is supplied for new users on the local computer and for the default current user if the user has not changed preferences. Because Windows 98/ME also supports Registry.Users, applications can access the user-specific information the same way they do under Windows 2000. Each user&#39;s information is stored in a separate file, which can be stored locally or on a network server. Windows 98/ME can copy this file to the user&#39;s current system so that settings can move from one computer to another with the user.</p>
</div>
              <h5 id="Microsoft_Win32_Registry_Users_examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve the subkeys of this key, and prints their names to the screen. Use the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_OpenSubKey_System_String_System_Boolean_">OpenSubKey(String, Boolean)</a> method to create an instance of the particular subkey of interest. You can then use other operations in <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> to manipulate that key.</p>Classic Registry.Users Example#1
              <h3 id="methods">Methods
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object_.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.GetValue(System.String%2CSystem.String%2CSystem.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L136">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object_" data-uid="Microsoft.Win32.Registry.GetValue(System.String,System.String,System.Object)">GetValue(String, String, Object)</h4>
              <div class="markdown level1 summary"><p>Retrieves the value associated with the specified name, in the specified registry key. If the name is not found in the specified key, returns a default value that you provide, or <strong>null</strong> if the specified key does not exist. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The string <em>valueName</em> is not case-sensitive.</p>
<p>A registry key can contain one value that is not associated with any name. When this unnamed value is displayed in the registry editor, the string &quot;(Default)&quot; appears instead of a name. To retrieve this unnamed value, specify either <strong>null</strong> or the empty string (&quot;&quot;) for <em>valuName</em>.</p>
<p>Valid root names are HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA. For example, in Visual Basic the string &quot;HKEY_CURRENT_USER\MyTestKey&quot; accesses key/value pairs for the subkey &quot;MyTestKey&quot; in the HKEY_CURRENT_USER root. </p>
<p>When the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> method retrieves expandable string values (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_ExpandString">ExpandString</a>), it expands environment strings using data from the local environment. If a value containing expandable references to environment variables has been stored as a string (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_String">String</a>), rather than as an expandable string (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_ExpandString">ExpandString</a>), <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> does not expand it. You can expand such a string after it has been retrieved by calling the <a class="xref" href="System.Environment.html#System_Environment_ExpandEnvironmentVariables_System_String_">ExpandEnvironmentVariables(String)</a> method.</p>
<p>The recommended way to retrieve data from HKEY_PERFORMANCE_DATA is to use the <a class="xref" href="System.Diagnostics.PerformanceCounter.html#System_Diagnostics_PerformanceCounter">PerformanceCounter</a> class rather than the <see cref="Overload:Microsoft.Win32.RegistryKey.GetValue"></see> method.</p>
<p>The <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object_">GetValue(String, String, Object)</a> and <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> methods open and close registry keys each time they are used, so they do not perform as well as the methods of the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> class if you access a large number of values.</p>
<p>
<a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecuritySafeCritical]
public static object GetValue(string keyName, string valueName, object defaultValue)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>keyName</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>valueName</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>defaultValue</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The string <em>valueName</em> is not case-sensitive.</p>
<p>A registry key can contain one value that is not associated with any name. When this unnamed value is displayed in the registry editor, the string &quot;(Default)&quot; appears instead of a name. To retrieve this unnamed value, specify either <strong>null</strong> or the empty string (&quot;&quot;) for <em>valuName</em>.</p>
<p>Valid root names are HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA. For example, in Visual Basic the string &quot;HKEY_CURRENT_USER\MyTestKey&quot; accesses key/value pairs for the subkey &quot;MyTestKey&quot; in the HKEY_CURRENT_USER root. </p>
<p>When the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> method retrieves expandable string values (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_ExpandString">ExpandString</a>), it expands environment strings using data from the local environment. If a value containing expandable references to environment variables has been stored as a string (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_String">String</a>), rather than as an expandable string (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_ExpandString">ExpandString</a>), <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey_GetValue_System_String_">GetValue(String)</a> does not expand it. You can expand such a string after it has been retrieved by calling the <a class="xref" href="System.Environment.html#System_Environment_ExpandEnvironmentVariables_System_String_">ExpandEnvironmentVariables(String)</a> method.</p>
<p>The recommended way to retrieve data from HKEY_PERFORMANCE_DATA is to use the <a class="xref" href="System.Diagnostics.PerformanceCounter.html#System_Diagnostics_PerformanceCounter">PerformanceCounter</a> class rather than the <see cref="Overload:Microsoft.Win32.RegistryKey.GetValue"></see> method.</p>
<p>The <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object_">GetValue(String, String, Object)</a> and <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> methods open and close registry keys each time they are used, so they do not perform as well as the methods of the <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> class if you access a large number of values.</p>
<p>
<a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</p>
</div>
              <h5 id="Microsoft_Win32_Registry_GetValue_System_String_System_String_System_Object__examples">Examples</h5>
              
<p>The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values. The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of <em>defaultValue</em> when a name/value pair does not exist.</p>Microsoft.Win32.Registry.GetSet#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Security.SecurityException.html#System_Security_SecurityException">SecurityException</a></td>
                    <td><p>The user does not have the permissions required to read from the registry key. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>The <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> that contains the specified value has been marked for deletion. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>keyName</em> does not begin with a valid registry root. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.SetValue(System.String%2CSystem.String%2CSystem.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L153">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_" data-uid="Microsoft.Win32.Registry.SetValue(System.String,System.String,System.Object)">SetValue(String, String, Object)</h4>
              <div class="markdown level1 summary"><p>Sets the specified name/value pair on the specified registry key. If the specified key does not exist, it is created.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Starting with the .NET Framework 4, the <em>valueName</em> parameter is no longer restricted to a maximum of 255 characters; however, the <em>keyName</em> parameter continues to have the 255-character restriction.</p>
<p>Because many values can be stored in each key in the registry, you must use the <em>valueName</em> parameter to specify the particular value you want to set.</p>
<p>A registry key can contain one value that is not associated with any name. When this unnamed value is displayed in the registry editor, the string &quot;(Default)&quot; appears instead of a name. To set this unnamed value, specify either <strong>null</strong> or the empty string (&quot;&quot;) for <em>valueName</em>.</p>
<p>If <em>valueName</em> does not exist in the key, it is created and the associated value is set to <em>value</em>.</p>
<p>If <em>keyName</em> specifies a subkey that does not exist, the subkey is created in the specified root. For example, in Visual Basic the string &quot;HKEY_CURRENT_USER\MyTestKey&quot; creates the subkey &quot;MyTestKey&quot; in the HKEY_CURRENT_USER root. The string &quot;HKEY_CURRENT_USER\MyTestKey\Key2\Key3&quot; creates the nested subkeys &quot;MyTestKey&quot;, &quot;MyTestKey\Key2&quot;, and &quot;MyTestKey\Key2\Key3&quot;.</p>
<p>Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</p>
<p>The <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> method opens a registry key, sets the value, and closes the key each time it is called. If you need to modify a large number of values, the <see cref="Overload:Microsoft.Win32.RegistryKey.SetValue"></see> method might provide better performance. The <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</p>
<p>This overload of <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> stores 64-bit integers as strings (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_String">String</a>). To store 64-bit numbers as <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_QWord">QWord</a> values, use the <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_">SetValue(String, String, Object, RegistryValueKind)</a> method overload.</p>
<p>This overload of <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> stores all string values as <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_String">String</a> objects, even if they contain expandable references to environment variables. To save string values as expandable strings (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_ExpandString">ExpandString</a>), use the <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_">SetValue(String, String, Object, RegistryValueKind)</a> method overload.</p>
<p>This overload is equivalent to calling the <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_">SetValue(String, String, Object, RegistryValueKind)</a> method overload with <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_Unknown">Unknown</a>.</p>
<p>On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages. A Unicode character that is invalid for the current code page is replaced by the best available match. No exception is thrown.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static void SetValue(string keyName, string valueName, object value)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>keyName</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>valueName</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>value</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Starting with the .NET Framework 4, the <em>valueName</em> parameter is no longer restricted to a maximum of 255 characters; however, the <em>keyName</em> parameter continues to have the 255-character restriction.</p>
<p>Because many values can be stored in each key in the registry, you must use the <em>valueName</em> parameter to specify the particular value you want to set.</p>
<p>A registry key can contain one value that is not associated with any name. When this unnamed value is displayed in the registry editor, the string &quot;(Default)&quot; appears instead of a name. To set this unnamed value, specify either <strong>null</strong> or the empty string (&quot;&quot;) for <em>valueName</em>.</p>
<p>If <em>valueName</em> does not exist in the key, it is created and the associated value is set to <em>value</em>.</p>
<p>If <em>keyName</em> specifies a subkey that does not exist, the subkey is created in the specified root. For example, in Visual Basic the string &quot;HKEY_CURRENT_USER\MyTestKey&quot; creates the subkey &quot;MyTestKey&quot; in the HKEY_CURRENT_USER root. The string &quot;HKEY_CURRENT_USER\MyTestKey\Key2\Key3&quot; creates the nested subkeys &quot;MyTestKey&quot;, &quot;MyTestKey\Key2&quot;, and &quot;MyTestKey\Key2\Key3&quot;.</p>
<p>Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</p>
<p>The <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> method opens a registry key, sets the value, and closes the key each time it is called. If you need to modify a large number of values, the <see cref="Overload:Microsoft.Win32.RegistryKey.SetValue"></see> method might provide better performance. The <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</p>
<p>This overload of <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> stores 64-bit integers as strings (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_String">String</a>). To store 64-bit numbers as <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_QWord">QWord</a> values, use the <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_">SetValue(String, String, Object, RegistryValueKind)</a> method overload.</p>
<p>This overload of <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> stores all string values as <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_String">String</a> objects, even if they contain expandable references to environment variables. To save string values as expandable strings (<a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_ExpandString">ExpandString</a>), use the <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_">SetValue(String, String, Object, RegistryValueKind)</a> method overload.</p>
<p>This overload is equivalent to calling the <a class="xref" href="Microsoft.Win32.Registry.html#Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_">SetValue(String, String, Object, RegistryValueKind)</a> method overload with <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_Unknown">Unknown</a>.</p>
<p>On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages. A Unicode character that is invalid for the current code page is replaced by the best available match. No exception is thrown.</p>
</div>
              <h5 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object__examples">Examples</h5>
              
<p>The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values. The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of <em>defaultValue</em> when a name/value pair does not exist.</p>Microsoft.Win32.Registry.GetSet#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>value</em> is <strong>null</strong>. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>keyName</em> does not begin with a valid registry root. </p>
<p>-or-</p>
<p>
<em>keyName</em> is longer than the maximum length allowed (255 characters).</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.UnauthorizedAccessException.html#System_UnauthorizedAccessException">UnauthorizedAccessException</a></td>
                    <td><p>The <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> is read-only, and thus cannot be written to; for example, it is a root-level node. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Security.SecurityException.html#System_Security_SecurityException">SecurityException</a></td>
                    <td><p>The user does not have the permissions required to create or modify registry keys. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_.md&amp;value=---%0Auid%3A%20Microsoft.Win32.Registry.SetValue(System.String%2CSystem.String%2CSystem.Object%2CMicrosoft.Win32.RegistryValueKind)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/Microsoft/Win32/Registry.cs/#L157">View Source</a>
              </span>
              <h4 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind_" data-uid="Microsoft.Win32.Registry.SetValue(System.String,System.String,System.Object,Microsoft.Win32.RegistryValueKind)">SetValue(String, String, Object, RegistryValueKind)</h4>
              <div class="markdown level1 summary"><p>Sets the name/value pair on the specified registry key, using the specified registry data type. If the specified key does not exist, it is created.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Starting with the .NET Framework 4, the <em>valueName</em> parameter is no longer restricted to a maximum of 255 characters; however, the <em>keyName</em> parameter continues have the 255-character restriction.</p>
<p>Because many values can be stored in each key in the registry, you must use the <em>valueName</em> parameter to specify the particular value you want to set.</p>
<p>A registry key can contain one value that is not associated with any name. When this unnamed value is displayed in the registry editor, the string &quot;(Default)&quot; appears instead of a name. To set this unnamed value, specify either <strong>null</strong> or the empty string (&quot;&quot;) for <em>valueName</em>.</p>
<p>If <em>valueName</em> does not exist in the key, it is created and the associated value is set to <em>value</em>.</p>
<p>If <em>keyName</em> specifies a subkey that does not exist, the subkey is created in the specified root. For example, in Visual Basic the string &quot;HKEY_CURRENT_USER\MyTestKey&quot; creates the subkey &quot;MyTestKey&quot; in the HKEY_CURRENT_USER root. The string &quot;HKEY_CURRENT_USER\MyTestKey\Key2\Key3&quot; creates the nested subkeys &quot;MyTestKey&quot;, &quot;MyTestKey\Key2&quot;, and &quot;MyTestKey\Key2\Key3&quot;.</p>
<p>Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</p>
<p>The <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> method opens a registry key, sets the value, and closes the key each time it is called. If you need to modify a large number of values, the <see cref="Overload:Microsoft.Win32.RegistryKey.SetValue"></see> method might provide better performance. The <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</p>
<p>If the type of the specified <em>value</em> does not match the specified <em>valueKind</em>, and the data cannot be converted, <a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a> is thrown. For example, you can store a <a class="xref" href="System.Int64.html#System_Int64">Int64</a> as a <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_DWord">DWord</a>, but only if its value is less than the maximum value of a <a class="xref" href="System.Int32.html#System_Int32">Int32</a>. You cannot store a single string value as a <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_MultiString">MultiString</a>.</p>
<p>If boxed values are passed for <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_DWord">DWord</a> or <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_QWord">QWord</a>, the conversion is done using the invariant culture.</p>
<p>On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages. A Unicode character that is invalid for the current code page is replaced by the best available match. No exception is thrown.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecuritySafeCritical]
public static void SetValue(string keyName, string valueName, object value, RegistryValueKind valueKind)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>keyName</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>valueName</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>value</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind">RegistryValueKind</a></td>
                    <td><em>valueKind</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Starting with the .NET Framework 4, the <em>valueName</em> parameter is no longer restricted to a maximum of 255 characters; however, the <em>keyName</em> parameter continues have the 255-character restriction.</p>
<p>Because many values can be stored in each key in the registry, you must use the <em>valueName</em> parameter to specify the particular value you want to set.</p>
<p>A registry key can contain one value that is not associated with any name. When this unnamed value is displayed in the registry editor, the string &quot;(Default)&quot; appears instead of a name. To set this unnamed value, specify either <strong>null</strong> or the empty string (&quot;&quot;) for <em>valueName</em>.</p>
<p>If <em>valueName</em> does not exist in the key, it is created and the associated value is set to <em>value</em>.</p>
<p>If <em>keyName</em> specifies a subkey that does not exist, the subkey is created in the specified root. For example, in Visual Basic the string &quot;HKEY_CURRENT_USER\MyTestKey&quot; creates the subkey &quot;MyTestKey&quot; in the HKEY_CURRENT_USER root. The string &quot;HKEY_CURRENT_USER\MyTestKey\Key2\Key3&quot; creates the nested subkeys &quot;MyTestKey&quot;, &quot;MyTestKey\Key2&quot;, and &quot;MyTestKey\Key2\Key3&quot;.</p>
<p>Valid root names include HKEY_CURRENT_USER, HKEY_LOCAL_MACHINE, HKEY_CLASSES_ROOT, HKEY_USERS, HKEY_PERFORMANCE_DATA, HKEY_CURRENT_CONFIG, and HKEY_DYN_DATA.</p>
<p>The <see cref="Overload:Microsoft.Win32.Registry.SetValue"></see> method opens a registry key, sets the value, and closes the key each time it is called. If you need to modify a large number of values, the <see cref="Overload:Microsoft.Win32.RegistryKey.SetValue"></see> method might provide better performance. The <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> class also provides methods that allow you to add an access control list (ACL) to a registry key, to test the data type of a value before retrieving it, and to delete keys.</p>
<p>If the type of the specified <em>value</em> does not match the specified <em>valueKind</em>, and the data cannot be converted, <a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a> is thrown. For example, you can store a <a class="xref" href="System.Int64.html#System_Int64">Int64</a> as a <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_DWord">DWord</a>, but only if its value is less than the maximum value of a <a class="xref" href="System.Int32.html#System_Int32">Int32</a>. You cannot store a single string value as a <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_MultiString">MultiString</a>.</p>
<p>If boxed values are passed for <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_DWord">DWord</a> or <a class="xref" href="Microsoft.Win32.RegistryValueKind.html#Microsoft_Win32_RegistryValueKind_QWord">QWord</a>, the conversion is done using the invariant culture.</p>
<p>On Windows 98 and Windows Millennium Edition (Windows Me), the registry is not Unicode, and not all Unicode characters are valid for all code pages. A Unicode character that is invalid for the current code page is replaced by the best available match. No exception is thrown.</p>
</div>
              <h5 id="Microsoft_Win32_Registry_SetValue_System_String_System_String_System_Object_Microsoft_Win32_RegistryValueKind__examples">Examples</h5>
              
<p>The following code example stores values of several data types in an example key, creating the key as it does so, and then retrieves and displays the values. The example demonstrates storing and retrieving the default (nameless) name/value pair, and the use of <em>defaultValue</em> when a name/value pair does not exist.</p>Microsoft.Win32.Registry.GetSet#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>value</em> is <strong>null</strong>. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>keyName</em> does not begin with a valid registry root.</p>
<p>-or-</p>
<p>
<em>keyName</em> is longer than the maximum length allowed (255 characters).</p>
<p>-or- </p>
<p>The type of <em>value</em> did not match the registry data type specified by <em>valueKind</em>, therefore the data could not be converted properly. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.UnauthorizedAccessException.html#System_UnauthorizedAccessException">UnauthorizedAccessException</a></td>
                    <td><p>The <a class="xref" href="Microsoft.Win32.RegistryKey.html#Microsoft_Win32_RegistryKey">RegistryKey</a> is read-only, and thus cannot be written to; for example, it is a root-level node, or the key has not been opened with write access. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Security.SecurityException.html#System_Security_SecurityException">SecurityException</a></td>
                    <td><p>The user does not have the permissions required to create or modify registry keys. </p>
</td>
                  </tr>
                </tbody>
              </table>
            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
            <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
            </nav>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="inner-footer">
          <p>© .NET Foundation</p>
          <p>
            <a href="https://www.github.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-github fa-stack-1x"></span>
            </span></a>
            <a href="https://twitter.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-twitter fa-stack-1x"></span>
            </span></a>
            <a href="https://www.facebook.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-facebook fa-stack-1x"></span>
            </span></a>
      
          </p>
          </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
