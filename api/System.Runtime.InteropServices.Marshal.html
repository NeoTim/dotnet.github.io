<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class Marshal
   | CoreCLR site </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class Marshal
   | CoreCLR site ">
    
    <link rel="shortcut icon" href="../images/Logo_DotNet.png" type="image/x-icon">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/style.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-63735192-1', 'auto');
    ga('send', 'pageview');
    </script>
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav class="navbar navbar-inverse">
             <div class="container">
               <a href="../"><img height="50px" src="../images/Logo_DotNet.png" style="float:right;"></a>
               <div class="navbar-header ">
                 <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                   <span class="sr-only">Toggle navigation</span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                 </button>
                 <a class="navbar-brand" href="../"><span class="dotnet">.NET Core</span></a>
               </div>
               <div id="navbar" class="collapse navbar-collapse">
               </div><!--/.nav-collapse -->
             </div>
           </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content">
              
              <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="pull-right mobile-hide"><span class="fa fa-github"></span>Improve this Doc</a>
              <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L49" class="pull-right mobile-hide">View Source</a>
              <h1 id="System_Runtime_InteropServices_Marshal" data-uid="System.Runtime.InteropServices.Marshal">Class Marshal
              </h1>
              <div class="markdown level0 summary"><p>Provides a collection of methods for allocating unmanaged memory, copying unmanaged memory blocks, and converting managed to unmanaged types, as well as other miscellaneous methods used when interacting with unmanaged code.</p>
</div>
              <div class="markdown level0 conceptual"></div>
              <div class="inheritance">
                <h5>Inheritance</h5>
                  <div class="level0"><a class="xref" href="System.Object.html#System_Object">Object</a></div>
                  <div class="level1"><span class="xref">Marshal</span></div>
              </div>
              <div class="inheritedMembers">
                <h5>Inherited Members</h5>
                <div>
                  <a class="xref" href="System.Object.html#System_Object_ToString">ToString()</a>
                </div>
                <div>
                  <a class="xref" href="System.Object.html#System_Object_Equals_System_Object_">Equals(Object)</a>
                </div>
                <div>
                  <a class="xref" href="System.Object.html#System_Object_Equals_System_Object_System_Object_">Equals(Object, Object)</a>
                </div>
                <div>
                  <a class="xref" href="System.Object.html#System_Object_ReferenceEquals_System_Object_System_Object_">ReferenceEquals(Object, Object)</a>
                </div>
                <div>
                  <a class="xref" href="System.Object.html#System_Object_GetHashCode">GetHashCode()</a>
                </div>
                <div>
                  <a class="xref" href="System.Object.html#System_Object_GetType">GetType()</a>
                </div>
                <div>
                  <a class="xref" href="System.Object.html#System_Object_MemberwiseClone">MemberwiseClone()</a>
                </div>
              </div>
              <h6><strong>Namespace</strong>:System.Runtime.InteropServices</h6>
              <h6><strong>Assembly</strong>:System.Runtime.InteropServices.dll</h6>
              <h5 id="System_Runtime_InteropServices_Marshal_syntax">Syntax</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public class Marshal</code></pre>
              </div>
              <h5 id="System_Runtime_InteropServices_Marshal_examples"><strong>Examples</strong></h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h3 id="fields">Fields
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_SystemDefaultCharSize.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.SystemDefaultCharSize%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L96">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_SystemDefaultCharSize" data-uid="System.Runtime.InteropServices.Marshal.SystemDefaultCharSize">SystemDefaultCharSize</h4>
              <div class="markdown level1 summary"><p>Represents the default character size on the system; the default is 2 for Unicode systems and 1 for ANSI systems. This field is read-only.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly int SystemDefaultCharSize</code></pre>
              </div>
              <h5 id="System_Runtime_InteropServices_Marshal_SystemDefaultCharSize_examples">Examples</h5>
              
<p>The following example demonstrates the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SystemDefaultCharSize">SystemDefaultCharSize</a> field. This code example is part of a larger example provided for the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#2
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_SystemMaxDBCSCharSize.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.SystemMaxDBCSCharSize%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L101">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_SystemMaxDBCSCharSize" data-uid="System.Runtime.InteropServices.Marshal.SystemMaxDBCSCharSize">SystemMaxDBCSCharSize</h4>
              <div class="markdown level1 summary"><p>Represents the maximum size of a double byte character set (DBCS) size, in bytes, for the current operating system. This field is read-only.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static readonly int SystemMaxDBCSCharSize</code></pre>
              </div>
              <h5 id="System_Runtime_InteropServices_Marshal_SystemMaxDBCSCharSize_examples">Examples</h5>
              
<p>The following example demonstrates the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SystemDefaultCharSize">SystemDefaultCharSize</a> field. This code example is part of a larger example provided for the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#2
              <h3 id="methods">Methods
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.AddRef(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.AddRef(System.IntPtr)">AddRef(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Increments the reference count on the specified interface.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The common language runtime manages the reference count of a COM object for you, making it unnecessary to use this method directly. In rare cases, such as testing a custom marshaler, you might find it necessary to manipulate an object&#39;s lifetime manually. After calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a>, you must decrement the reference count by using a method such as <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a>. Do not rely on the return value of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a>, as it can sometimes be unstable.</p>
<p>You can call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a>, or <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span> to obtain an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value that represents an <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface pointer. You can also use these methods and the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a> method on managed objects to obtain the COM interfaces represented by the managed object&#39;s COM callable wrapper. If you are not familiar with the details of this wrapper type, see COM Callable Wrapper.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static int AddRef(IntPtr pUnk)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pUnk</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The common language runtime manages the reference count of a COM object for you, making it unnecessary to use this method directly. In rare cases, such as testing a custom marshaler, you might find it necessary to manipulate an object&#39;s lifetime manually. After calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a>, you must decrement the reference count by using a method such as <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a>. Do not rely on the return value of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a>, as it can sometimes be unstable.</p>
<p>You can call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a>, or <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span> to obtain an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value that represents an <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface pointer. You can also use these methods and the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a> method on managed objects to obtain the COM interfaces represented by the managed object&#39;s COM callable wrapper. If you are not familiar with the details of this wrapper type, see COM Callable Wrapper.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.AllocCoTaskMem(System.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1864">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.AllocCoTaskMem(System.Int32)">AllocCoTaskMem(Int32)</h4>
              <div class="markdown level1 summary"><p>Allocates a block of memory of specified size from the COM task memory allocator.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> is one of two memory allocation API methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a> is the other.) The initial memory content returned is undefined, and the allocated memory can be larger than the requested number of bytes. This method exposes the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148626">CoTaskMemAlloc</see> function, which is referred to as the COM task memory allocator.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr AllocCoTaskMem(int cb)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>cb</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> is one of two memory allocation API methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a> is the other.) The initial memory content returned is undefined, and the allocated memory can be larger than the requested number of bytes. This method exposes the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148626">CoTaskMemAlloc</see> function, which is referred to as the COM task memory allocator.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory to satisfy the request.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.AllocHGlobal(System.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1235">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.AllocHGlobal(System.Int32)">AllocHGlobal(Int32)</h4>
              <div class="markdown level1 summary"><p>Allocates memory from the unmanaged memory of the process by using the specified number of bytes.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a> is one of two memory allocation methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> is the other.) This method exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkId=148628">LocalAlloc</see> function from Kernel32.dll.</p>
<p>When <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_">AllocHGlobal(Int32)</a> calls <strong>LocalAlloc</strong>, it passes a <strong>LMEM_FIXED</strong> flag, which causes the allocated memory to be locked in place. Also, the allocated memory is not zero-filled.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.MayFail)]
public static IntPtr AllocHGlobal(int cb)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>cb</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a> is one of two memory allocation methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> is the other.) This method exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkId=148628">LocalAlloc</see> function from Kernel32.dll.</p>
<p>When <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_">AllocHGlobal(Int32)</a> calls <strong>LocalAlloc</strong>, it passes a <strong>LMEM_FIXED</strong> flag, which causes the allocated memory to be locked in place. Also, the allocated memory is not zero-filled.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a>method. This code example is part of a larger example provided for the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#4
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory to satisfy the request.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.AllocHGlobal(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1210">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.AllocHGlobal(System.IntPtr)">AllocHGlobal(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Allocates memory from the unmanaged memory of the process by using the pointer to the specified number of bytes.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a> is one of two memory allocation methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> is the other.) This method exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkID=148628">LocalAlloc</see> function from Kernel32.dll.</p>
<p>When <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_">AllocHGlobal(Int32)</a> calls <strong>LocalAlloc</strong>, it passes a <strong>LMEM_FIXED</strong> flag, which causes the allocated memory to be locked in place. Also, the allocated memory is not zero-filled.</p>
<p>For example code, see <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_">AllocHGlobal(Int32)</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.MayFail)]
public static IntPtr AllocHGlobal(IntPtr cb)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>cb</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a> is one of two memory allocation methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> is the other.) This method exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkID=148628">LocalAlloc</see> function from Kernel32.dll.</p>
<p>When <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_">AllocHGlobal(Int32)</a> calls <strong>LocalAlloc</strong>, it passes a <strong>LMEM_FIXED</strong> flag, which causes the allocated memory to be locked in place. Also, the allocated memory is not zero-filled.</p>
<p>For example code, see <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_Int32_">AllocHGlobal(Int32)</a>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory to satisfy the request.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_AreComObjectsAvailableForCleanup.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.AreComObjectsAvailableForCleanup%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_AreComObjectsAvailableForCleanup" data-uid="System.Runtime.InteropServices.Marshal.AreComObjectsAvailableForCleanup">AreComObjectsAvailableForCleanup()</h4>
              <div class="markdown level1 summary"><p>Indicates whether runtime callable wrappers (RCWs) from any context are available for cleanup.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_AreComObjectsAvailableForCleanup_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If there are a lot of references between managed and native code with deep dependency graphs it can take a long time for all the objects to clean up. Each time a GC runs it will free up some number of RCWs, which will in turn release the underlying COM objects. Those COM objects will then release their managed references and make more objects available for cleanup the next time a GC runs, which starts the process over again.</p>
<p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AreComObjectsAvailableForCleanup">AreComObjectsAvailableForCleanup()</a> method provides a way for the application to determine how many cycles of GC.Collect and GC.WaitForPendingFinalizers need to happen in order to clean everything up.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static bool AreComObjectsAvailableForCleanup()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Boolean.html#System_Boolean">Boolean</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_AreComObjectsAvailableForCleanup_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If there are a lot of references between managed and native code with deep dependency graphs it can take a long time for all the objects to clean up. Each time a GC runs it will free up some number of RCWs, which will in turn release the underlying COM objects. Those COM objects will then release their managed references and make more objects available for cleanup the next time a GC runs, which starts the process over again.</p>
<p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AreComObjectsAvailableForCleanup">AreComObjectsAvailableForCleanup()</a> method provides a way for the application to determine how many cycles of GC.Collect and GC.WaitForPendingFinalizers need to happen in order to clean everything up.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_AreComObjectsAvailableForCleanup_examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_Byte___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.Byte%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L376">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_Byte___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.Byte[],System.Int32,System.IntPtr,System.Int32)">Copy(Byte[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed 8-bit unsigned integer array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Byte___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(byte[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Byte___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Byte___System_Int32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory by using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Byte___System_Int32_System_IntPtr_System_Int32_">Copy(Byte[], Int32, IntPtr, Int32)</a> overload, and then copies the unmanaged array back to managed memory by using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Byte___System_Int32_System_Int32_">Copy(IntPtr, Byte[], Int32, Int32)</a>overload.</p>Runtime.InteropServices.Marshal.Copy-byte#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>startIndex</em> and <em>length</em> are not valid.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>startIndex</em>, <em>destination</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_Char___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.Char%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L351">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_Char___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.Char[],System.Int32,System.IntPtr,System.Int32)">Copy(Char[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed character array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Char___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(char[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Char.html#System_Char">Char</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Char___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Char___System_Int32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-char#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>startIndex</em> and <em>length</em> are not valid.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>startIndex</em>, <em>destination</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_Double___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.Double%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L371">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_Double___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.Double[],System.Int32,System.IntPtr,System.Int32)">Copy(Double[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed double-precision floating-point number array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Double___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(double[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Double.html#System_Double">Double</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Double___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Double___System_Int32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-double#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>startIndex</em> and <em>length</em> are not valid.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>startIndex</em>, <em>destination</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_Int16___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.Int16%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L356">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_Int16___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.Int16[],System.Int32,System.IntPtr,System.Int32)">Copy(Int16[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed 16-bit signed integer array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int16___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(short[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int16___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int16___System_Int32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-int16#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>startIndex</em> and <em>length</em> are not valid.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>startIndex</em>, <em>destination</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.Int32%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L346">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.Int32[],System.Int32,System.IntPtr,System.Int32)">Copy(Int32[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed 32-bit signed integer array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(int[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-int#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>startIndex</em> and <em>length</em> are not valid.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>startIndex</em> or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_Int64___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.Int64%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L361">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_Int64___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.Int64[],System.Int32,System.IntPtr,System.Int32)">Copy(Int64[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed 64-bit signed integer array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int64___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(long[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int64___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Int64___System_Int32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-int64#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>startIndex</em> and <em>length</em> are not valid.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>startIndex</em>, <em>destination</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Byte___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.Byte%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L422">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Byte___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.Byte[],System.Int32,System.Int32)">Copy(IntPtr, Byte[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed 8-bit unsigned integer array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Byte___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, byte[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Byte___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Byte___System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-byte#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Char___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.Char%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L397">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Char___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.Char[],System.Int32,System.Int32)">Copy(IntPtr, Char[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed character array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Char___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, char[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Char.html#System_Char">Char</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Char___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Char___System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-char#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Double___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.Double%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L417">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Double___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.Double[],System.Int32,System.Int32)">Copy(IntPtr, Double[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed double-precision floating-point number array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Double___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, double[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Double.html#System_Double">Double</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Double___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Double___System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-double#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int16___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.Int16%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L402">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int16___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.Int16[],System.Int32,System.Int32)">Copy(IntPtr, Int16[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed 16-bit signed integer array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int16___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, short[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int16___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int16___System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-int16#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int32___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.Int32%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L392">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int32___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.Int32[],System.Int32,System.Int32)">Copy(IntPtr, Int32[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed 32-bit signed integer array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int32___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, int[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int32___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int32___System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-int#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int64___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.Int64%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L407">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int64___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.Int64[],System.Int32,System.Int32)">Copy(IntPtr, Int64[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed 64-bit signed integer array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int64___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the<em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, long[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int64___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the<em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Int64___System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example copies an array to unmanaged memory and then copies the unmanaged array back to managed memory.</p>Runtime.InteropServices.Marshal.Copy-int64#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_IntPtr___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.IntPtr%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L427">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_IntPtr___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.IntPtr[],System.Int32,System.Int32)">Copy(IntPtr, IntPtr[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_IntPtr___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Therefore, the unmanaged data that corresponds to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_IntPtr___System_Int32_System_Int32_">Copy(IntPtr, IntPtr[], Int32, Int32)</a> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, IntPtr[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_IntPtr___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Therefore, the unmanaged data that corresponds to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_IntPtr___System_Int32_System_Int32_">Copy(IntPtr, IntPtr[], Int32, Int32)</a> method.</p>
</div>
              
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Single___System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%2CSystem.Single%5B%5D%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L412">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Single___System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr,System.Single[],System.Int32,System.Int32)">Copy(IntPtr, Single[], Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from an unmanaged memory pointer to a managed single-precision floating-point number array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Single___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr source, float[] destination, int startIndex, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Single.html#System_Single">Single</a>[]</td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Single___System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Unmanaged, C-style arrays do not contain bounds information, which prevents the <em>startIndex</em> and <em>length</em> parameters from being validated. Thus, the unmanaged data corresponding to the <em>source</em> parameter populates the managed array regardless of its usefulness. You must initialize the managed array with the appropriate size before calling this method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr_System_Single___System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_IntPtr___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.IntPtr%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L381">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.IntPtr[],System.Int32,System.IntPtr,System.Int32)">Copy(IntPtr[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(IntPtr[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_IntPtr___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> array to an unmanaged C-style array.</p>
</div>
              
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>destination</em>, <em>startIndex</em>, or <em>length</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Copy_System_Single___System_Int32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Copy(System.Single%5B%5D%2CSystem.Int32%2CSystem.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L366">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_Copy_System_Single___System_Int32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.Copy(System.Single[],System.Int32,System.IntPtr,System.Int32)">Copy(Single[], Int32, IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Copies data from a one-dimensional, managed single-precision floating-point number array to an unmanaged memory pointer.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Single___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void Copy(float[] source, int startIndex, IntPtr destination, int length)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Single.html#System_Single">Single</a>[]</td>
                    <td><em>source</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>startIndex</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>destination</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>length</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Single___System_Int32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to copy a subset of a one-dimensional managed array to an unmanaged C-style array.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Copy_System_Single___System_Int32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>startIndex</em> and <em>length</em> are not valid. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>source</em>, <em>startIndex</em>, <em>destination</em>, or <em>length</em> is <strong>null</strong>. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_CreateAggregatedObject_System_IntPtr_System_Object_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.CreateAggregatedObject(System.IntPtr%2CSystem.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject_System_IntPtr_System_Object_" data-uid="System.Runtime.InteropServices.Marshal.CreateAggregatedObject(System.IntPtr,System.Object)">CreateAggregatedObject(IntPtr, Object)</h4>
              <div class="markdown level1 summary"><p>Aggregates a managed object with the specified COM object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject_System_IntPtr_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateAggregatedObject_System_IntPtr_System_Object_">CreateAggregatedObject(IntPtr, Object)</a> method aggregates the inner managed pointer of a managed object with the specified outer pointer, and then returns an inner <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer of the managed object.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static IntPtr CreateAggregatedObject(IntPtr pOuter, object o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pOuter</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject_System_IntPtr_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateAggregatedObject_System_IntPtr_System_Object_">CreateAggregatedObject(IntPtr, Object)</a> method aggregates the inner managed pointer of a managed object with the specified outer pointer, and then returns an inner <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer of the managed object.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject_System_IntPtr_System_Object__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>o</em> is a Windows Runtime object.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_CreateAggregatedObject__1_System_IntPtr___0_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.CreateAggregatedObject%60%601(System.IntPtr%2C%60%600)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1839">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject__1_System_IntPtr___0_" data-uid="System.Runtime.InteropServices.Marshal.CreateAggregatedObject``1(System.IntPtr,``0)">CreateAggregatedObject&lt;T&gt;(IntPtr, T)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Aggregates a managed object of the specified type with the specified COM object. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject__1_System_IntPtr___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateAggregatedObject__1_System_IntPtr___0_">CreateAggregatedObject<t>(IntPtr, T)</t></a> method aggregates the inner managed pointer of a managed object of a specified type with the specified outer pointer, and returns an inner <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer of the managed object.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr CreateAggregatedObject&lt;T&gt;(IntPtr pOuter, T o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pOuter</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject__1_System_IntPtr___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateAggregatedObject__1_System_IntPtr___0_">CreateAggregatedObject<t>(IntPtr, T)</t></a> method aggregates the inner managed pointer of a managed object of a specified type with the specified outer pointer, and returns an inner <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer of the managed object.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateAggregatedObject__1_System_IntPtr___0__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>o</em> is a Windows Runtime object. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_CreateWrapperOfType_System_Object_System_Type_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.CreateWrapperOfType(System.Object%2CSystem.Type)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2162">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType_System_Object_System_Type_" data-uid="System.Runtime.InteropServices.Marshal.CreateWrapperOfType(System.Object,System.Type)">CreateWrapperOfType(Object, Type)</h4>
              <div class="markdown level1 summary"><p>Wraps the specified COM object in an object of the specified type.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType_System_Object_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateWrapperOfType_System_Object_System_Type_">CreateWrapperOfType(Object, Type)</a> converts one COM class type, typically the generic <strong>__ComObject</strong> type, to another COM class type. The input COM object, represented by parameter <em>o</em>, is a Runtime Callable Wrapper (RCW).</p>
<p>Both the <em>t</em> and <em>o</em> parameters must be classes whose signatures are attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a>. The Tlbimp.exe (Type Library Importer) tool applies this attribute for you when it imports a type library. If you create the RCW manually in source code, you should apply this attribute to the managed signature that represents the original coclass to signify its COM origins.</p>
<p>Tlbimp.exe imports a COM coclass as a managed class and an interface. The coclass interface has the same name as the original coclass, and the managed class has the original coclass name appended with &quot;Class&quot;. For example, a coclass called <code>MyCoclass</code> becomes a coclass interface called <code>MyCoclass</code> and a managed class called <code>MyCoclassClass</code>. Since <em>t</em> must be a class, not an interface, be sure to specify the managed class (<code>MyCoclassClass</code>) and not the coclass interface.</p>
<p>You lose the identity of the input COM object because a new RCW instance wraps the <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer exposed by the original RCW.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static object CreateWrapperOfType(object o, Type t)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>t</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType_System_Object_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateWrapperOfType_System_Object_System_Type_">CreateWrapperOfType(Object, Type)</a> converts one COM class type, typically the generic <strong>__ComObject</strong> type, to another COM class type. The input COM object, represented by parameter <em>o</em>, is a Runtime Callable Wrapper (RCW).</p>
<p>Both the <em>t</em> and <em>o</em> parameters must be classes whose signatures are attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a>. The Tlbimp.exe (Type Library Importer) tool applies this attribute for you when it imports a type library. If you create the RCW manually in source code, you should apply this attribute to the managed signature that represents the original coclass to signify its COM origins.</p>
<p>Tlbimp.exe imports a COM coclass as a managed class and an interface. The coclass interface has the same name as the original coclass, and the managed class has the original coclass name appended with &quot;Class&quot;. For example, a coclass called <code>MyCoclass</code> becomes a coclass interface called <code>MyCoclass</code> and a managed class called <code>MyCoclassClass</code>. Since <em>t</em> must be a class, not an interface, be sure to specify the managed class (<code>MyCoclassClass</code>) and not the coclass interface.</p>
<p>You lose the identity of the input COM object because a new RCW instance wraps the <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer exposed by the original RCW.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType_System_Object_System_Type__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>t</em> must derive from <strong>__ComObject</strong>.</p>
<p>-or-</p>
<p>
<em>t</em> is a Windows Runtime type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>t</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>
<em>o</em> cannot be converted to the destination type because it does not support all required interfaces. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_CreateWrapperOfType__2___0_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.CreateWrapperOfType%60%602(%60%600)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2209">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType__2___0_" data-uid="System.Runtime.InteropServices.Marshal.CreateWrapperOfType``2(``0)">CreateWrapperOfType&lt;T, TWrapper&gt;(T)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Wraps the specified COM object in an object of the specified type.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType__2___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateWrapperOfType__2___0_">CreateWrapperOfType<t, twrapper="">(T)</t,></a> converts a COM object of type <em>T</em> to the <em>TWrapper</em> COM class type. The input COM object, represented by parameter <em>o</em>, is a Runtime Callable Wrapper (RCW).</p>
<p>Both the <em>T</em>generic type parameter and the <em>o</em> parameter must be classes whose signatures are attributed with the <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> attribute. The Tlbimp.exe (Type Library Importer) tool applies this attribute for you when it imports a type library. If you create the RCW manually in source code, you should apply this attribute to the managed signature that represents the original coclass to signify its COM origins.</p>
<p>Tlbimp.exe imports a COM coclass as a managed class and an interface. The coclass interface has the same name as the original coclass, and the managed class has the original coclass name appended with &quot;Class&quot;. For example, a coclass called <code>MyCoclass</code> becomes a coclass interface called <code>MyCoclass</code> and a managed class called <code>MyCoclassClass</code>. Because<em>T</em> must be a class, not an interface, be sure to specify the managed class (<code>MyCoclassClass</code>) and not the <strong>coclass</strong> interface.</p>
<p>You lose the identity of the input COM object, because a new RCW instance wraps the <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer exposed by the original RCW.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static TWrapper CreateWrapperOfType&lt;T, TWrapper&gt;(T o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">TWrapper</span></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType__2___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_CreateWrapperOfType__2___0_">CreateWrapperOfType<t, twrapper="">(T)</t,></a> converts a COM object of type <em>T</em> to the <em>TWrapper</em> COM class type. The input COM object, represented by parameter <em>o</em>, is a Runtime Callable Wrapper (RCW).</p>
<p>Both the <em>T</em>generic type parameter and the <em>o</em> parameter must be classes whose signatures are attributed with the <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> attribute. The Tlbimp.exe (Type Library Importer) tool applies this attribute for you when it imports a type library. If you create the RCW manually in source code, you should apply this attribute to the managed signature that represents the original coclass to signify its COM origins.</p>
<p>Tlbimp.exe imports a COM coclass as a managed class and an interface. The coclass interface has the same name as the original coclass, and the managed class has the original coclass name appended with &quot;Class&quot;. For example, a coclass called <code>MyCoclass</code> becomes a coclass interface called <code>MyCoclass</code> and a managed class called <code>MyCoclassClass</code>. Because<em>T</em> must be a class, not an interface, be sure to specify the managed class (<code>MyCoclassClass</code>) and not the <strong>coclass</strong> interface.</p>
<p>You lose the identity of the input COM object, because a new RCW instance wraps the <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> pointer exposed by the original RCW.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_CreateWrapperOfType__2___0__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>T</em> must derive from <strong>__ComObject</strong>. </p>
<p>-or-</p>
<p>
<em>T</em> is a Windows Runtime type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>
<em>o</em> cannot be converted to the <em>TWrapper</em> because it does not support all required interfaces. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.DestroyStructure(System.IntPtr%2CSystem.Type)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_" data-uid="System.Runtime.InteropServices.Marshal.DestroyStructure(System.IntPtr,System.Type)">DestroyStructure(IntPtr, Type)</h4>
              <div class="markdown level1 summary"><p>Frees all substructures that the specified unmanaged memory block points to.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to free reference-type fields, such as strings, of an unmanaged structure. Unlike its fields, a structure can be a value type or a reference type. Value-type structures that contain value-type fields (all blittable) have no references whose memory must be freed. The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> method uses this method to prevent memory leaks when reusing memory occupied by a structure.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> calls the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148633">SysFreeString</see> function, which, in turn, frees an allocated string.</p>
<p>In addition to <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a>, the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class provides two other memory-deallocation methods: <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
[ComVisible(true)]
public static void DestroyStructure(IntPtr ptr, Type structuretype)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>structuretype</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to free reference-type fields, such as strings, of an unmanaged structure. Unlike its fields, a structure can be a value type or a reference type. Value-type structures that contain value-type fields (all blittable) have no references whose memory must be freed. The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> method uses this method to prevent memory leaks when reusing memory occupied by a structure.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> calls the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148633">SysFreeString</see> function, which, in turn, frees an allocated string.</p>
<p>In addition to <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a>, the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class provides two other memory-deallocation methods: <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>structureType</em> has an automatic layout. Use sequential or explicit instead.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.DestroyStructure%60%601(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1069">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.DestroyStructure``1(System.IntPtr)">DestroyStructure&lt;T&gt;(IntPtr)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Frees all substructures of a specified type that the specified unmanaged memory block points to. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to free reference type fields, such as strings, of an unmanaged structure. Unlike its fields, a structure can be a value type or a reference type. Value type structures that contain value type fields (all blittable) have no references whose memory must be freed. The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> method uses this method to prevent memory leaks when reusing memory occupied by a structure.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> calls the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148633">SysFreeString</see> function, which, in turn, frees an allocated string.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void DestroyStructure&lt;T&gt;(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method to free reference type fields, such as strings, of an unmanaged structure. Unlike its fields, a structure can be a value type or a reference type. Value type structures that contain value type fields (all blittable) have no references whose memory must be freed. The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> method uses this method to prevent memory leaks when reusing memory occupied by a structure.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> calls the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148633">SysFreeString</see> function, which, in turn, frees an allocated string.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>T</em> has an automatic layout. Use sequential or explicit instead. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.FinalReleaseComObject(System.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2060">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_" data-uid="System.Runtime.InteropServices.Marshal.FinalReleaseComObject(System.Object)">FinalReleaseComObject(Object)</h4>
              <div class="markdown level1 summary"><p>Releases all references to a Runtime Callable Wrapper (RCW) by setting its reference count to 0.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> method releases the managed reference to a COM object. Calling this method is equivalent to calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method in a loop until it returns 0 (zero).</p>
<p>When the reference count on the COM object becomes 0, the COM object is usually freed, although this depends on the COM object&#39;s implementation and is beyond the control of the runtime. However, the RCW can still exist, waiting to be garbage-collected.</p>
<p>The COM object cannot be used after it has been separated from its underlying RCW. If you try to call a method on the RCW after its reference count becomes 0, a <a class="xref" href="System.Runtime.InteropServices.InvalidComObjectException.html#System_Runtime_InteropServices_InvalidComObjectException">InvalidComObjectException</a> will be thrown.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static int FinalReleaseComObject(object o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> method releases the managed reference to a COM object. Calling this method is equivalent to calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method in a loop until it returns 0 (zero).</p>
<p>When the reference count on the COM object becomes 0, the COM object is usually freed, although this depends on the COM object&#39;s implementation and is beyond the control of the runtime. However, the RCW can still exist, waiting to be garbage-collected.</p>
<p>The COM object cannot be used after it has been separated from its underlying RCW. If you try to call a method on the RCW after its reference count becomes 0, a <a class="xref" href="System.Runtime.InteropServices.InvalidComObjectException.html#System_Runtime_InteropServices_InvalidComObjectException">InvalidComObjectException</a> will be thrown.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>o</em> is not a valid COM object.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>o</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.FreeBSTR(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1997">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.FreeBSTR(System.IntPtr)">FreeBSTR(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees a <strong>BSTR</strong> using the COM <see href="http://go.microsoft.com/fwlink/?LinkID=148633">SysFreeString</see> function.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Like <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>, you can use this method to deallocate memory. <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr_">FreeBSTR(IntPtr)</a> calls the COM <see href="http://go.microsoft.com/fwlink/?LinkID=148633">SysFreeString</see> function, which frees memory allocated by any of the following unmanaged methods: <strong>SysAllocString</strong>, <strong>SysAllocStringByteLen</strong>, <strong>SysAllocStringLen</strong>, <strong>SysReAllocString</strong>, <strong>SysReAllocStringLen</strong>. You can call unmanaged methods such as these with platform invoke. For details, see Consuming Unmanaged DLL Functions.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void FreeBSTR(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Like <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>, you can use this method to deallocate memory. <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr_">FreeBSTR(IntPtr)</a> calls the COM <see href="http://go.microsoft.com/fwlink/?LinkID=148633">SysFreeString</see> function, which frees memory allocated by any of the following unmanaged methods: <strong>SysAllocString</strong>, <strong>SysAllocStringByteLen</strong>, <strong>SysAllocStringLen</strong>, <strong>SysReAllocString</strong>, <strong>SysReAllocStringLen</strong>. You can call unmanaged methods such as these with platform invoke. For details, see Consuming Unmanaged DLL Functions.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.FreeCoTaskMem(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1975">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.FreeCoTaskMem(System.IntPtr)">FreeCoTaskMem(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees a block of memory allocated by the unmanaged COM task memory allocator.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> to free any memory allocated by <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_">ReAllocCoTaskMem(IntPtr, Int32)</a>, or any equivalent unmanaged method. If the <em>ptr</em> parameter is <strong>null</strong>, the method does nothing.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> exposes the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148638">CoTaskMemFree</see> function, which frees all bytes so that you can no longer use the memory that the <em>ptr</em> parameter points to.</p>
<p>In addition to <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>, the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class provides two other memory-deallocation methods: <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void FreeCoTaskMem(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> to free any memory allocated by <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_">ReAllocCoTaskMem(IntPtr, Int32)</a>, or any equivalent unmanaged method. If the <em>ptr</em> parameter is <strong>null</strong>, the method does nothing.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a> exposes the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148638">CoTaskMemFree</see> function, which frees all bytes so that you can no longer use the memory that the <em>ptr</em> parameter points to.</p>
<p>In addition to <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>, the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class provides two other memory-deallocation methods: <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.FreeHGlobal(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1242">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.FreeHGlobal(System.IntPtr)">FreeHGlobal(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees memory previously allocated from the unmanaged memory of the process.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a> to free any memory from the global heap allocated by <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_">ReAllocHGlobal(IntPtr, IntPtr)</a>, or any equivalent unmanaged API method. If the <em>hglobal</em> parameter is <a class="xref" href="System.IntPtr.html#System_IntPtr_Zero">Zero</a> the method does nothing.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a> exposes the <see href="http://go.microsoft.com/fwlink/?LinkId=148640">LocalFree</see> function from Kernel32.DLL, which frees all bytes so that you can no longer use the memory pointed to by <em>hglobal</em>.</p>
<p>In addition to <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>, the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class provides two other memory-deallocation API methods: <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static void FreeHGlobal(IntPtr hglobal)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>hglobal</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a> to free any memory from the global heap allocated by <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_">ReAllocHGlobal(IntPtr, IntPtr)</a>, or any equivalent unmanaged API method. If the <em>hglobal</em> parameter is <a class="xref" href="System.IntPtr.html#System_IntPtr_Zero">Zero</a> the method does nothing.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a> exposes the <see href="http://go.microsoft.com/fwlink/?LinkId=148640">LocalFree</see> function from Kernel32.DLL, which frees all bytes so that you can no longer use the memory pointed to by <em>hglobal</em>.</p>
<p>In addition to <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>, the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class provides two other memory-deallocation API methods: <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a> method. This code example is part of a larger example provided for the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#4<p>The following example demonstrates how to convert the contents of a managed <a class="xref" href="System.String.html#System_String">String</a> class to unmanaged memory and then dispose of the unmanaged memory when done. </p>Runtime.InteropServices.Marshal.StringToHGlobalAnsi#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetComInterfaceForObject(System.Object%2CSystem.Type)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1768">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_" data-uid="System.Runtime.InteropServices.Marshal.GetComInterfaceForObject(System.Object,System.Type)">GetComInterfaceForObject(Object, Type)</h4>
              <div class="markdown level1 summary"><p>Returns a pointer to an <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface that represents the specified interface on the specified object. Custom query interface access is enabled by default.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method returns an interface pointer that represents the requested interface on the specified object. It is particularly useful if you have an unmanaged method that expects to be passed an interface pointer. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> to decrement the reference count once you have finished with the pointer. You must adhere to the rules defined by COM when using raw COM interface pointers.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> is useful when calling a method that exposes a COM object parameter as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> type, or with custom marshaling. Although less common, you can use this method on a managed object to obtain a pointer to the object&#39;s COM callable wrapper. For example, you can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> on a managed object that is exported to COM to obtain an interface pointer for <span class="xref">System.Runtime.InteropServices.UCOMIConnectionPointContainer</span>. You cannot obtain a pointer to a class interface since a class interface lacks the corresponding type to pass to the second parameter (<em>t</em>). Instead, use <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span> to invoke the members on the default interface of the COM callable wrapper, which is usually an auto-dispatch class interface.</p>
<p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> method overload allows query interface customization by default. To specify whether to apply query interface customization, use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_">GetComInterfaceForObject(Object, Type, CustomQueryInterfaceMode)</a> method overload. </p>
<p>For additional information, see the COM Callable Wrapper, Runtime Callable Wrapper, and Introducing the Class Interface topics.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr GetComInterfaceForObject(object o, Type T)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>T</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method returns an interface pointer that represents the requested interface on the specified object. It is particularly useful if you have an unmanaged method that expects to be passed an interface pointer. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> to decrement the reference count once you have finished with the pointer. You must adhere to the rules defined by COM when using raw COM interface pointers.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> is useful when calling a method that exposes a COM object parameter as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> type, or with custom marshaling. Although less common, you can use this method on a managed object to obtain a pointer to the object&#39;s COM callable wrapper. For example, you can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> on a managed object that is exported to COM to obtain an interface pointer for <span class="xref">System.Runtime.InteropServices.UCOMIConnectionPointContainer</span>. You cannot obtain a pointer to a class interface since a class interface lacks the corresponding type to pass to the second parameter (<em>t</em>). Instead, use <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span> to invoke the members on the default interface of the COM callable wrapper, which is usually an auto-dispatch class interface.</p>
<p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> method overload allows query interface customization by default. To specify whether to apply query interface customization, use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_">GetComInterfaceForObject(Object, Type, CustomQueryInterfaceMode)</a> method overload. </p>
<p>For additional information, see the COM Callable Wrapper, Runtime Callable Wrapper, and Introducing the Class Interface topics.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>T</em> parameter is not an interface.</p>
<p>-or-</p>
<p>The type is not visible to COM. </p>
<p>-or-</p>
<p>The <em>T</em> parameter is a generic type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>The <em>o</em> parameter does not support the requested interface. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>o</em> parameter is <strong>null</strong>.</p>
<p>-or- </p>
<p>The <em>T</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetComInterfaceForObject(System.Object%2CSystem.Type%2CSystem.Runtime.InteropServices.CustomQueryInterfaceMode)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1785">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_" data-uid="System.Runtime.InteropServices.Marshal.GetComInterfaceForObject(System.Object,System.Type,System.Runtime.InteropServices.CustomQueryInterfaceMode)">GetComInterfaceForObject(Object, Type, CustomQueryInterfaceMode)</h4>
              <div class="markdown level1 summary"><p>Returns a pointer to an <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface that represents the specified interface on the specified object. Custom query interface access is controlled by the specified customization mode.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_">GetComInterfaceForObject(Object, Type, CustomQueryInterfaceMode)</a>lets you specify whether to apply query interface customization. Use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> overload to apply query interface customization by default.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr GetComInterfaceForObject(object o, Type T, CustomQueryInterfaceMode mode)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>T</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Runtime.InteropServices.CustomQueryInterfaceMode.html#System_Runtime_InteropServices_CustomQueryInterfaceMode">CustomQueryInterfaceMode</a></td>
                    <td><em>mode</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_">GetComInterfaceForObject(Object, Type, CustomQueryInterfaceMode)</a>lets you specify whether to apply query interface customization. Use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a> overload to apply query interface customization by default.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>T</em> parameter is not an interface.</p>
<p>-or- </p>
<p>The type is not visible to COM.</p>
<p>-or-</p>
<p>The <em>T</em> parameter is a generic type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>The object <em>o</em> does not support the requested interface.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>o</em> parameter is <strong>null</strong>.</p>
<p>-or- </p>
<p>The <em>T</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetComInterfaceForObject%60%602(%60%600)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1774">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_" data-uid="System.Runtime.InteropServices.Marshal.GetComInterfaceForObject``2(``0)">GetComInterfaceForObject&lt;T, TInterface&gt;(T)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Returns a pointer to an <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface that represents the specified interface on an object of the specified type. Custom query interface access is enabled by default.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method returns an interface pointer that represents the <em>TInterface</em> interface on the specified object. It is particularly useful if you have an unmanaged method that expects to be passed an interface pointer. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a>method to decrement the reference count when you have finished with the pointer. You must adhere to the rules defined by COM when using raw COM interface pointers.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_">GetComInterfaceForObject<t, tinterface="">(T)</t,></a> is useful when calling a method that exposes a COM object parameter as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> type, or with custom marshaling. You can also use this method on a managed object to obtain a pointer to the object&#39;s COM callable wrapper, although this is less common. For example, you can use<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_">GetComInterfaceForObject<t, tinterface="">(T)</t,></a> on a managed object that is exported to COM to obtain an interface pointer for <span class="xref">System.Runtime.InteropServices.UCOMIConnectionPointContainer</span>.</p>
<p>The<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_">GetComInterfaceForObject<t, tinterface="">(T)</t,></a> method overload allows query interface customization by default. To specify whether to apply query interface customization, use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_">GetComInterfaceForObject(Object, Type, CustomQueryInterfaceMode)</a> method overload. </p>
<p>For additional information, see the COM Callable Wrapper, Runtime Callable Wrapper, and Introducing the Class Interface topics.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr GetComInterfaceForObject&lt;T, TInterface&gt;(T o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method returns an interface pointer that represents the <em>TInterface</em> interface on the specified object. It is particularly useful if you have an unmanaged method that expects to be passed an interface pointer. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a>method to decrement the reference count when you have finished with the pointer. You must adhere to the rules defined by COM when using raw COM interface pointers.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_">GetComInterfaceForObject<t, tinterface="">(T)</t,></a> is useful when calling a method that exposes a COM object parameter as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> type, or with custom marshaling. You can also use this method on a managed object to obtain a pointer to the object&#39;s COM callable wrapper, although this is less common. For example, you can use<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_">GetComInterfaceForObject<t, tinterface="">(T)</t,></a> on a managed object that is exported to COM to obtain an interface pointer for <span class="xref">System.Runtime.InteropServices.UCOMIConnectionPointContainer</span>.</p>
<p>The<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0_">GetComInterfaceForObject<t, tinterface="">(T)</t,></a> method overload allows query interface customization by default. To specify whether to apply query interface customization, use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_System_Runtime_InteropServices_CustomQueryInterfaceMode_">GetComInterfaceForObject(Object, Type, CustomQueryInterfaceMode)</a> method overload. </p>
<p>For additional information, see the COM Callable Wrapper, Runtime Callable Wrapper, and Introducing the Class Interface topics.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetComInterfaceForObject__2___0__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>TInterface</em> parameter is not an interface.</p>
<p>-or- </p>
<p>The type is not visible to COM. </p>
<p>-or-</p>
<p>The <em>T</em> parameter is an open generic type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>The <em>o</em> parameter does not support the <em>TInterface</em> interface. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>o</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer(System.IntPtr%2CSystem.Type)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2613">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_" data-uid="System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer(System.IntPtr,System.Type)">GetDelegateForFunctionPointer(IntPtr, Type)</h4>
              <div class="markdown level1 summary"><p>Converts an unmanaged function pointer to a delegate.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>In versions 1.0 and 1.1 of the .NET Framework, it was possible to pass a delegate representing a managed method to unmanaged code as a function pointer, allowing the unmanaged code to call the managed method through the function pointer. It was also possible for the unmanaged code to pass that function pointer back to the managed code, and the pointer was resolved properly to the underlying managed method.</p></p>
<p><p>In the .NET Framework 2.0 and later versions, you can use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_">GetDelegateForFunctionPointer(IntPtr, Type)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate_">GetFunctionPointerForDelegate(Delegate)</a> methods to marshal delegates in both directions. With <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_">GetDelegateForFunctionPointer(IntPtr, Type)</a>, <em>ptr</em> is imported as a <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a>. A <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> can be obtained for a managed delegate by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate_">GetFunctionPointerForDelegate(Delegate)</a> and passed as a parameter; it can then be called from inside the unmanaged method. Note that the parameter marshaler can also marshal function pointers to delegates in the .NET Framework 2.0 and later versions.</p></p>
<p><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_">GetDelegateForFunctionPointer(IntPtr, Type)</a> method has the following restrictions:</p></p>
<ul><li>
<p>Generics are not supported in interop scenarios.</p>
</li><li>
<p>You cannot pass an invalid function pointer to this method.</p>
</li><li>
<p>You can use this method only for pure unmanaged function pointers.</p>
</li><li>
<p>You cannot use this method with function pointers obtained through C++ or from the <span class="xref">System.RuntimeMethodHandle.GetFunctionPointer</span> method.</p>
</li><li>
<p>You cannot use this method to create a delegate from a function pointer to another managed delegate.</p>
</li></ul>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static Delegate GetDelegateForFunctionPointer(IntPtr ptr, Type t)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>t</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Delegate.html#System_Delegate">Delegate</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>In versions 1.0 and 1.1 of the .NET Framework, it was possible to pass a delegate representing a managed method to unmanaged code as a function pointer, allowing the unmanaged code to call the managed method through the function pointer. It was also possible for the unmanaged code to pass that function pointer back to the managed code, and the pointer was resolved properly to the underlying managed method.</p></p>
<p><p>In the .NET Framework 2.0 and later versions, you can use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_">GetDelegateForFunctionPointer(IntPtr, Type)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate_">GetFunctionPointerForDelegate(Delegate)</a> methods to marshal delegates in both directions. With <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_">GetDelegateForFunctionPointer(IntPtr, Type)</a>, <em>ptr</em> is imported as a <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a>. A <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> can be obtained for a managed delegate by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate_">GetFunctionPointerForDelegate(Delegate)</a> and passed as a parameter; it can then be called from inside the unmanaged method. Note that the parameter marshaler can also marshal function pointers to delegates in the .NET Framework 2.0 and later versions.</p></p>
<p><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type_">GetDelegateForFunctionPointer(IntPtr, Type)</a> method has the following restrictions:</p></p>
<ul><li>
<p>Generics are not supported in interop scenarios.</p>
</li><li>
<p>You cannot pass an invalid function pointer to this method.</p>
</li><li>
<p>You can use this method only for pure unmanaged function pointers.</p>
</li><li>
<p>You cannot use this method with function pointers obtained through C++ or from the <span class="xref">System.RuntimeMethodHandle.GetFunctionPointer</span> method.</p>
</li><li>
<p>You cannot use this method to create a delegate from a function pointer to another managed delegate.</p>
</li></ul>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer_System_IntPtr_System_Type__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>t</em> parameter is not a delegate or is generic.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>ptr</em> parameter is <strong>null</strong>.</p>
<p>-or-</p>
<p>The <em>t</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer%60%601(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2637">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetDelegateForFunctionPointer``1(System.IntPtr)">GetDelegateForFunctionPointer&lt;TDelegate&gt;(IntPtr)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Converts an unmanaged function pointer to a delegate of a specified type. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>You can use the<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr_">GetDelegateForFunctionPointer<tdelegate>(IntPtr)</tdelegate></a> and<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate__1___0_">GetFunctionPointerForDelegate<tdelegate>(TDelegate)</tdelegate></a>methods to marshal delegates in both directions. </p></p>
<p><p>The<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr_">GetDelegateForFunctionPointer<tdelegate>(IntPtr)</tdelegate></a> method has the following restrictions:</p></p>
<ul><li>
<p>You cannot pass an invalid function pointer to this method.</p>
</li><li>
<p>You can use this method only for pure unmanaged function pointers.</p>
</li><li>
<p>You cannot use this method with function pointers obtained through C++ or from the <span class="xref">System.RuntimeMethodHandle.GetFunctionPointer</span> method.</p>
</li><li>
<p>You cannot use this method to create a delegate from a function pointer to another managed delegate.</p>
</li></ul>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static TDelegate GetDelegateForFunctionPointer&lt;TDelegate&gt;(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">TDelegate</span></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>You can use the<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr_">GetDelegateForFunctionPointer<tdelegate>(IntPtr)</tdelegate></a> and<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate__1___0_">GetFunctionPointerForDelegate<tdelegate>(TDelegate)</tdelegate></a>methods to marshal delegates in both directions. </p></p>
<p><p>The<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr_">GetDelegateForFunctionPointer<tdelegate>(IntPtr)</tdelegate></a> method has the following restrictions:</p></p>
<ul><li>
<p>You cannot pass an invalid function pointer to this method.</p>
</li><li>
<p>You can use this method only for pure unmanaged function pointers.</p>
</li><li>
<p>You cannot use this method with function pointers obtained through C++ or from the <span class="xref">System.RuntimeMethodHandle.GetFunctionPointer</span> method.</p>
</li><li>
<p>You cannot use this method to create a delegate from a function pointer to another managed delegate.</p>
</li></ul>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetDelegateForFunctionPointer__1_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>TDelegate</em> generic parameter is not a delegate, or it is an open generic type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>ptr</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetExceptionCode.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetExceptionCode%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetExceptionCode" data-uid="System.Runtime.InteropServices.Marshal.GetExceptionCode">GetExceptionCode()</h4>
              <div class="markdown level1 summary"><p>Retrieves a code that identifies the type of the exception that occurred.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionCode_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetExceptionCode">GetExceptionCode()</a> is exposed for compiler support of structured exception handling (SEH) only. If this method is called before an exception is thrown, it returns 0x0.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static int GetExceptionCode()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionCode_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetExceptionCode">GetExceptionCode()</a> is exposed for compiler support of structured exception handling (SEH) only. If this method is called before an exception is thrown, it returns 0x0.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionCode_examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetExceptionForHR(System.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1129">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.GetExceptionForHR(System.Int32)">GetExceptionForHR(Int32)</h4>
              <div class="markdown level1 summary"><p>Converts the specified HRESULT error code to a corresponding <a class="xref" href="System.Exception.html#System_Exception">Exception</a> object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Use the <see cref="Overload:System.Runtime.InteropServices.Marshal.GetExceptionForHR"></see> method to get an <a class="xref" href="System.Exception.html#System_Exception">Exception</a> based on an HRESULT without having to call the <see cref="Overload:System.Runtime.InteropServices.Marshal.ThrowExceptionForHR"></see> method and catch the exception.</p>
<p>The current IErrorInfo interface is used to construct the exception.</p>
<p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static Exception GetExceptionForHR(int errorCode)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>errorCode</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Exception.html#System_Exception">Exception</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Use the <see cref="Overload:System.Runtime.InteropServices.Marshal.GetExceptionForHR"></see> method to get an <a class="xref" href="System.Exception.html#System_Exception">Exception</a> based on an HRESULT without having to call the <see cref="Overload:System.Runtime.InteropServices.Marshal.ThrowExceptionForHR"></see> method and catch the exception.</p>
<p>The current IErrorInfo interface is used to construct the exception.</p>
<p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetExceptionForHR(System.Int32%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1137">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetExceptionForHR(System.Int32,System.IntPtr)">GetExceptionForHR(Int32, IntPtr)</h4>
              <div class="markdown level1 summary"><p>Converts the specified HRESULT error code to a corresponding <a class="xref" href="System.Exception.html#System_Exception">Exception</a> object, with additional error information passed in an IErrorInfo interface for the exception object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Use the <see cref="Overload:System.Runtime.InteropServices.Marshal.GetExceptionForHR"></see> method to get an <a class="xref" href="System.Exception.html#System_Exception">Exception</a> based on an HRESULT without having to call the <see cref="Overload:System.Runtime.InteropServices.Marshal.ThrowExceptionForHR"></see> method and catch the exception (thus avoiding the corresponding performance overhead). The <em>errorInfo</em> parameter supplies additional information about the error, such as its textual description and the globally unique identifier (GUID) for the interface that defined the error.</p>
<p>Use this method overload if you have custom error information that you have to supply in the conversion.</p>
<p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static Exception GetExceptionForHR(int errorCode, IntPtr errorInfo)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>errorCode</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>errorInfo</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Exception.html#System_Exception">Exception</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Use the <see cref="Overload:System.Runtime.InteropServices.Marshal.GetExceptionForHR"></see> method to get an <a class="xref" href="System.Exception.html#System_Exception">Exception</a> based on an HRESULT without having to call the <see cref="Overload:System.Runtime.InteropServices.Marshal.ThrowExceptionForHR"></see> method and catch the exception (thus avoiding the corresponding performance overhead). The <em>errorInfo</em> parameter supplies additional information about the error, such as its textual description and the globally unique identifier (GUID) for the interface that defined the error.</p>
<p>Use this method overload if you have custom error information that you have to supply in the conversion.</p>
<p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetExceptionForHR_System_Int32_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetFunctionPointerForDelegate(System.Delegate)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2646">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate_" data-uid="System.Runtime.InteropServices.Marshal.GetFunctionPointerForDelegate(System.Delegate)">GetFunctionPointerForDelegate(Delegate)</h4>
              <div class="markdown level1 summary"><p>Converts a delegate into a function pointer that is callable from unmanaged code.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The delegate <em>d</em> is converted to a function pointer that can be passed to unmanaged code using the __stdcall calling convention.</p>
<p>You must manually keep the delegate from being collected by the garbage collector from managed code. The garbage collector does not track references to unmanaged code.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr GetFunctionPointerForDelegate(Delegate d)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Delegate.html#System_Delegate">Delegate</a></td>
                    <td><em>d</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The delegate <em>d</em> is converted to a function pointer that can be passed to unmanaged code using the __stdcall calling convention.</p>
<p>You must manually keep the delegate from being collected by the garbage collector from managed code. The garbage collector does not track references to unmanaged code.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate_System_Delegate__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>d</em> parameter is a generic type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>d</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate__1___0_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetFunctionPointerForDelegate%60%601(%60%600)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2656">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate__1___0_" data-uid="System.Runtime.InteropServices.Marshal.GetFunctionPointerForDelegate``1(``0)">GetFunctionPointerForDelegate&lt;TDelegate&gt;(TDelegate)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Converts a delegate of a specified type to a function pointer that is callable from unmanaged code. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate__1___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The delegate <em>d</em> is converted to a function pointer that can be passed to unmanaged code by using the __stdcall calling convention.</p>
<p>You must manually keep the delegate from being collected by the garbage collector from managed code. The garbage collector does not track references to unmanaged code.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr GetFunctionPointerForDelegate&lt;TDelegate&gt;(TDelegate d)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">TDelegate</span></td>
                    <td><em>d</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate__1___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The delegate <em>d</em> is converted to a function pointer that can be passed to unmanaged code by using the __stdcall calling convention.</p>
<p>You must manually keep the delegate from being collected by the garbage collector from managed code. The garbage collector does not track references to unmanaged code.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetFunctionPointerForDelegate__1___0__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>d</em> parameter is <strong>null</strong>. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetHRForException(System.Exception)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_" data-uid="System.Runtime.InteropServices.Marshal.GetHRForException(System.Exception)">GetHRForException(Exception)</h4>
              <div class="markdown level1 summary"><p>Converts the specified exception to an HRESULT.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_">GetHRForException(Exception)</a> also sets up an <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface for the exception that can be obtained by calling the COM GetErrorInfoNEEDGUID function. You can use this function to return an HRESULT value on a managed class implementation of a COM interface where you apply the <a class="xref" href="System.Runtime.InteropServices.PreserveSigAttribute.html#System_Runtime_InteropServices_PreserveSigAttribute">PreserveSigAttribute</a> attribute. Have the attributed method catch all exceptions and use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_">GetHRForException(Exception)</a> method to return the appropriate HRESULT value. Allowing an exception to propagate outside the method produces incorrect behavior. (In fact, the common language runtime fails to pass an exception to a COM client that calls such a method through a v-table.)</p>
<p>Note that the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_">GetHRForException(Exception)</a> method sets the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface of the current thread. This can cause unexpected results for methods like the <see cref="Overload:System.Runtime.InteropServices.Marshal.ThrowExceptionForHR"></see> methods that default to using the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> of the current thread if it is set.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static int GetHRForException(Exception e)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Exception.html#System_Exception">Exception</a></td>
                    <td><em>e</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_">GetHRForException(Exception)</a> also sets up an <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface for the exception that can be obtained by calling the COM GetErrorInfoNEEDGUID function. You can use this function to return an HRESULT value on a managed class implementation of a COM interface where you apply the <a class="xref" href="System.Runtime.InteropServices.PreserveSigAttribute.html#System_Runtime_InteropServices_PreserveSigAttribute">PreserveSigAttribute</a> attribute. Have the attributed method catch all exceptions and use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_">GetHRForException(Exception)</a> method to return the appropriate HRESULT value. Allowing an exception to propagate outside the method produces incorrect behavior. (In fact, the common language runtime fails to pass an exception to a COM client that calls such a method through a v-table.)</p>
<p>Note that the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception_">GetHRForException(Exception)</a> method sets the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface of the current thread. This can cause unexpected results for methods like the <see cref="Overload:System.Runtime.InteropServices.Marshal.ThrowExceptionForHR"></see> methods that default to using the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> of the current thread if it is set.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetHRForException_System_Exception__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetHRForLastWin32Error.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetHRForLastWin32Error%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L899">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetHRForLastWin32Error" data-uid="System.Runtime.InteropServices.Marshal.GetHRForLastWin32Error">GetHRForLastWin32Error()</h4>
              <div class="markdown level1 summary"><p>Returns the HRESULT corresponding to the last error incurred by Win32 code executed using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetHRForLastWin32Error_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The target function must have had the <strong>setLastError</strong> metadata flag set. For example, the <strong>SetLastError</strong> field of the <a class="xref" href="System.Runtime.InteropServices.DllImportAttribute.html#System_Runtime_InteropServices_DllImportAttribute">DllImportAttribute</a> must be <strong>true</strong>. The process for setting this flag depends on the source language used: C# and C++ are <strong>false</strong> by default, but the <strong>Declare</strong> statement in Visual Basic is <strong>true</strong>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static int GetHRForLastWin32Error()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetHRForLastWin32Error_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The target function must have had the <strong>setLastError</strong> metadata flag set. For example, the <strong>SetLastError</strong> field of the <a class="xref" href="System.Runtime.InteropServices.DllImportAttribute.html#System_Runtime_InteropServices_DllImportAttribute">DllImportAttribute</a> must be <strong>true</strong>. The process for setting this flag depends on the source language used: C# and C++ are <strong>false</strong> by default, but the <strong>Declare</strong> statement in Visual Basic is <strong>true</strong>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetHRForLastWin32Error_examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve an HRESULT corresponding to a Win32 error code using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetHRForLastWin32Error">GetHRForLastWin32Error()</a> method.</p>Runtime.InteropServices.Marshal.GetHRForLastWin32Error#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetIUnknownForObject(System.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1718">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_" data-uid="System.Runtime.InteropServices.Marshal.GetIUnknownForObject(System.Object)">GetIUnknownForObject(Object)</h4>
              <div class="markdown level1 summary"><p>Returns an <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface from a managed object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>In managed code, you seldom work directly with the <strong>IUnknown</strong> interface. However, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a> is useful when calling a method that exposes a COM object parameter as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> type, or with custom marshaling. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> to decrement the reference count once you have finished with the pointer. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr_">GetObjectForIUnknown(IntPtr)</a> method.</p>
<p>You can also use this method on a managed object to obtain an interface pointer to the COM Callable Wrapper for the object.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr GetIUnknownForObject(object o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>In managed code, you seldom work directly with the <strong>IUnknown</strong> interface. However, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a> is useful when calling a method that exposes a COM object parameter as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> type, or with custom marshaling. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> to decrement the reference count once you have finished with the pointer. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr_">GetObjectForIUnknown(IntPtr)</a> method.</p>
<p>You can also use this method on a managed object to obtain an interface pointer to the COM Callable Wrapper for the object.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object__examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve an <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface for a managed object using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a> method.</p>Runtime.InteropServices.Marshal.GetIUnknownForObject-release#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetLastWin32Error.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetLastWin32Error%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetLastWin32Error" data-uid="System.Runtime.InteropServices.Marshal.GetLastWin32Error">GetLastWin32Error()</h4>
              <div class="markdown level1 summary"><p>Returns the error code returned by the last unmanaged function that was called using platform invoke that has the <a class="xref" href="System.Runtime.InteropServices.DllImportAttribute.html#System_Runtime_InteropServices_DllImportAttribute_SetLastError">SetLastError</a> flag set.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetLastWin32Error_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a> exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkId=148657">GetLastError</see> function from Kernel32.DLL. This method exists because it is not safe to make a direct platform invoke call to <strong>GetLastError</strong> to obtain this information. If you want to access this error code, you must call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a> instead of writing your own platform invoke definition for <strong>GetLastError</strong> and calling it. The common language runtime can make internal calls to APIs that overwrite the <strong>GetLastError</strong> maintained by the operating system.</p>
<p>You can use this method to obtain error codes only if you apply the <a class="xref" href="System.Runtime.InteropServices.DllImportAttribute.html#System_Runtime_InteropServices_DllImportAttribute">DllImportAttribute</a> to the method signature and set the <a class="xref" href="System.Runtime.InteropServices.DllImportAttribute.html#System_Runtime_InteropServices_DllImportAttribute_SetLastError">SetLastError</a> field to<strong>true</strong>. The process for this varies depending upon the source language used: C# and C++ are <strong>false</strong> by default, but the <strong>Declare</strong> statement in Visual Basic is <strong>true</strong>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static int GetLastWin32Error()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetLastWin32Error_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a> exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkId=148657">GetLastError</see> function from Kernel32.DLL. This method exists because it is not safe to make a direct platform invoke call to <strong>GetLastError</strong> to obtain this information. If you want to access this error code, you must call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a> instead of writing your own platform invoke definition for <strong>GetLastError</strong> and calling it. The common language runtime can make internal calls to APIs that overwrite the <strong>GetLastError</strong> maintained by the operating system.</p>
<p>You can use this method to obtain error codes only if you apply the <a class="xref" href="System.Runtime.InteropServices.DllImportAttribute.html#System_Runtime_InteropServices_DllImportAttribute">DllImportAttribute</a> to the method signature and set the <a class="xref" href="System.Runtime.InteropServices.DllImportAttribute.html#System_Runtime_InteropServices_DllImportAttribute_SetLastError">SetLastError</a> field to<strong>true</strong>. The process for this varies depending upon the source language used: C# and C++ are <strong>false</strong> by default, but the <strong>Declare</strong> statement in Visual Basic is <strong>true</strong>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetLastWin32Error_examples">Examples</h5>
              
<p>The following example demonstrates calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetLastWin32Error">GetLastWin32Error()</a>method. The example first demonstrates calling the method with no error present and then demonstrates calling the method with an error present.</p>Runtime.InteropServices.Marshal.GetLastWin32Error#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetNativeVariantForObject_System_Object_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetNativeVariantForObject(System.Object%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject_System_Object_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetNativeVariantForObject(System.Object,System.IntPtr)">GetNativeVariantForObject(Object, IntPtr)</h4>
              <div class="markdown level1 summary"><p>Converts an object to a COM VARIANT.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject_System_Object_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <em>pDstNativeVariant</em> parameter must point to sufficient memory to store the resulting VARIANT. Also, the implementation of this method calls the <see href="https://msdn.microsoft.com/library/ms221402(v=vs.85).aspx">VariantInit</see> function on the raw memory that the <em>pDstNativeVariant</em> parameter points to.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static void GetNativeVariantForObject(object obj, IntPtr pDstNativeVariant)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>obj</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pDstNativeVariant</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject_System_Object_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <em>pDstNativeVariant</em> parameter must point to sufficient memory to store the resulting VARIANT. Also, the implementation of this method calls the <see href="https://msdn.microsoft.com/library/ms221402(v=vs.85).aspx">VariantInit</see> function on the raw memory that the <em>pDstNativeVariant</em> parameter points to.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject_System_Object_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>obj</em> parameter is a generic type.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetNativeVariantForObject__1___0_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetNativeVariantForObject%60%601(%60%600%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2258">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject__1___0_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetNativeVariantForObject``1(``0,System.IntPtr)">GetNativeVariantForObject&lt;T&gt;(T, IntPtr)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Converts an object of a specified type to a COM VARIANT. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject__1___0_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <em>pDstNativeVariant</em> parameter must point to sufficient memory to store the resulting VARIANT. Also, the implementation of this method calls <see href="https://msdn.microsoft.com/library/ms221402(v=vs.85).aspx">VariantInit</see> function on the raw memory that the <em>pDstNativeVariant</em> parameter points to.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void GetNativeVariantForObject&lt;T&gt;(T obj, IntPtr pDstNativeVariant)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td><em>obj</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pDstNativeVariant</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject__1___0_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <em>pDstNativeVariant</em> parameter must point to sufficient memory to store the resulting VARIANT. Also, the implementation of this method calls <see href="https://msdn.microsoft.com/library/ms221402(v=vs.85).aspx">VariantInit</see> function on the raw memory that the <em>pDstNativeVariant</em> parameter points to.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetNativeVariantForObject__1___0_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetObjectForIUnknown(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetObjectForIUnknown(System.IntPtr)">GetObjectForIUnknown(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Returns an instance of a type that represents a COM object by a pointer to its <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method wraps <strong>IUnknown</strong> in a managed object. This has the effect of incrementing the reference count of the COM component. The reference count will be decremented when the runtime performs garbage collection on the managed object that represents the COM object.</p>
<p>The <em>pUnk</em> parameter represents an <strong>IUnknown</strong> interface pointer; however, because all COM interfaces derive directly or indirectly from <strong>IUnknown</strong>, you can pass any COM interface to this method. The object returned by <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr_">GetObjectForIUnknown(IntPtr)</a> is a Runtime Callable Wrapper, which the common language runtime manages as it does any other managed object. The type of this wrapper is often a generic <strong>System.__ComObject</strong> type, which is a hidden type used when the wrapper type is ambiguous. You can still make late-bound calls to such a generic type as long as the COM object implements the IDispatch interface. Likewise, you can cast the returned object to an appropriate COM interface.</p>
<p>For an object to be wrapped with a specific managed class type (and not a generic wrapper type), you must adhere to the following requirements: </p>
<ul><li>
<p>Implement the <see href="http://go.microsoft.com/fwlink/?LinkID=148012">IProvideClassInfo</see> interface for the COM object.</p>
</li><li>
<p>Register the containing assembly with the Regasm.exe (Assembly Registration Tool).</p>
</li></ul>
<p>Alternatively, you can avoid these requirements and still get an object that is wrapped with a specific managed class type by using the <span class="xref">System.Runtime.InteropServices.Marshal.GetTypedObjectForIUnknown(System.IntPtr,System.Type)</span> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static object GetObjectForIUnknown(IntPtr pUnk)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pUnk</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method wraps <strong>IUnknown</strong> in a managed object. This has the effect of incrementing the reference count of the COM component. The reference count will be decremented when the runtime performs garbage collection on the managed object that represents the COM object.</p>
<p>The <em>pUnk</em> parameter represents an <strong>IUnknown</strong> interface pointer; however, because all COM interfaces derive directly or indirectly from <strong>IUnknown</strong>, you can pass any COM interface to this method. The object returned by <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr_">GetObjectForIUnknown(IntPtr)</a> is a Runtime Callable Wrapper, which the common language runtime manages as it does any other managed object. The type of this wrapper is often a generic <strong>System.__ComObject</strong> type, which is a hidden type used when the wrapper type is ambiguous. You can still make late-bound calls to such a generic type as long as the COM object implements the IDispatch interface. Likewise, you can cast the returned object to an appropriate COM interface.</p>
<p>For an object to be wrapped with a specific managed class type (and not a generic wrapper type), you must adhere to the following requirements: </p>
<ul><li>
<p>Implement the <see href="http://go.microsoft.com/fwlink/?LinkID=148012">IProvideClassInfo</see> interface for the COM object.</p>
</li><li>
<p>Register the containing assembly with the Regasm.exe (Assembly Registration Tool).</p>
</li></ul>
<p>Alternatively, you can avoid these requirements and still get an object that is wrapped with a specific managed class type by using the <span class="xref">System.Runtime.InteropServices.Marshal.GetTypedObjectForIUnknown(System.IntPtr,System.Type)</span> method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForIUnknown_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetObjectForNativeVariant(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetObjectForNativeVariant(System.IntPtr)">GetObjectForNativeVariant(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Converts a COM VARIANT to an object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_">GetObjectForNativeVariant(IntPtr)</a> returns a managed object that corresponds to a raw pointer to an unmanaged VARIANT type. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_">GetObjectForNativeVariant(IntPtr)</a> provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetNativeVariantForObject_System_Object_System_IntPtr_">GetNativeVariantForObject(Object, IntPtr)</a>.</p>
<p>When the VARIANT type is VT_ERROR, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_">GetObjectForNativeVariant(IntPtr)</a> returns an object of type <strong>Int32</strong> instead of <strong>UInt32</strong>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static object GetObjectForNativeVariant(IntPtr pSrcNativeVariant)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pSrcNativeVariant</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_">GetObjectForNativeVariant(IntPtr)</a> returns a managed object that corresponds to a raw pointer to an unmanaged VARIANT type. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_">GetObjectForNativeVariant(IntPtr)</a> provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetNativeVariantForObject_System_Object_System_IntPtr_">GetNativeVariantForObject(Object, IntPtr)</a>.</p>
<p>When the VARIANT type is VT_ERROR, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr_">GetObjectForNativeVariant(IntPtr)</a> returns an object of type <strong>Int32</strong> instead of <strong>UInt32</strong>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Runtime.InteropServices.InvalidOleVariantTypeException.html#System_Runtime_InteropServices_InvalidOleVariantTypeException">InvalidOleVariantTypeException</a></td>
                    <td><p>
<em>pSrcNativeVariant</em> is not a valid VARIANT type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.NotSupportedException.html#System_NotSupportedException">NotSupportedException</a></td>
                    <td><p>
<em>pSrcNativeVariant</em> has an unsupported type.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetObjectForNativeVariant%60%601(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2268">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetObjectForNativeVariant``1(System.IntPtr)">GetObjectForNativeVariant&lt;T&gt;(IntPtr)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Converts a COM VARIANT to an object of a specified type. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr_">GetObjectForNativeVariant<t>(IntPtr)</t></a> returns a managed object of type <em>T</em> that corresponds to a raw pointer to an unmanaged VARIANT type. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code. </p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr_">GetObjectForNativeVariant<t>(IntPtr)</t></a> provides the opposite functionality of<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetNativeVariantForObject__1___0_System_IntPtr_">GetNativeVariantForObject<t>(T, IntPtr)</t></a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static T GetObjectForNativeVariant&lt;T&gt;(IntPtr pSrcNativeVariant)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pSrcNativeVariant</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr_">GetObjectForNativeVariant<t>(IntPtr)</t></a> returns a managed object of type <em>T</em> that corresponds to a raw pointer to an unmanaged VARIANT type. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code. </p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr_">GetObjectForNativeVariant<t>(IntPtr)</t></a> provides the opposite functionality of<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetNativeVariantForObject__1___0_System_IntPtr_">GetNativeVariantForObject<t>(T, IntPtr)</t></a>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectForNativeVariant__1_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Runtime.InteropServices.InvalidOleVariantTypeException.html#System_Runtime_InteropServices_InvalidOleVariantTypeException">InvalidOleVariantTypeException</a></td>
                    <td><p>
<em>pSrcNativeVariant</em> is not a valid VARIANT type. </p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.NotSupportedException.html#System_NotSupportedException">NotSupportedException</a></td>
                    <td><p>
<em>pSrcNativeVariant</em> has an unsupported type. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetObjectsForNativeVariants(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.GetObjectsForNativeVariants(System.IntPtr,System.Int32)">GetObjectsForNativeVariants(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Converts an array of COM <see href="http://go.microsoft.com/fwlink/?LinkId=148670">VARIANTs</see> to an array of objects. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants_System_IntPtr_System_Int32_">GetObjectsForNativeVariants(IntPtr, Int32)</a> returns an array of managed objects that corresponds to a raw pointer to a C-style array of unmanaged VARIANT types. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code. The method returns an empty array when the <em>cVars</em> parameter is 0.</p>
<p>The object array (the return value) gets garbage collected as usual. The unmanaged input array or individual VARIANTs in the input array are not freed. Therefore it is your responsibility to free them as appropriate.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static object[] GetObjectsForNativeVariants(IntPtr aSrcNativeVariant, int cVars)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>aSrcNativeVariant</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>cVars</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a>[]</td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants_System_IntPtr_System_Int32_">GetObjectsForNativeVariants(IntPtr, Int32)</a> returns an array of managed objects that corresponds to a raw pointer to a C-style array of unmanaged VARIANT types. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code. The method returns an empty array when the <em>cVars</em> parameter is 0.</p>
<p>The object array (the return value) gets garbage collected as usual. The unmanaged input array or individual VARIANTs in the input array are not freed. Therefore it is your responsibility to free them as appropriate.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>cVars</em> is a negative number.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants__1_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetObjectsForNativeVariants%60%601(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2278">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants__1_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.GetObjectsForNativeVariants``1(System.IntPtr,System.Int32)">GetObjectsForNativeVariants&lt;T&gt;(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Converts an array of COM VARIANTs to an array of a specified type. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants__1_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants__1_System_IntPtr_System_Int32_">GetObjectsForNativeVariants<t>(IntPtr, Int32)</t></a> returns an array of <em>T</em> that corresponds to a raw pointer to a C-style array of unmanaged VARIANT types. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code. The method returns an empty array when the <em>cVars</em> parameter is 0.</p>
<p>The returned array is garbage-collected as usual. The unmanaged input array or individual VARIANTs in the input array are not freed. Therefore, it is your responsibility to free them as appropriate. </p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static T[] GetObjectsForNativeVariants&lt;T&gt;(IntPtr aSrcNativeVariant, int cVars)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>aSrcNativeVariant</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>cVars</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>T[]</td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants__1_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants__1_System_IntPtr_System_Int32_">GetObjectsForNativeVariants<t>(IntPtr, Int32)</t></a> returns an array of <em>T</em> that corresponds to a raw pointer to a C-style array of unmanaged VARIANT types. The interopmarshaler performs the identical transformation when exposing a VARIANT type to managed code. The method returns an empty array when the <em>cVars</em> parameter is 0.</p>
<p>The returned array is garbage-collected as usual. The unmanaged input array or individual VARIANTs in the input array are not freed. Therefore, it is your responsibility to free them as appropriate. </p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetObjectsForNativeVariants__1_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>
<em>cVars</em> is a negative number. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetStartComSlot_System_Type_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetStartComSlot(System.Type)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetStartComSlot_System_Type_" data-uid="System.Runtime.InteropServices.Marshal.GetStartComSlot(System.Type)">GetStartComSlot(Type)</h4>
              <div class="markdown level1 summary"><p>Gets the first slot in the virtual function table (v-table or VTBL) that contains user-defined methods.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetStartComSlot_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method returns the zero-based v-table number for an interface or a class. When used on a class, the slot number that is returned refers to the class interface for the class. If the class interface is auto-dispatch, this method always returns -1 to indicate that the dispatch-only interface does not expose a v-table to managed clients. You can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetStartComSlot_System_Type_">GetStartComSlot(Type)</a> and <span class="xref">System.Runtime.InteropServices.Marshal.GetEndComSlot(System.Type)</span> in conjunction with <span class="xref">System.Runtime.InteropServices.Marshal.GetMethodInfoForComSlot(System.Type,System.Int32,System.Runtime.InteropServices.ComMemberType@)</span> to pass slots within a specified range. For additional information, see Introducing the Class Interface.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static int GetStartComSlot(Type t)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>t</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetStartComSlot_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method returns the zero-based v-table number for an interface or a class. When used on a class, the slot number that is returned refers to the class interface for the class. If the class interface is auto-dispatch, this method always returns -1 to indicate that the dispatch-only interface does not expose a v-table to managed clients. You can use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetStartComSlot_System_Type_">GetStartComSlot(Type)</a> and <span class="xref">System.Runtime.InteropServices.Marshal.GetEndComSlot(System.Type)</span> in conjunction with <span class="xref">System.Runtime.InteropServices.Marshal.GetMethodInfoForComSlot(System.Type,System.Int32,System.Runtime.InteropServices.ComMemberType@)</span> to pass slots within a specified range. For additional information, see Introducing the Class Interface.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetStartComSlot_System_Type__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>t</em> is not visible from COM.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetTypeFromCLSID_System_Guid_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetTypeFromCLSID(System.Guid)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1701">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetTypeFromCLSID_System_Guid_" data-uid="System.Runtime.InteropServices.Marshal.GetTypeFromCLSID(System.Guid)">GetTypeFromCLSID(Guid)</h4>
              <div class="markdown level1 summary"><p>Returns the type associated with the specified class identifier (CLSID). </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static Type GetTypeFromCLSID(Guid clsid)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Guid.html#System_Guid">Guid</a></td>
                    <td><em>clsid</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetTypeFromCLSID_System_Guid__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetTypeInfoName_System_Runtime_InteropServices_ComTypes_ITypeInfo_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetTypeInfoName(System.Runtime.InteropServices.ComTypes.ITypeInfo)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1534">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_GetTypeInfoName_System_Runtime_InteropServices_ComTypes_ITypeInfo_" data-uid="System.Runtime.InteropServices.Marshal.GetTypeInfoName(System.Runtime.InteropServices.ComTypes.ITypeInfo)">GetTypeInfoName(ITypeInfo)</h4>
              <div class="markdown level1 summary"><p>Retrieves the name of the type represented by an ITypeInfo object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetTypeInfoName_System_Runtime_InteropServices_ComTypes_ITypeInfo__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can also retrieve the name of the type represented by an <strong>ITypeInfo</strong> by calling the <span class="xref">System.Runtime.InteropServices.UCOMITypeInfo.GetDocumentation(System.Int32,System.String@,System.String@,System.Int32@,System.String@)</span> method and passing -1 for its first parameter.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static string GetTypeInfoName(ITypeInfo typeInfo)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Runtime.InteropServices.ComTypes.ITypeInfo.html#System_Runtime_InteropServices_ComTypes_ITypeInfo">ITypeInfo</a></td>
                    <td><em>typeInfo</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetTypeInfoName_System_Runtime_InteropServices_ComTypes_ITypeInfo__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can also retrieve the name of the type represented by an <strong>ITypeInfo</strong> by calling the <span class="xref">System.Runtime.InteropServices.UCOMITypeInfo.GetDocumentation(System.Int32,System.String@,System.String@,System.Int32@,System.String@)</span> method and passing -1 for its first parameter.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetTypeInfoName_System_Runtime_InteropServices_ComTypes_ITypeInfo__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>typeInfo</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_GetUniqueObjectForIUnknown_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.GetUniqueObjectForIUnknown(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_GetUniqueObjectForIUnknown_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.GetUniqueObjectForIUnknown(System.IntPtr)">GetUniqueObjectForIUnknown(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Creates a unique Runtime Callable Wrapper (RCW) object for a given <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_GetUniqueObjectForIUnknown_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetUniqueObjectForIUnknown_System_IntPtr_">GetUniqueObjectForIUnknown(IntPtr)</a> method ensures that you receive a unique RCW, because it does not match an <strong>IUnknown</strong> pointer to an existing object. Use this method when you have to create a unique RCW that is not impacted by other code that calls the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static object GetUniqueObjectForIUnknown(IntPtr unknown)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>unknown</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_GetUniqueObjectForIUnknown_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetUniqueObjectForIUnknown_System_IntPtr_">GetUniqueObjectForIUnknown(IntPtr)</a> method ensures that you receive a unique RCW, because it does not match an <strong>IUnknown</strong> pointer to an existing object. Use this method when you have to create a unique RCW that is not impacted by other code that calls the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method.</p>
</div>
              
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_IsComObject_System_Object_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.IsComObject(System.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_IsComObject_System_Object_" data-uid="System.Runtime.InteropServices.Marshal.IsComObject(System.Object)">IsComObject(Object)</h4>
              <div class="markdown level1 summary"><p>Indicates whether a specified object represents a COM object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_IsComObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_IsComObject_System_Object_">IsComObject(Object)</a> returns <strong>true</strong> if the class type of the instance is attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> or if it derives directly or indirectly from a class attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a>. The Tlbimp.exe (Type Library Importer) tool applies this attribute for you when it imports a type library.</p>
<p>Two other methods also determine whether a specified object represents a COM object, but the requirements for returning <strong>true</strong> differ from this method&#39;s requirements. <span class="xref">IsImport</span> returns <strong>true</strong> if the class (or interface) is attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> directly; it does not return <strong>true</strong> for derived types. <span class="xref">System.Runtime.InteropServices.RegistrationServices.TypeRepresentsComType(System.Type)</span> returns <strong>true</strong> if the type is attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> or derives from a type with the same GUID.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[MethodImpl(MethodImplOptions.InternalCall)]
public static bool IsComObject(object o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Boolean.html#System_Boolean">Boolean</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_IsComObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_IsComObject_System_Object_">IsComObject(Object)</a> returns <strong>true</strong> if the class type of the instance is attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> or if it derives directly or indirectly from a class attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a>. The Tlbimp.exe (Type Library Importer) tool applies this attribute for you when it imports a type library.</p>
<p>Two other methods also determine whether a specified object represents a COM object, but the requirements for returning <strong>true</strong> differ from this method&#39;s requirements. <span class="xref">IsImport</span> returns <strong>true</strong> if the class (or interface) is attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> directly; it does not return <strong>true</strong> for derived types. <span class="xref">System.Runtime.InteropServices.RegistrationServices.TypeRepresentsComType(System.Type)</span> returns <strong>true</strong> if the type is attributed with <a class="xref" href="System.Runtime.InteropServices.ComImportAttribute.html#System_Runtime_InteropServices_ComImportAttribute">ComImportAttribute</a> or derives from a type with the same GUID.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_IsComObject_System_Object__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>o</em> is <strong>null</strong>. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.OffsetOf(System.Type%2CSystem.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L302">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_" data-uid="System.Runtime.InteropServices.Marshal.OffsetOf(System.Type,System.String)">OffsetOf(Type, String)</h4>
              <div class="markdown level1 summary"><p>Returns the field offset of the unmanaged form of the managed class.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_">OffsetOf(Type, String)</a> provides the offset in terms of the unmanaged structure layout, which does not necessarily correspond to the offset of the managed structure layout. Marshaling the structure can transform the layout and alter the offset. The <em>t</em> parameter can be a value type or a formatted reference type (with either a sequential or explicit layout). You can obtain the size of the entire layout by using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf_System_Object_">SizeOf(Object)</a> method. For additional information, see Default Marshaling for Value Types.</p>
<p>Beginning with the .NET Framework version 2.0, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_">OffsetOf(Type, String)</a> may expose private fields.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static IntPtr OffsetOf(Type t, string fieldName)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>t</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>fieldName</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_">OffsetOf(Type, String)</a> provides the offset in terms of the unmanaged structure layout, which does not necessarily correspond to the offset of the managed structure layout. Marshaling the structure can transform the layout and alter the offset. The <em>t</em> parameter can be a value type or a formatted reference type (with either a sequential or explicit layout). You can obtain the size of the entire layout by using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf_System_Object_">SizeOf(Object)</a> method. For additional information, see Default Marshaling for Value Types.</p>
<p>Beginning with the .NET Framework version 2.0, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_">OffsetOf(Type, String)</a> may expose private fields.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The class cannot be exported as a structure or the field is nonpublic. Beginning with the .NET Framework version 2.0, the field may be private.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>t</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_OffsetOf__1_System_String_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.OffsetOf%60%601(System.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L317">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_OffsetOf__1_System_String_" data-uid="System.Runtime.InteropServices.Marshal.OffsetOf``1(System.String)">OffsetOf&lt;T&gt;(String)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Returns the field offset of the unmanaged form of a specified managed class.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_OffsetOf__1_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf__1_System_String_">OffsetOf<t>(String)</t></a> provides the offset in terms of the unmanaged structure layout, which does not necessarily correspond to the offset of the managed structure layout. Marshaling the structure can transform the layout and alter the offset. The <em>T</em> generic type parameter can be a value type or a formatted reference type (with either a sequential or explicit layout). You can obtain the size of the entire layout by using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf__1___0_">SizeOf<t>(T)</t></a> method. For additional information, see Default Marshaling for Value Types.</p>
<p>Beginning with the .NET Framework version 2.0, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_">OffsetOf(Type, String)</a> may expose private fields.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static IntPtr OffsetOf&lt;T&gt;(string fieldName)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>fieldName</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_OffsetOf__1_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf__1_System_String_">OffsetOf<t>(String)</t></a> provides the offset in terms of the unmanaged structure layout, which does not necessarily correspond to the offset of the managed structure layout. Marshaling the structure can transform the layout and alter the offset. The <em>T</em> generic type parameter can be a value type or a formatted reference type (with either a sequential or explicit layout). You can obtain the size of the entire layout by using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf__1___0_">SizeOf<t>(T)</t></a> method. For additional information, see Default Marshaling for Value Types.</p>
<p>Beginning with the .NET Framework version 2.0, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_OffsetOf_System_Type_System_String_">OffsetOf(Type, String)</a> may expose private fields.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_OffsetOf__1_System_String__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStringAnsi(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L120">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStringAnsi(System.IntPtr)">PtrToStringAnsi(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Copies all characters up to the first null character from an unmanaged ANSI string to a managed <a class="xref" href="System.String.html#System_String">String</a>, and widens each ANSI character to Unicode.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_">StringToCoTaskMemAnsi(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> methods.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static string PtrToStringAnsi(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_">StringToCoTaskMemAnsi(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> methods.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr__examples">Examples</h5>
              
<p>The following example uses the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a> method to create a managed string from an unmanaged <strong>char</strong> array.</p>Runtime.InteropServices.Marshal.PtrToStringAnsi-IntPtr#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStringAnsi(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L140">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStringAnsi(System.IntPtr,System.Int32)">PtrToStringAnsi(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Allocates a managed <a class="xref" href="System.String.html#System_String">String</a>, copies a specified number of characters from an unmanaged ANSI string into it, and widens each ANSI character to Unicode.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_">StringToCoTaskMemAnsi(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> methods.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static string PtrToStringAnsi(IntPtr ptr, int len)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>len</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_">StringToCoTaskMemAnsi(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> methods.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example uses the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_System_Int32_">PtrToStringAnsi(IntPtr, Int32)</a> method to create a managed string from an unmanaged<strong>char</strong> array.</p>Runtime.InteropServices.Marshal.PtrToStringAnsi-IntPtr-int#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>len</em> is less than zero.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStringBSTR(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2023">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStringBSTR(System.IntPtr)">PtrToStringBSTR(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Allocates a managed <a class="xref" href="System.String.html#System_String">String</a> and copies a <see href="https://msdn.microsoft.com/library/ms221069(v=vs.85).aspx">binary string (BSTR)</see> stored in unmanaged memory into it.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Call this method only on strings that were allocated with the unmanaged <see href="https://msdn.microsoft.com/library/ms221458(v=vs.85).aspx">SysAllocString</see> and <see href="https://msdn.microsoft.com/library/ms221639(v=vs.85).aspx">SysAllocStringLen</see> functions.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr_">PtrToStringBSTR(IntPtr)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToBSTR_System_String_">StringToBSTR(String)</a> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static string PtrToStringBSTR(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>Call this method only on strings that were allocated with the unmanaged <see href="https://msdn.microsoft.com/library/ms221458(v=vs.85).aspx">SysAllocString</see> and <see href="https://msdn.microsoft.com/library/ms221639(v=vs.85).aspx">SysAllocStringLen</see> functions.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr_">PtrToStringBSTR(IntPtr)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToBSTR_System_String_">StringToBSTR(String)</a> method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>ptr</em> equals <a class="xref" href="System.IntPtr.html#System_IntPtr_Zero">Zero</a>. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStringUni(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L169">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStringUni(System.IntPtr)">PtrToStringUni(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Allocates a managed <a class="xref" href="System.String.html#System_String">String</a> and copies all characters up to the first null character from an unmanaged Unicode string into it.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a> is useful for custom marshaling or for use when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_">StringToCoTaskMemUni(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_">StringToHGlobalUni(String)</a> methods.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static string PtrToStringUni(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a> is useful for custom marshaling or for use when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_">StringToCoTaskMemUni(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_">StringToHGlobalUni(String)</a> methods.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStringUni(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L151">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStringUni(System.IntPtr,System.Int32)">PtrToStringUni(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Allocates a managed <a class="xref" href="System.String.html#System_String">String</a> and copies a specified number of characters from an unmanaged Unicode string into it.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_">StringToCoTaskMemUni(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_">StringToHGlobalUni(String)</a> methods.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static string PtrToStringUni(IntPtr ptr, int len)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>len</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method creates a copy of the unmanaged string&#39;s contents, you must free the original string as appropriate. This method provides the opposite functionality of the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_">StringToCoTaskMemUni(String)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_">StringToHGlobalUni(String)</a> methods.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStructure(System.IntPtr%2CSystem.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1005">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStructure(System.IntPtr,System.Object)">PtrToStructure(IntPtr, Object)</h4>
              <div class="markdown level1 summary"><p>Marshals data from an unmanaged block of memory to a managed object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object_">PtrToStructure(IntPtr, Object)</a> is often necessary in COM interop and platform invoke when structure parameters are represented as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value. You cannot use this overload method with value types.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ComVisible(true)]
public static void PtrToStructure(IntPtr ptr, object structure)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>structure</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object_">PtrToStructure(IntPtr, Object)</a> is often necessary in COM interop and platform invoke when structure parameters are represented as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value. You cannot use this overload method with value types.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>Structure layout is not sequential or explicit.</p>
<p>-or- </p>
<p>Structure is a boxed value type.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStructure(System.IntPtr%2CSystem.Type)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1022">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStructure(System.IntPtr,System.Type)">PtrToStructure(IntPtr, Type)</h4>
              <div class="markdown level1 summary"><p>Marshals data from an unmanaged block of memory to a newly allocated managed object of the specified type.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object_">PtrToStructure(IntPtr, Object)</a> is often necessary in COM interop and platform invoke when structure parameters are represented as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value. You can pass a value type to this overload method. In this case, the returned object is a boxed instance.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ComVisible(true)]
[MethodImpl(MethodImplOptions.NoInlining)]
public static object PtrToStructure(IntPtr ptr, Type structureType)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>structureType</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Object_">PtrToStructure(IntPtr, Object)</a> is often necessary in COM interop and platform invoke when structure parameters are represented as an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value. You can pass a value type to this overload method. In this case, the returned object is a boxed instance.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type__examples">Examples</h5>
              
<p>The following example creates a managed structure, transfers it to unmanaged memory, and then transfers it back to managed memory using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type_">PtrToStructure(IntPtr, Type)</a> method. </p>Runtime.InteropServices.Marshal.PtrToStructure-SizeOf#1<p>The following example demonstrates how to marshal an unmanaged block of memory to a managed structure using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type_">PtrToStructure(IntPtr, Type)</a> method.</p><p>This code assumes 32-bit compilation. Before using a 64-bit compiler, replace <a class="xref" href="System.IntPtr.html#System_IntPtr_ToInt32">ToInt32()</a> with <a class="xref" href="System.IntPtr.html#System_IntPtr_ToInt64">ToInt64()</a>.</p>PtrToStructure#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>structureType</em> parameter layout is not sequential or explicit.</p>
<p>-or-</p>
<p>The <em>structureType</em> parameter is a generic type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>
<em>structureType</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.MissingMethodException.html#System_MissingMethodException">MissingMethodException</a></td>
                    <td><p>The class specified by <em>structureType</em> does not have an accessible default constructor. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStructure%60%601(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1047">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStructure``1(System.IntPtr)">PtrToStructure&lt;T&gt;(IntPtr)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Marshals data from an unmanaged block of memory to a newly allocated managed object of the type specified by a generic type parameter. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr_">PtrToStructure<t>(IntPtr)</t></a> is often necessary in COM interop and platform invoke when structure parameters are represented as <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> values. You can pass a value type to this method overload.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static T PtrToStructure&lt;T&gt;(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr_">PtrToStructure<t>(IntPtr)</t></a> is often necessary in COM interop and platform invoke when structure parameters are represented as <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> values. You can pass a value type to this method overload.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The layout of <em>T</em> is not sequential or explicit.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.MissingMethodException.html#System_MissingMethodException">MissingMethodException</a></td>
                    <td><p>The class specified by <em>T</em> does not have an accessible default constructor. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr___0_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.PtrToStructure%60%601(System.IntPtr%2C%60%600)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1012">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr___0_" data-uid="System.Runtime.InteropServices.Marshal.PtrToStructure``1(System.IntPtr,``0)">PtrToStructure&lt;T&gt;(IntPtr, T)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Marshals data from an unmanaged block of memory to a managed object of the specified type. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr___0_">PtrToStructure<t>(IntPtr, T)</t></a> is often necessary in COM interop and platform invoke when structure parameters are represented as <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> values. You cannot use this method overload with value types. </p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void PtrToStructure&lt;T&gt;(IntPtr ptr, T structure)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td><em>structure</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr___0_">PtrToStructure<t>(IntPtr, T)</t></a> is often necessary in COM interop and platform invoke when structure parameters are represented as <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> values. You cannot use this method overload with value types. </p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_PtrToStructure__1_System_IntPtr___0__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>Structure layout is not sequential or explicit. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_QueryInterface_System_IntPtr_System_Guid__System_IntPtr__.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.QueryInterface(System.IntPtr%2CSystem.Guid%40%2CSystem.IntPtr%40)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_QueryInterface_System_IntPtr_System_Guid__System_IntPtr__" data-uid="System.Runtime.InteropServices.Marshal.QueryInterface(System.IntPtr,System.Guid@,System.IntPtr@)">QueryInterface(IntPtr, ref Guid, out IntPtr)</h4>
              <div class="markdown level1 summary"><p>Requests a pointer to a specified interface from a COM object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_QueryInterface_System_IntPtr_System_Guid__System_IntPtr___remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_QueryInterface_System_IntPtr_System_Guid__System_IntPtr__">QueryInterface(IntPtr, ref Guid, out IntPtr)</a> method exposes the <see href="http://go.microsoft.com/fwlink/?LinkID=144867">IUnknown::QueryInterface</see> method of a COM object, which attempts to obtain a specific interface pointer. Using <strong>QueryInterface</strong> on a COM object is the same as performing a cast operation in managed code. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> to decrement the reference count once you have finished with the pointer. To obtain an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value that represents a <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface pointer, you can call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a>, or <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static int QueryInterface(IntPtr pUnk, ref Guid iid, out IntPtr ppv)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pUnk</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Guid.html#System_Guid">Guid</a></td>
                    <td><em>iid</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ppv</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_QueryInterface_System_IntPtr_System_Guid__System_IntPtr___remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_QueryInterface_System_IntPtr_System_Guid__System_IntPtr__">QueryInterface(IntPtr, ref Guid, out IntPtr)</a> method exposes the <see href="http://go.microsoft.com/fwlink/?LinkID=144867">IUnknown::QueryInterface</see> method of a COM object, which attempts to obtain a specific interface pointer. Using <strong>QueryInterface</strong> on a COM object is the same as performing a cast operation in managed code. Calling an object with this method causes the reference count to increment on the interface pointer before the pointer is returned. Always use <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> to decrement the reference count once you have finished with the pointer. To obtain an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value that represents a <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface pointer, you can call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a>, or <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_QueryInterface_System_IntPtr_System_Guid__System_IntPtr___examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadByte(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L465">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ReadByte(System.IntPtr)">ReadByte(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Reads a single byte from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_">ReadByte(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static byte ReadByte(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_">ReadByte(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr__examples">Examples</h5>
              
<p>The following example creates a block of unmanaged memory, writes a byte to the unmanaged memory, reads the byte back from unmanaged memory, and then disposes the unmanaged memory.</p>Runtime.InteropServices.Marshal.ReadByte - WriteByte#1<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_">ReadByte(IntPtr)</a> method to read the value of an unmanaged character.</p>Runtime.InteropServices.Marshal.ReadByte#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>. </p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadByte(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L450">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadByte(System.IntPtr,System.Int32)">ReadByte(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a single byte at a given offset (or index) from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_">ReadByte(Object, Int32)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static byte ReadByte(IntPtr ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_">ReadByte(Object, Int32)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32_">ReadByte(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#3<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32_">ReadByte(IntPtr, Int32)</a> method to read the value of an unmanaged character.</p>Runtime.InteropServices.Marshal.ReadByte-IntPtr-int#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadByte(System.Object%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L438">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadByte(System.Object,System.Int32)">ReadByte(Object, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a single byte at a given offset (or index) from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_">ReadByte(Object, Int32)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static byte ReadByte([MarshalAs(UnmanagedType.AsAny), In] object ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32_">ReadByte(Object, Int32)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadByte_System_Object_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt16(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L511">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt16(System.IntPtr)">ReadInt16(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Reads a 16-bit signed integer from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32_">ReadInt16(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>Int16</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static short ReadInt16(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32_">ReadInt16(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>Int16</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#4<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> method to read the value of an unmanaged <strong>short</strong> variable.</p>Runtime.InteropServices.Marshal.ReadInt16#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt16(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L483">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt16(System.IntPtr,System.Int32)">ReadInt16(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a 16-bit signed integer at a given offset from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static short ReadInt16(IntPtr ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#4<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> method to read the value of an unmanaged <strong>short</strong> variable.</p>Runtime.InteropServices.Marshal.ReadInt16-IntPtr-Int#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt16(System.Object%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L471">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt16(System.Object,System.Int32)">ReadInt16(Object, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a 16-bit signed integer at a given offset from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32_">ReadInt16(Object, Int32)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static short ReadInt16([MarshalAs(UnmanagedType.AsAny), In] object ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32_">ReadInt16(Object, Int32)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt16_System_Object_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt32(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L560">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt32(System.IntPtr)">ReadInt32(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Reads a 32-bit signed integer from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_">ReadInt32(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>Int32</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static int ReadInt32(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_">ReadInt32(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>Int32</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_">ReadInt32(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#5<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_">ReadInt32(IntPtr, Int32)</a> method to read the value of an unmanaged <strong>int</strong> variable.</p>Runtime.InteropServices.Marshal.ReadInt32#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt32(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L529">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt32(System.IntPtr,System.Int32)">ReadInt32(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a 32-bit signed integer at a given offset from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_">ReadInt32(Object, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static int ReadInt32(IntPtr ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_">ReadInt32(Object, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_">ReadInt32(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a>methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#5<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_">ReadInt32(IntPtr, Int32)</a> method to read the value of an unmanaged <strong>int</strong> variable. </p>Runtime.InteropServices.Marshal.ReadInt32-IntPtr-Int#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt32(System.Object%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L517">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt32(System.Object,System.Int32)">ReadInt32(Object, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a 32-bit signed integer at a given offset from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_">ReadInt32(Object, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static int ReadInt32([MarshalAs(UnmanagedType.AsAny), In] object ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32_">ReadInt32(Object, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt32_System_Object_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt64(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L646">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt64(System.IntPtr)">ReadInt64(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Reads a 64-bit signed integer from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_">ReadInt64(IntPtr)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>Int64</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static long ReadInt64(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_">ReadInt64(IntPtr)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>Int64</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_">ReadInt64(IntPtr)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#6<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_">ReadInt64(IntPtr)</a> method to read the value of an unmanaged <strong>__int64</strong> variable.</p>Runtime.InteropServices.Marshal.ReadInt64#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt64(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L612">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt64(System.IntPtr,System.Int32)">ReadInt64(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a 64-bit signed integer at a given offset from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32_">ReadInt64(Object, Int32)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static long ReadInt64(IntPtr ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32_">ReadInt64(Object, Int32)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32_">ReadInt64(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#6<p>The following example demonstrates how to use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_">ReadInt64(IntPtr)</a> method to read the value of an unmanaged <strong>__int64</strong> variable.</p>Runtime.InteropServices.Marshal.ReadInt64-IntPtr-Int#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadInt64(System.Object%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L600">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadInt64(System.Object,System.Int32)">ReadInt64(Object, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a 64-bit signed integer at a given offset from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32_">ReadInt64(Object, Int32)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static long ReadInt64([MarshalAs(UnmanagedType.AsAny), In] object ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32_">ReadInt64(Object, Int32)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadInt64_System_Object_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadIntPtr(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L589">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ReadIntPtr(System.IntPtr)">ReadIntPtr(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Reads a processor native-sized integer from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_">ReadIntPtr(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static IntPtr ReadIntPtr(IntPtr ptr)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_">ReadIntPtr(Object, Int32)</a> has an implied offset of 0. This method enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32_">ReadIntPtr(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#2
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>. </p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadIntPtr(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L578">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadIntPtr(System.IntPtr,System.Int32)">ReadIntPtr(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a processor native sized integer at a given offset from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_">ReadIntPtr(Object, Int32)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static IntPtr ReadIntPtr(IntPtr ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_">ReadIntPtr(Object, Int32)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32_">ReadIntPtr(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#2
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReadIntPtr(System.Object%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L567">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReadIntPtr(System.Object,System.Int32)">ReadIntPtr(Object, Int32)</h4>
              <div class="markdown level1 summary"><p>Reads a processor native sized integer from unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_">ReadIntPtr(Object, Int32)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static IntPtr ReadIntPtr([MarshalAs(UnmanagedType.AsAny), In] object ptr, int ofs)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32_">ReadIntPtr(Object, Int32)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before reading its element values.</p>
<p>Reading from unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReadIntPtr_System_Object_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReAllocCoTaskMem(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1983">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ReAllocCoTaskMem(System.IntPtr,System.Int32)">ReAllocCoTaskMem(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Resizes a block of memory previously allocated with <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_">ReAllocCoTaskMem(IntPtr, Int32)</a> is one of two memory reallocation methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_">ReAllocHGlobal(IntPtr, IntPtr)</a> is the other.) The beginning of the reallocated memory content is the same as the original content; however, the entire memory block can be in a different location. This method exposes the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148778">CoTaskMemRealloc</see> function, which is referred to as the COM task memory allocator.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr ReAllocCoTaskMem(IntPtr pv, int cb)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pv</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>cb</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_">ReAllocCoTaskMem(IntPtr, Int32)</a> is one of two memory reallocation methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_">ReAllocHGlobal(IntPtr, IntPtr)</a> is the other.) The beginning of the reallocated memory content is the same as the original content; however, the entire memory block can be in a different location. This method exposes the COM <see href="http://go.microsoft.com/fwlink/?LinkId=148778">CoTaskMemRealloc</see> function, which is referred to as the COM task memory allocator.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory to satisfy the request.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReAllocHGlobal(System.IntPtr%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1253">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ReAllocHGlobal(System.IntPtr,System.IntPtr)">ReAllocHGlobal(IntPtr, IntPtr)</h4>
              <div class="markdown level1 summary"><p>Resizes a block of memory previously allocated with <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocHGlobal_System_IntPtr_">AllocHGlobal(IntPtr)</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_">ReAllocHGlobal(IntPtr, IntPtr)</a> is one of two memory reallocation API methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_">ReAllocCoTaskMem(IntPtr, Int32)</a> is the other.) </p>
<p>This method exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkId=148780">GlobalReAlloc</see> function from Kernel32.dll. The returned pointer can differ from the original. If it is different, the contents of the original memory block have been copied to the new block, and the original memory block has been freed.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr ReAllocHGlobal(IntPtr pv, IntPtr cb)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pv</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>cb</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr_">ReAllocHGlobal(IntPtr, IntPtr)</a> is one of two memory reallocation API methods in the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class. (<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReAllocCoTaskMem_System_IntPtr_System_Int32_">ReAllocCoTaskMem(IntPtr, Int32)</a> is the other.) </p>
<p>This method exposes the Win32 <see href="http://go.microsoft.com/fwlink/?LinkId=148780">GlobalReAlloc</see> function from Kernel32.dll. The returned pointer can differ from the original. If it is different, the contents of the original memory block have been copied to the new block, and the original memory block has been freed.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReAllocHGlobal_System_IntPtr_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory to satisfy the request.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_Release_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.Release(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_Release_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.Release(System.IntPtr)">Release(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Decrements the reference count on the specified interface.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_Release_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The common language runtime manages the reference count of a COM object for you, making it unnecessary to use this method directly. Use this value only for testing purposes. In rare cases, such as testing a custom marshaler, you might find it necessary to manipulate an object&#39;s lifetime manually. Only programs that call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a> should call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a>. Calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> after the reference count has reached zero causes undefined behavior.</p>
<p>You can call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a>, or <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span> to obtain an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value that represents a <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface pointer to release. You can also use these methods and the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> method on managed objects to release the COM interfaces represented by the managed object&#39;s COM Callable Wrapper.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
public static int Release(IntPtr pUnk)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>pUnk</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_Release_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The common language runtime manages the reference count of a COM object for you, making it unnecessary to use this method directly. Use this value only for testing purposes. In rare cases, such as testing a custom marshaler, you might find it necessary to manipulate an object&#39;s lifetime manually. Only programs that call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AddRef_System_IntPtr_">AddRef(IntPtr)</a> should call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a>. Calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> after the reference count has reached zero causes undefined behavior.</p>
<p>You can call <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetComInterfaceForObject_System_Object_System_Type_">GetComInterfaceForObject(Object, Type)</a>, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a>, or <span class="xref">System.Runtime.InteropServices.Marshal.GetIDispatchForObject(System.Object)</span> to obtain an <a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a> value that represents a <see href="http://go.microsoft.com/fwlink/?LinkId=148003">IUnknown</see> interface pointer to release. You can also use these methods and the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> method on managed objects to release the COM interfaces represented by the managed object&#39;s COM Callable Wrapper.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_Release_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to retrieve an <strong>IUnknown</strong> interface for a managed object using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_GetIUnknownForObject_System_Object_">GetIUnknownForObject(Object)</a> method. The example then releases the interface pointer by calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Release_System_IntPtr_">Release(IntPtr)</a> method.</p>Runtime.InteropServices.Marshal.GetIUnknownForObject-release#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ReleaseComObject(System.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2034">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_" data-uid="System.Runtime.InteropServices.Marshal.ReleaseComObject(System.Object)">ReleaseComObject(Object)</h4>
              <div class="markdown level1 summary"><p>Decrements the reference count of the specified Runtime Callable Wrapper (RCW) associated with the specified COM object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method is used to explicitly control the lifetime of a COM object used from managed code. You should use this method to free the underlying COM object that holds references to resources in a timely manner or when objects must be freed in a specific order.</p>
<p>Every time a COM interface pointer enters the common language runtime (CLR), it is wrapped in an RCW.</p>
<p>The RCW has a reference count that is incremented every time a COM interface pointer is mapped to it. The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method decrements the reference count of an RCW. When the reference count reaches zero, the runtime releases all its references on the unmanaged COM object, and throws a <a class="xref" href="System.NullReferenceException.html#System_NullReferenceException">NullReferenceException</a> if you attempt to use the object further. If the same COM interface is passed more than one time from unmanaged to managed code, the reference count on the wrapper is incremented every time, and calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> returns the number of remaining references.</p>
<p>This method enables you to force an RCW reference count release so that it occurs precisely when you want it to. However, improper use of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> may cause your application to fail, or may cause an access violation.</p>
<p>Consider a scenario in which managed code in an application domain is holding onto an RCW that represents a COM component. If you call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method on the RCW, the managed code will be unable to access the RCW and will raise an <a class="xref" href="System.Runtime.InteropServices.InvalidComObjectException.html#System_Runtime_InteropServices_InvalidComObjectException">InvalidComObjectException</a> exception.</p>
<p>A more serious error may occur if a call to the RCW is executing when the RCW is released. In this case, there is a good chance that the thread making the call will cause an access violation. However, process memory may become corrupted, and the process may continue to run until it fails for reasons that are very difficult to debug.</p>
<p>This risk is compounded when the COM component that is being used is a singleton, for the following reason: The CLR activates COM components by calling the COM <see href="http://go.microsoft.com/fwlink/?LinkID=142894">CoCreateInstance</see> function, which returns the same interface pointer every time it is called for singleton COM components. Thus, separate and independent pieces of managed code in an application domain can be using the same RCW for a singleton COM component, and if either one calls the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method on the COM component, the other will be broken.</p>
<p>Therefore, use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> only if it is absolutely required. If you want to call this method to ensure that a COM component is released at a determined time, consider using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> method instead. <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> will release the underlying COM component regardless of how many times it has re-entered the CLR. The internal reference count of the RCW is incremented by one every time the COM component re-enters the CLR. Therefore, you could call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method in a loop until the value returned is zero. This achieves the same result as the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static int ReleaseComObject(object o)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>o</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method is used to explicitly control the lifetime of a COM object used from managed code. You should use this method to free the underlying COM object that holds references to resources in a timely manner or when objects must be freed in a specific order.</p>
<p>Every time a COM interface pointer enters the common language runtime (CLR), it is wrapped in an RCW.</p>
<p>The RCW has a reference count that is incremented every time a COM interface pointer is mapped to it. The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method decrements the reference count of an RCW. When the reference count reaches zero, the runtime releases all its references on the unmanaged COM object, and throws a <a class="xref" href="System.NullReferenceException.html#System_NullReferenceException">NullReferenceException</a> if you attempt to use the object further. If the same COM interface is passed more than one time from unmanaged to managed code, the reference count on the wrapper is incremented every time, and calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> returns the number of remaining references.</p>
<p>This method enables you to force an RCW reference count release so that it occurs precisely when you want it to. However, improper use of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> may cause your application to fail, or may cause an access violation.</p>
<p>Consider a scenario in which managed code in an application domain is holding onto an RCW that represents a COM component. If you call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method on the RCW, the managed code will be unable to access the RCW and will raise an <a class="xref" href="System.Runtime.InteropServices.InvalidComObjectException.html#System_Runtime_InteropServices_InvalidComObjectException">InvalidComObjectException</a> exception.</p>
<p>A more serious error may occur if a call to the RCW is executing when the RCW is released. In this case, there is a good chance that the thread making the call will cause an access violation. However, process memory may become corrupted, and the process may continue to run until it fails for reasons that are very difficult to debug.</p>
<p>This risk is compounded when the COM component that is being used is a singleton, for the following reason: The CLR activates COM components by calling the COM <see href="http://go.microsoft.com/fwlink/?LinkID=142894">CoCreateInstance</see> function, which returns the same interface pointer every time it is called for singleton COM components. Thus, separate and independent pieces of managed code in an application domain can be using the same RCW for a singleton COM component, and if either one calls the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method on the COM component, the other will be broken.</p>
<p>Therefore, use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> only if it is absolutely required. If you want to call this method to ensure that a COM component is released at a determined time, consider using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> method instead. <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> will release the underlying COM component regardless of how many times it has re-entered the CLR. The internal reference count of the RCW is incremented by one every time the COM component re-enters the CLR. Therefore, you could call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object_">ReleaseComObject(Object)</a> method in a loop until the value returned is zero. This achieves the same result as the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FinalReleaseComObject_System_Object_">FinalReleaseComObject(Object)</a> method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ReleaseComObject_System_Object__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>o</em> is not a valid COM object.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.NullReferenceException.html#System_NullReferenceException">NullReferenceException</a></td>
                    <td><p>
<em>o</em> is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_SizeOf_System_Object_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.SizeOf(System.Object)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L226">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Object_" data-uid="System.Runtime.InteropServices.Marshal.SizeOf(System.Object)">SizeOf(Object)</h4>
              <div class="markdown level1 summary"><p>Returns the unmanaged size of an object in bytes.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method accepts an instance of a structure, which can be a reference type or a boxed value type. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged object. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class.</p>
<p>You can use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf_System_Object_">SizeOf(Object)</a> method to determine how much unmanaged memory to allocate using the <see cref="Overload:System.Runtime.InteropServices.Marshal.AllocHGlobal"></see> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> methods.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[ComVisible(true)]
public static int SizeOf(object structure)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>structure</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Object__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method accepts an instance of a structure, which can be a reference type or a boxed value type. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged object. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class.</p>
<p>You can use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf_System_Object_">SizeOf(Object)</a> method to determine how much unmanaged memory to allocate using the <see cref="Overload:System.Runtime.InteropServices.Marshal.AllocHGlobal"></see> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> methods.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Object__examples">Examples</h5>
              
<p>The following example creates a managed structure, transfers it to unmanaged memory, and then transfers it back to managed memory. This example uses the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf_System_Object_">SizeOf(Object)</a> method to determine how much unmanaged memory to allocate.</p>Runtime.InteropServices.Marshal.PtrToStructure-SizeOf#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>structure</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_SizeOf_System_Type_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.SizeOf(System.Type)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L242">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Type_" data-uid="System.Runtime.InteropServices.Marshal.SizeOf(System.Type)">SizeOf(Type)</h4>
              <div class="markdown level1 summary"><p>Returns the size of an unmanaged type in bytes.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method when you do not have a structure. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged type. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static int SizeOf(Type t)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Type.html#System_Type">Type</a></td>
                    <td><em>t</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Type__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method when you do not have a structure. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged type. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf_System_Type__examples">Examples</h5>
              
<p>The following example demonstrates calling the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf_System_Type_">SizeOf(Type)</a> method. This code example is part of a larger example provided for the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#3
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The <em>t</em> parameter is a generic type.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>t</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_SizeOf__1.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.SizeOf%60%601%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L256">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_SizeOf__1" data-uid="System.Runtime.InteropServices.Marshal.SizeOf``1">SizeOf&lt;T&gt;()</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Returns the size of an unmanaged type in bytes. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf__1_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method when you do not have a structure. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged type. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class. </p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static int SizeOf&lt;T&gt;()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf__1_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use this method when you do not have a structure. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged type. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class. </p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf__1_examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_SizeOf__1___0_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.SizeOf%60%601(%60%600)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L237">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_SizeOf__1___0_" data-uid="System.Runtime.InteropServices.Marshal.SizeOf``1(``0)">SizeOf&lt;T&gt;(T)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Returns the unmanaged size of an object of a specified type in bytes. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf__1___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method accepts an instance of a structure, which can be a reference type or a boxed value type. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged object. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class.</p>
<p>You can use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf__1___0_">SizeOf<t>(T)</t></a> method to determine how much unmanaged memory to allocate by using the <see cref="Overload:System.Runtime.InteropServices.Marshal.AllocHGlobal"></see> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> methods. </p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public static int SizeOf&lt;T&gt;(T structure)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td><em>structure</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf__1___0__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method accepts an instance of a structure, which can be a reference type or a boxed value type. The layout must be sequential or explicit.</p>
<p>The size returned is the size of the unmanaged object. The unmanaged and managed sizes of an object can differ. For character types, the size is affected by the <a class="xref" href="System.Runtime.InteropServices.CharSet.html#System_Runtime_InteropServices_CharSet">CharSet</a> value applied to that class.</p>
<p>You can use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_SizeOf__1___0_">SizeOf<t>(T)</t></a> method to determine how much unmanaged memory to allocate by using the <see cref="Overload:System.Runtime.InteropServices.Marshal.AllocHGlobal"></see> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_AllocCoTaskMem_System_Int32_">AllocCoTaskMem(Int32)</a> methods. </p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_SizeOf__1___0__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentNullException.html#System_ArgumentNullException">ArgumentNullException</a></td>
                    <td><p>The <em>structure</em> parameter is <strong>null</strong>.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_StringToBSTR_System_String_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.StringToBSTR(System.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2006">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_StringToBSTR_System_String_" data-uid="System.Runtime.InteropServices.Marshal.StringToBSTR(System.String)">StringToBSTR(String)</h4>
              <div class="markdown level1 summary"><p>Allocates a <see href="https://msdn.microsoft.com/library/ms221069.aspx">BSTR</see> and copies the contents of a managed <a class="xref" href="System.String.html#System_String">String</a> into it.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToBSTR_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToBSTR_System_String_">StringToBSTR(String)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the <strong>BSTR</strong> when finished by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr_">FreeBSTR(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr_">PtrToStringBSTR(IntPtr)</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr StringToBSTR(string s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToBSTR_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToBSTR_System_String_">StringToBSTR(String)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the <strong>BSTR</strong> when finished by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeBSTR_System_IntPtr_">FreeBSTR(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringBSTR_System_IntPtr_">PtrToStringBSTR(IntPtr)</a>.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToBSTR_System_String__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory available.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>The length for <em>s</em> is out of range.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.StringToCoTaskMemAnsi(System.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1946">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_" data-uid="System.Runtime.InteropServices.Marshal.StringToCoTaskMemAnsi(System.String)">StringToCoTaskMemAnsi(String)</h4>
              <div class="markdown level1 summary"><p>Copies the contents of a managed <a class="xref" href="System.String.html#System_String">String</a> to a block of memory allocated from the unmanaged COM task allocator.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_">StringToCoTaskMemAnsi(String)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a>. The characters of the string are copied as ANSI characters.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr StringToCoTaskMemAnsi(string s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String_">StringToCoTaskMemAnsi(String)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a>. The characters of the string are copied as ANSI characters.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemAnsi_System_String__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory available.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>The <em>s</em> parameter exceeds the maximum length allowed by the operating system.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.StringToCoTaskMemUni(System.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1875">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_" data-uid="System.Runtime.InteropServices.Marshal.StringToCoTaskMemUni(System.String)">StringToCoTaskMemUni(String)</h4>
              <div class="markdown level1 summary"><p>Copies the contents of a managed <a class="xref" href="System.String.html#System_String">String</a> to a block of memory allocated from the unmanaged COM task allocator.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_">StringToCoTaskMemUni(String)</a> is useful for custom marshaling or for use when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a>. The characters of the string are copied as Unicode characters.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr StringToCoTaskMemUni(string s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String_">StringToCoTaskMemUni(String)</a> is useful for custom marshaling or for use when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeCoTaskMem_System_IntPtr_">FreeCoTaskMem(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a>. The characters of the string are copied as Unicode characters.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToCoTaskMemUni_System_String__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>The <em>s</em> parameter exceeds the maximum length allowed by the operating system.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory available.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.StringToHGlobalAnsi(System.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1267">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_" data-uid="System.Runtime.InteropServices.Marshal.StringToHGlobalAnsi(System.String)">StringToHGlobalAnsi(String)</h4>
              <div class="markdown level1 summary"><p>Copies the contents of a managed <a class="xref" href="System.String.html#System_String">String</a> into unmanaged memory, converting into ANSI format as it copies.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>. <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a>.</p>
<p>This method copies embedded null characters, and includes a terminating null character. </p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr StringToHGlobalAnsi(string s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> is useful for custom marshaling or when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>. <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String_">StringToHGlobalAnsi(String)</a> provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringAnsi_System_IntPtr_">PtrToStringAnsi(IntPtr)</a>.</p>
<p>This method copies embedded null characters, and includes a terminating null character. </p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToHGlobalAnsi_System_String__examples">Examples</h5>
              
<p>The following example demonstrates how to convert the contents of a managed <a class="xref" href="System.String.html#System_String">String</a> class to unmanaged memory and then dispose of the unmanaged memory when done.</p>Runtime.InteropServices.Marshal.StringToHGlobalAnsi#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>There is insufficient memory available.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>The <em>s</em> parameter exceeds the maximum length allowed by the operating system.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.StringToHGlobalUni(System.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1297">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_" data-uid="System.Runtime.InteropServices.Marshal.StringToHGlobalUni(System.String)">StringToHGlobalUni(String)</h4>
              <div class="markdown level1 summary"><p>Copies the contents of a managed <a class="xref" href="System.String.html#System_String">String</a> into unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_">StringToHGlobalUni(String)</a> is useful for custom marshaling or for use when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a>.</p>
<p>This method copies embedded null characters, and includes a terminating null character.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr StringToHGlobalUni(string s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String_">StringToHGlobalUni(String)</a> is useful for custom marshaling or for use when mixing managed and unmanaged code. Because this method allocates the unmanaged memory required for a string, always free the memory by calling <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_FreeHGlobal_System_IntPtr_">FreeHGlobal(IntPtr)</a>. This method provides the opposite functionality of <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStringUni_System_IntPtr_System_Int32_">PtrToStringUni(IntPtr, Int32)</a>.</p>
<p>This method copies embedded null characters, and includes a terminating null character.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_StringToHGlobalUni_System_String__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a></td>
                    <td><p>The method could not allocate enough native heap memory.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentOutOfRangeException.html#System_ArgumentOutOfRangeException">ArgumentOutOfRangeException</a></td>
                    <td><p>The <em>s</em> parameter exceeds the maximum length allowed by the operating system.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.StructureToPtr(System.Object%2CSystem.IntPtr%2CSystem.Boolean)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_" data-uid="System.Runtime.InteropServices.Marshal.StructureToPtr(System.Object,System.IntPtr,System.Boolean)">StructureToPtr(Object, IntPtr, Boolean)</h4>
              <div class="markdown level1 summary"><p>Marshals data from a managed object to an unmanaged block of memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If <em>structure</em> is a value type, it can be boxed or unboxed. If it is boxed, it is unboxed before copying. </p>
<p>A formatted class is a reference type whose layout is specified by the <a class="xref" href="System.Runtime.InteropServices.StructLayoutAttribute.html#System_Runtime_InteropServices_StructLayoutAttribute">StructLayoutAttribute</a> attribute, as either <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Explicit">Explicit</a> or <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Sequential">Sequential</a>. </p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> copies the contents of <em>structure</em> to the pre-allocated block of memory that the <em>ptr</em> parameter points to. If <em>structure</em> contains reference types that marshal to COM interface pointers (interfaces, classes without layout, and <a class="xref" href="System.Object.html#System_Object">Object</a>), the managed objects are kept alive with reference counts. All other reference types (for example, strings and arrays) are marshaled to copies. To release these managed or unmanaged objects, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a>method before you free the memory block.</p>
<p>If you use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> method to copy a different instance to the memory block at a later time, specify <strong>true</strong> for <em>fDeleteOld</em> to remove reference counts for reference types in the previous instance. Otherwise, the managed reference typesand unmanaged copies are effectively leaked. </p>
<p>The overall pattern for using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> is as follows:</p>
<ol><li>
<p>On the first call to the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a>method after a memory block has been allocated, <em>fDeleteOld</em>must be<strong>false</strong>, because there are no contents to clear. </p>
<p>Specify <strong>true</strong> for <em>fDeleteOld</em> only if the block contains valid data. </p>
</li><li>
<p>If you copy a different instance to the memory block, and the object contains reference types, <em>fDeleteOld</em> must be <strong>true</strong> to free reference types in the old contents. </p>
</li><li>
<p>If the object contains reference types, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> method before you free the memory block. </p>
</li></ol>
<p>To pin an existing structure instead of copying it, use the <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> type to create a pinned handle for the structure. For details on how to pin, see Copying and Pinning.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.MayFail)]
[ComVisible(true)]
public static void StructureToPtr(object structure, IntPtr ptr, bool fDeleteOld)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>structure</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Boolean.html#System_Boolean">Boolean</a></td>
                    <td><em>fDeleteOld</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If <em>structure</em> is a value type, it can be boxed or unboxed. If it is boxed, it is unboxed before copying. </p>
<p>A formatted class is a reference type whose layout is specified by the <a class="xref" href="System.Runtime.InteropServices.StructLayoutAttribute.html#System_Runtime_InteropServices_StructLayoutAttribute">StructLayoutAttribute</a> attribute, as either <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Explicit">Explicit</a> or <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Sequential">Sequential</a>. </p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> copies the contents of <em>structure</em> to the pre-allocated block of memory that the <em>ptr</em> parameter points to. If <em>structure</em> contains reference types that marshal to COM interface pointers (interfaces, classes without layout, and <a class="xref" href="System.Object.html#System_Object">Object</a>), the managed objects are kept alive with reference counts. All other reference types (for example, strings and arrays) are marshaled to copies. To release these managed or unmanaged objects, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a>method before you free the memory block.</p>
<p>If you use the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> method to copy a different instance to the memory block at a later time, specify <strong>true</strong> for <em>fDeleteOld</em> to remove reference counts for reference types in the previous instance. Otherwise, the managed reference typesand unmanaged copies are effectively leaked. </p>
<p>The overall pattern for using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> is as follows:</p>
<ol><li>
<p>On the first call to the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a>method after a memory block has been allocated, <em>fDeleteOld</em>must be<strong>false</strong>, because there are no contents to clear. </p>
<p>Specify <strong>true</strong> for <em>fDeleteOld</em> only if the block contains valid data. </p>
</li><li>
<p>If you copy a different instance to the memory block, and the object contains reference types, <em>fDeleteOld</em> must be <strong>true</strong> to free reference types in the old contents. </p>
</li><li>
<p>If the object contains reference types, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure_System_IntPtr_System_Type_">DestroyStructure(IntPtr, Type)</a> method before you free the memory block. </p>
</li></ol>
<p>To pin an existing structure instead of copying it, use the <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> type to create a pinned handle for the structure. For details on how to pin, see Copying and Pinning.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean__examples">Examples</h5>
              
<p>The following example creates a managed structure, transfers it to unmanaged memory using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr_System_Object_System_IntPtr_System_Boolean_">StructureToPtr(Object, IntPtr, Boolean)</a> method, and then transfers it back to managed memory using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_PtrToStructure_System_IntPtr_System_Type_">PtrToStructure(IntPtr, Type)</a> method. </p>Runtime.InteropServices.Marshal.PtrToStructure-SizeOf#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>structure</em> is a reference type that is not a formatted class.</p>
<p>-or-</p>
<p>
<em>structure</em> is a generic type. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.StructureToPtr%60%601(%60%600%2CSystem.IntPtr%2CSystem.Boolean)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L996">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_" data-uid="System.Runtime.InteropServices.Marshal.StructureToPtr``1(``0,System.IntPtr,System.Boolean)">StructureToPtr&lt;T&gt;(T, IntPtr, Boolean)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Marshals data from a managed object of a specified type to an unmanaged block of memory. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>A formatted class is a reference type whose layout is specified by the <a class="xref" href="System.Runtime.InteropServices.StructLayoutAttribute.html#System_Runtime_InteropServices_StructLayoutAttribute">StructLayoutAttribute</a> attribute, as either <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Explicit">Explicit</a> or <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Sequential">Sequential</a>. </p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> copies the contents of <em>structure</em> to the pre-allocated block of memory that the <em>ptr</em> parameter points to. If <em>structure</em> contains reference types that marshal to COM interface pointers (interfaces, classes without layout, and <a class="xref" href="System.Object.html#System_Object">Object</a>), the managed objects are kept alive with reference counts. All other reference types (for example, strings and arrays) are marshaled to copies. To release these managed or unmanaged objects, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr_">DestroyStructure<t>(IntPtr)</t></a> method before you free the memory block. </p>
<p>If you use the<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> method to copy a different instance to the memory block at a later time, specify <strong>true</strong> for <em>fDeleteOld</em> to remove reference counts for reference types in the previous instance. Otherwise, the managed reference types and unmanaged copies are effectively leaked. </p>
<p>The overall pattern for using<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> is as follows:</p>
<ol><li>
<p>On the first call to the<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> method after a memory block has been allocated, <em>fDeleteOld</em> must be <strong>false</strong>, because there are no contents to clear. </p>
<p>Specify <strong>true</strong> for <em>fDeleteOld</em> only if the block contains valid data. </p>
</li><li>
<p>If you copy a different instance to the memory block, and the object contains reference types, <em>fDeleteOld</em> must be <strong>true</strong> to free reference types in the old contents. </p>
</li><li>
<p>If the object contains reference types, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr_">DestroyStructure<t>(IntPtr)</t></a> method before you free the memory block. </p>
</li></ol>
<p>To pin an existing structure instead of copying it, use the <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> type to create a pinned handle for the structure. For details on how to pin, see Copying and Pinning.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void StructureToPtr&lt;T&gt;(T structure, IntPtr ptr, bool fDeleteOld)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">T</span></td>
                    <td><em>structure</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Boolean.html#System_Boolean">Boolean</a></td>
                    <td><em>fDeleteOld</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>A formatted class is a reference type whose layout is specified by the <a class="xref" href="System.Runtime.InteropServices.StructLayoutAttribute.html#System_Runtime_InteropServices_StructLayoutAttribute">StructLayoutAttribute</a> attribute, as either <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Explicit">Explicit</a> or <a class="xref" href="System.Runtime.InteropServices.LayoutKind.html#System_Runtime_InteropServices_LayoutKind_Sequential">Sequential</a>. </p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> copies the contents of <em>structure</em> to the pre-allocated block of memory that the <em>ptr</em> parameter points to. If <em>structure</em> contains reference types that marshal to COM interface pointers (interfaces, classes without layout, and <a class="xref" href="System.Object.html#System_Object">Object</a>), the managed objects are kept alive with reference counts. All other reference types (for example, strings and arrays) are marshaled to copies. To release these managed or unmanaged objects, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr_">DestroyStructure<t>(IntPtr)</t></a> method before you free the memory block. </p>
<p>If you use the<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> method to copy a different instance to the memory block at a later time, specify <strong>true</strong> for <em>fDeleteOld</em> to remove reference counts for reference types in the previous instance. Otherwise, the managed reference types and unmanaged copies are effectively leaked. </p>
<p>The overall pattern for using<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> is as follows:</p>
<ol><li>
<p>On the first call to the<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean_">StructureToPtr<t>(T, IntPtr, Boolean)</t></a> method after a memory block has been allocated, <em>fDeleteOld</em> must be <strong>false</strong>, because there are no contents to clear. </p>
<p>Specify <strong>true</strong> for <em>fDeleteOld</em> only if the block contains valid data. </p>
</li><li>
<p>If you copy a different instance to the memory block, and the object contains reference types, <em>fDeleteOld</em> must be <strong>true</strong> to free reference types in the old contents. </p>
</li><li>
<p>If the object contains reference types, you must call the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_DestroyStructure__1_System_IntPtr_">DestroyStructure<t>(IntPtr)</t></a> method before you free the memory block. </p>
</li></ol>
<p>To pin an existing structure instead of copying it, use the <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> type to create a pinned handle for the structure. For details on how to pin, see Copying and Pinning.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_StructureToPtr__1___0_System_IntPtr_System_Boolean__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>structure</em> is a reference type that is not a formatted class. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(System.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1109">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(System.Int32)">ThrowExceptionForHR(Int32)</h4>
              <div class="markdown level1 summary"><p>Throws an exception with a specific failure HRESULT value.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>This method creates an exception object for the specified failure HRESULT. If the HRESULT is 0 or positive (a success code), the method returns without creating or throwing an exception.</p></p>
<p><p>Note that the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> method returns an exception based on the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface of the current thread if one is set. When this happens, the <em>errorCode</em> parameter is ignored.</p></p>
<p><p>Some failure HRESULTs map to defined exceptions, whereas others do not. If the HRESULT maps to a defined exception, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> creates an instance of the exception and throws it. Otherwise, it creates an instance of <a class="xref" href="System.Runtime.InteropServices.COMException.html#System_Runtime_InteropServices_COMException">COMException</a>, initializes the error code field with the HRESULT, and throws that exception. When <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> is invoked, it attempts to retrieve extra information regarding the error by using the unmanaged <see href="https://msdn.microsoft.com/library/ms221032(v=vs.85).aspx">GetErrorInfo</see> function.</p></p>
<p><p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p></p>
<p><p>Occasionally, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> might return an exception from a previous COM call. In this case, you can use the following workaround and pass <code>IntPtr(-1)</code> as the second parameter (<code>errorInfo</code>):</p></p>
<pre><code>[SecurityPermissionAttribute(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.UnmanagedCode)]
public static void ThrowExceptionForHR(interrorCode,IntPtrerrorInfo)</code></pre>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void ThrowExceptionForHR(int errorCode)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>errorCode</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>This method creates an exception object for the specified failure HRESULT. If the HRESULT is 0 or positive (a success code), the method returns without creating or throwing an exception.</p></p>
<p><p>Note that the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> method returns an exception based on the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface of the current thread if one is set. When this happens, the <em>errorCode</em> parameter is ignored.</p></p>
<p><p>Some failure HRESULTs map to defined exceptions, whereas others do not. If the HRESULT maps to a defined exception, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> creates an instance of the exception and throws it. Otherwise, it creates an instance of <a class="xref" href="System.Runtime.InteropServices.COMException.html#System_Runtime_InteropServices_COMException">COMException</a>, initializes the error code field with the HRESULT, and throws that exception. When <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> is invoked, it attempts to retrieve extra information regarding the error by using the unmanaged <see href="https://msdn.microsoft.com/library/ms221032(v=vs.85).aspx">GetErrorInfo</see> function.</p></p>
<p><p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p></p>
<p><p>Occasionally, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> might return an exception from a previous COM call. In this case, you can use the following workaround and pass <code>IntPtr(-1)</code> as the second parameter (<code>errorInfo</code>):</p></p>
<pre><code>[SecurityPermissionAttribute(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.UnmanagedCode)]
public static void ThrowExceptionForHR(interrorCode,IntPtrerrorInfo)</code></pre>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(System.Int32%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L1115">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(System.Int32,System.IntPtr)">ThrowExceptionForHR(Int32, IntPtr)</h4>
              <div class="markdown level1 summary"><p>Throws an exception with a specific failure HRESULT, based on the specified <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method creates an exception object for the specified failure HRESULT. If the HRESULT is 0 or positive (a success code), the method returns without creating or throwing an exception.</p>
<p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr_">ThrowExceptionForHR(Int32, IntPtr)</a> method releases the <em>errorInfo</em> parameter, decreasing the COM reference count of the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface.</p>
<p>Note that the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr_">ThrowExceptionForHR(Int32, IntPtr)</a> method returns an exception based on the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface of the current thread if one is set. When this happens, the <em>errorCode</em> parameter is ignored.</p>
<p>Some failure HRESULTs map to defined exceptions, whereas others do not. If the HRESULT maps to a defined exception, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> creates an instance of the exception and throws it. Otherwise, it creates an instance of <a class="xref" href="System.Runtime.InteropServices.COMException.html#System_Runtime_InteropServices_COMException">COMException</a>, initializes the error code field with the HRESULT, and throws that exception. The <em>errorInfo</em> parameter is used to retrieve extra information regarding the error.</p>
<p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void ThrowExceptionForHR(int errorCode, IntPtr errorInfo)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>errorCode</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>errorInfo</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method creates an exception object for the specified failure HRESULT. If the HRESULT is 0 or positive (a success code), the method returns without creating or throwing an exception.</p>
<p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr_">ThrowExceptionForHR(Int32, IntPtr)</a> method releases the <em>errorInfo</em> parameter, decreasing the COM reference count of the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface.</p>
<p>Note that the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr_">ThrowExceptionForHR(Int32, IntPtr)</a> method returns an exception based on the <see href="https://msdn.microsoft.com/library/ms221233(v=vs.85).aspx">IErrorInfo</see> interface of the current thread if one is set. When this happens, the <em>errorCode</em> parameter is ignored.</p>
<p>Some failure HRESULTs map to defined exceptions, whereas others do not. If the HRESULT maps to a defined exception, <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_">ThrowExceptionForHR(Int32)</a> creates an instance of the exception and throws it. Otherwise, it creates an instance of <a class="xref" href="System.Runtime.InteropServices.COMException.html#System_Runtime_InteropServices_COMException">COMException</a>, initializes the error code field with the HRESULT, and throws that exception. The <em>errorInfo</em> parameter is used to retrieve extra information regarding the error.</p>
<p>For the mapping from each HRESULT to its comparable exception class in the .NET Framework, see How to: Map HRESULTs and Exceptions.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ThrowExceptionForHR_System_Int32_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement_System_Array_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.UnsafeAddrOfPinnedArrayElement(System.Array%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              
              <h4 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement_System_Array_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.UnsafeAddrOfPinnedArrayElement(System.Array,System.Int32)">UnsafeAddrOfPinnedArrayElement(Array, Int32)</h4>
              <div class="markdown level1 summary"><p>Gets the address of the element at the specified index inside the specified array.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement_System_Array_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The array must be pinned using a <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> before it is passed to this method. For maximum performance, this method does not validate the array passed to it; this can result in unexpected behavior.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
[MethodImpl(MethodImplOptions.InternalCall)]
public static IntPtr UnsafeAddrOfPinnedArrayElement(Array arr, int index)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Array.html#System_Array">Array</a></td>
                    <td><em>arr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>index</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement_System_Array_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The array must be pinned using a <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> before it is passed to this method. For maximum performance, this method does not validate the array passed to it; this can result in unexpected behavior.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement_System_Array_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement__1___0___System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.UnsafeAddrOfPinnedArrayElement%60%601(%60%600%5B%5D%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L337">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement__1___0___System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.UnsafeAddrOfPinnedArrayElement``1(``0[],System.Int32)">UnsafeAddrOfPinnedArrayElement&lt;T&gt;(T[], Int32)</h4>
              <div class="markdown level1 summary"><p>[Supported in the .NET Framework 4.5.1 and later versions] </p>
<p>Gets the address of the element at the specified index in an array of a specified type. </p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement__1___0___System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The array must be pinned by using a <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> before it is passed to this method. For maximum performance, this method does not validate the array passed to it; this can result in unexpected behavior.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static IntPtr UnsafeAddrOfPinnedArrayElement&lt;T&gt;(T[] arr, int index)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>T[]</td>
                    <td><em>arr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>index</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement__1___0___System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The array must be pinned by using a <a class="xref" href="System.Runtime.InteropServices.GCHandle.html#System_Runtime_InteropServices_GCHandle">GCHandle</a> before it is passed to this method. For maximum performance, this method does not validate the array passed to it; this can result in unexpected behavior.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_UnsafeAddrOfPinnedArrayElement__1___0___System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Byte_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteByte(System.IntPtr%2CSystem.Byte)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L684">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Byte_" data-uid="System.Runtime.InteropServices.Marshal.WriteByte(System.IntPtr,System.Byte)">WriteByte(IntPtr, Byte)</h4>
              <div class="markdown level1 summary"><p>Writes a single byte value to unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Byte__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteByte(IntPtr ptr, byte val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Byte__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Byte__examples">Examples</h5>
              
<p>The following example creates a block of unmanaged memory, writes a byte to the unmanaged memory, reads the byte back from unmanaged memory, and then disposes the unmanaged memory.</p>Runtime.InteropServices.Marshal.ReadByte - WriteByte#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteByte(System.IntPtr%2CSystem.Int32%2CSystem.Byte)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L657">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_" data-uid="System.Runtime.InteropServices.Marshal.WriteByte(System.IntPtr,System.Int32,System.Byte)">WriteByte(IntPtr, Int32, Byte)</h4>
              <div class="markdown level1 summary"><p>Writes a single byte value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteByte(IntPtr ptr, int ofs, byte val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadByte_System_IntPtr_System_Int32_">ReadByte(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#3
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteByte_System_Object_System_Int32_System_Byte_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteByte(System.Object%2CSystem.Int32%2CSystem.Byte)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L672">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteByte_System_Object_System_Int32_System_Byte_" data-uid="System.Runtime.InteropServices.Marshal.WriteByte(System.Object,System.Int32,System.Byte)">WriteByte(Object, Int32, Byte)</h4>
              <div class="markdown level1 summary"><p>Writes a single byte value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_Object_System_Int32_System_Byte__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteByte([MarshalAs(UnmanagedType.AsAny), In, Out] object ptr, int ofs, byte val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Byte.html#System_Byte">Byte</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_Object_System_Int32_System_Byte__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteByte_System_IntPtr_System_Int32_System_Byte_">WriteByte(IntPtr, Int32, Byte)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteByte_System_Object_System_Int32_System_Byte__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Char_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr%2CSystem.Char)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L746">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Char_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr,System.Char)">WriteInt16(IntPtr, Char)</h4>
              <div class="markdown level1 summary"><p>Writes a character as a 16-bit integer value to unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Char__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt16(IntPtr ptr, char val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Char.html#System_Char">Char</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Char__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Char__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#4
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int16_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr%2CSystem.Int16)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L728">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int16_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr,System.Int16)">WriteInt16(IntPtr, Int16)</h4>
              <div class="markdown level1 summary"><p>Writes a 16-bit integer value to unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int16__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt16(IntPtr ptr, short val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int16__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int16__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a>methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#4
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Char_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr%2CSystem.Int32%2CSystem.Char)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L734">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Char_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr,System.Int32,System.Char)">WriteInt16(IntPtr, Int32, Char)</h4>
              <div class="markdown level1 summary"><p>Writes a 16-bit signed integer value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Char__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt16(IntPtr ptr, int ofs, char val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Char.html#System_Char">Char</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Char__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Char__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#4
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr%2CSystem.Int32%2CSystem.Int16)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L690">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt16(System.IntPtr,System.Int32,System.Int16)">WriteInt16(IntPtr, Int32, Int16)</h4>
              <div class="markdown level1 summary"><p>Writes a 16-bit signed integer value into unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt16(IntPtr ptr, int ofs, short val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt16_System_IntPtr_System_Int32_">ReadInt16(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#4
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Char_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt16(System.Object%2CSystem.Int32%2CSystem.Char)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L740">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Char_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt16(System.Object,System.Int32,System.Char)">WriteInt16(Object, Int32, Char)</h4>
              <div class="markdown level1 summary"><p>Writes a 16-bit signed integer value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Char__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt16([In, Out] object ptr, int ofs, char val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Char.html#System_Char">Char</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Char__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Char__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Int16_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt16(System.Object%2CSystem.Int32%2CSystem.Int16)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L716">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Int16_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt16(System.Object,System.Int32,System.Int16)">WriteInt16(Object, Int32, Int16)</h4>
              <div class="markdown level1 summary"><p>Writes a 16-bit signed integer value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Int16__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt16([MarshalAs(UnmanagedType.AsAny), In, Out] object ptr, int ofs, short val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int16.html#System_Int16">Int16</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Int16__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt16_System_IntPtr_System_Int32_System_Int16_">WriteInt16(IntPtr, Int32, Int16)</a> enables direct interaction with an unmanaged 16-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt16_System_Object_System_Int32_System_Int16__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt32(System.IntPtr%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L792">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt32(System.IntPtr,System.Int32)">WriteInt32(IntPtr, Int32)</h4>
              <div class="markdown level1 summary"><p>Writes a 32-bit signed integer value to unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt32(IntPtr ptr, int val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_">ReadInt32(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#5
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>. </p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt32(System.IntPtr%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L752">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt32(System.IntPtr,System.Int32,System.Int32)">WriteInt32(IntPtr, Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Writes a 32-bit signed integer value into unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt32(IntPtr ptr, int ofs, int val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt32_System_IntPtr_System_Int32_">ReadInt32(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#5
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt32_System_Object_System_Int32_System_Int32_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt32(System.Object%2CSystem.Int32%2CSystem.Int32)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L780">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_Object_System_Int32_System_Int32_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt32(System.Object,System.Int32,System.Int32)">WriteInt32(Object, Int32, Int32)</h4>
              <div class="markdown level1 summary"><p>Writes a 32-bit signed integer value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_Object_System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt32([MarshalAs(UnmanagedType.AsAny), In, Out] object ptr, int ofs, int val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_Object_System_Int32_System_Int32__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt32_System_IntPtr_System_Int32_System_Int32_">WriteInt32(IntPtr, Int32, Int32)</a> enables direct interaction with an unmanaged 32-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt32_System_Object_System_Int32_System_Int32__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt64(System.IntPtr%2CSystem.Int32%2CSystem.Int64)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L828">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt64(System.IntPtr,System.Int32,System.Int64)">WriteInt64(IntPtr, Int32, Int64)</h4>
              <div class="markdown level1 summary"><p>Writes a 64-bit signed integer value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt64(IntPtr ptr, int ofs, long val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32_">ReadInt64(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#6
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int64_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt64(System.IntPtr%2CSystem.Int64)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L872">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int64_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt64(System.IntPtr,System.Int64)">WriteInt64(IntPtr, Int64)</h4>
              <div class="markdown level1 summary"><p>Writes a 64-bit signed integer value to unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int64__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt64(IntPtr ptr, long val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int64__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int64__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadInt64_System_IntPtr_System_Int32_">ReadInt64(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#6
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteInt64_System_Object_System_Int32_System_Int64_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteInt64(System.Object%2CSystem.Int32%2CSystem.Int64)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L860">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_Object_System_Int32_System_Int64_" data-uid="System.Runtime.InteropServices.Marshal.WriteInt64(System.Object,System.Int32,System.Int64)">WriteInt64(Object, Int32, Int64)</h4>
              <div class="markdown level1 summary"><p>Writes a 64-bit signed integer value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_Object_System_Int32_System_Int64__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteInt64([MarshalAs(UnmanagedType.AsAny), In, Out] object ptr, int ofs, long val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int64.html#System_Int64">Int64</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_Object_System_Int32_System_Int64__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteInt64_System_IntPtr_System_Int32_System_Int64_">WriteInt64(IntPtr, Int32, Int64)</a> enables direct interaction with an unmanaged 64-bit signed array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteInt64_System_Object_System_Int32_System_Int64__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteIntPtr(System.IntPtr%2CSystem.Int32%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L798">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.WriteIntPtr(System.IntPtr,System.Int32,System.IntPtr)">WriteIntPtr(IntPtr, Int32, IntPtr)</h4>
              <div class="markdown level1 summary"><p>Writes a processor native-sized integer value to unmanaged memory at a specified offset.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method writes a 32 bit integer on 32 bit systems, and a 64 bit integer on 64 bit systems.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteIntPtr(IntPtr ptr, int ofs, IntPtr val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>This method writes a 32 bit integer on 32 bit systems, and a 64 bit integer on 64 bit systems.</p>
<p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32_">ReadIntPtr(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#2
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteIntPtr(System.IntPtr%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L818">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.WriteIntPtr(System.IntPtr,System.IntPtr)">WriteIntPtr(IntPtr, IntPtr)</h4>
              <div class="markdown level1 summary"><p>Writes a processor native sized integer value into unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteIntPtr(IntPtr ptr, IntPtr val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> enables direct interaction with an unmanaged C-style <strong>IntPtr</strong> array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to read and write to an unmanaged array using the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ReadIntPtr_System_IntPtr_System_Int32_">ReadIntPtr(IntPtr, Int32)</a> and <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> methods.</p>System.Runtime.interopServices.Marshal.Read-Write val#2
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>
<em>ptr</em> is not a recognized format.</p>
<p>-or-</p>
<p>
<em>ptr</em> is <strong>null</strong>.</p>
<p>-or-</p>
<p>
<em>ptr</em> is invalid.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_WriteIntPtr_System_Object_System_Int32_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.WriteIntPtr(System.Object%2CSystem.Int32%2CSystem.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L808">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_Object_System_Int32_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.WriteIntPtr(System.Object,System.Int32,System.IntPtr)">WriteIntPtr(Object, Int32, IntPtr)</h4>
              <div class="markdown level1 summary"><p>Writes a processor native sized integer value to unmanaged memory.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_Object_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void WriteIntPtr([MarshalAs(UnmanagedType.AsAny), In, Out] object ptr, int ofs, IntPtr val)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td><em>ptr</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td><em>ofs</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>val</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_Object_System_Int32_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>
<a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_WriteIntPtr_System_IntPtr_System_Int32_System_IntPtr_">WriteIntPtr(IntPtr, Int32, IntPtr)</a> enables direct interaction with an unmanaged C-style byte array, eliminating the expense of copying an entire unmanaged array (using <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_Copy_System_Int32___System_Int32_System_IntPtr_System_Int32_">Copy(Int32[], Int32, IntPtr, Int32)</a>) to a separate managed array before setting its element values.</p>
<p>Writing to unaligned memory locations is supported.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_WriteIntPtr_System_Object_System_Int32_System_IntPtr__examples">Examples</h5>
              
<p>The following example shows how to use various methods defined by the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal">Marshal</a> class.</p>Marshal#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span class="xref">System.AccessViolationException</span></td>
                    <td><p>Base address (<em>ptr</em>) plus offset byte (<em>ofs</em>) produces a null or invalid address.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>
<em>ptr</em> is an <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> object. This method does not accept <a class="xref" href="System.Runtime.InteropServices.ArrayWithOffset.html#System_Runtime_InteropServices_ArrayWithOffset">ArrayWithOffset</a> parameters.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ZeroFreeBSTR_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ZeroFreeBSTR(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2705">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ZeroFreeBSTR_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ZeroFreeBSTR(System.IntPtr)">ZeroFreeBSTR(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees a <see href="https://msdn.microsoft.com/library/ms221069.aspx">BSTR</see> pointer that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToBSTR(System.Security.SecureString)</span> method.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeBSTR_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeBSTR_System_IntPtr_">ZeroFreeBSTR(IntPtr)</a> method first sets the contents of the BSTR to zero, and then frees the BSTR.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void ZeroFreeBSTR(IntPtr s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeBSTR_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeBSTR_System_IntPtr_">ZeroFreeBSTR(IntPtr)</a> method first sets the contents of the BSTR to zero, and then frees the BSTR.</p>
</div>
              
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ZeroFreeCoTaskMemAnsi(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2713">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ZeroFreeCoTaskMemAnsi(System.IntPtr)">ZeroFreeCoTaskMemAnsi(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees an unmanaged string pointer that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToCoTaskMemAnsi(System.Security.SecureString)</span> method.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr_">ZeroFreeCoTaskMemAnsi(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToCoTaskMemAnsi(System.Security.SecureString)</span> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void ZeroFreeCoTaskMemAnsi(IntPtr s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr_">ZeroFreeCoTaskMemAnsi(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToCoTaskMemAnsi(System.Security.SecureString)</span> method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr__examples">Examples</h5>
              
<p>The following example uses the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToCoTaskMemAnsi(System.Security.SecureString)</span> method to marshal and decrypt the contents of a <a class="xref" href="System.Security.SecureString.html#System_Security_SecureString">SecureString</a> object to a block of unmanaged memory. It then uses the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemAnsi_System_IntPtr_">ZeroFreeCoTaskMemAnsi(IntPtr)</a> method to zero out and dispose the unmanaged block.</p>Runtime.InteropServices.Marshal.SecureStringToCoTaskMemAnsi#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemUnicode_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ZeroFreeCoTaskMemUnicode(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2720">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemUnicode_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ZeroFreeCoTaskMemUnicode(System.IntPtr)">ZeroFreeCoTaskMemUnicode(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees an unmanaged string pointer that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToCoTaskMemUnicode(System.Security.SecureString)</span> method.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemUnicode_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemUnicode_System_IntPtr_">ZeroFreeCoTaskMemUnicode(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToCoTaskMemUnicode(System.Security.SecureString)</span> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void ZeroFreeCoTaskMemUnicode(IntPtr s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemUnicode_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeCoTaskMemUnicode_System_IntPtr_">ZeroFreeCoTaskMemUnicode(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToCoTaskMemUnicode(System.Security.SecureString)</span> method.</p>
</div>
              
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ZeroFreeGlobalAllocAnsi(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2756">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ZeroFreeGlobalAllocAnsi(System.IntPtr)">ZeroFreeGlobalAllocAnsi(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees an unmanaged string pointer that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocAnsi(System.Security.SecureString)</span> method.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr_">ZeroFreeGlobalAllocAnsi(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocAnsi(System.Security.SecureString)</span> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void ZeroFreeGlobalAllocAnsi(IntPtr s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr_">ZeroFreeGlobalAllocAnsi(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocAnsi(System.Security.SecureString)</span> method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr__examples">Examples</h5>
              
<p>The following example uses the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocAnsi(System.Security.SecureString)</span> method to marshal and decrypt the contents of a <a class="xref" href="System.Security.SecureString.html#System_Security_SecureString">SecureString</a> object to a block of unmanaged memory. It then uses the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocAnsi_System_IntPtr_">ZeroFreeGlobalAllocAnsi(IntPtr)</a> method to zero out and dispose the unmanaged block.</p>Runtime.InteropServices.Marshal.SecureStringToHGlobalAnsi#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr_.md&amp;value=---%0Auid%3A%20System.Runtime.InteropServices.Marshal.ZeroFreeGlobalAllocUnicode(System.IntPtr)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Runtime/InteropServices/Marshal.cs/#L2762">View Source</a>
              </span>
              <h4 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr_" data-uid="System.Runtime.InteropServices.Marshal.ZeroFreeGlobalAllocUnicode(System.IntPtr)">ZeroFreeGlobalAllocUnicode(IntPtr)</h4>
              <div class="markdown level1 summary"><p>Frees an unmanaged string pointer that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocUnicode(System.Security.SecureString)</span> method.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr_">ZeroFreeGlobalAllocUnicode(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocUnicode(System.Security.SecureString)</span> method.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">[SecurityCritical]
public static void ZeroFreeGlobalAllocUnicode(IntPtr s)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.IntPtr.html#System_IntPtr">IntPtr</a></td>
                    <td><em>s</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr_">ZeroFreeGlobalAllocUnicode(IntPtr)</a> method first zeros out and then frees unmanaged memory that was allocated using the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocUnicode(System.Security.SecureString)</span> method.</p>
</div>
              <h5 id="System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr__examples">Examples</h5>
              
<p>The following example demonstrates how to use the <span class="xref">System.Runtime.InteropServices.Marshal.SecureStringToGlobalAllocUnicode(System.Security.SecureString)</span> method with the unmanaged <strong>LogonUser</strong> function to perform impersonation with the <a class="xref" href="System.Security.SecureString.html#System_Security_SecureString">SecureString</a> class. The example then uses the <a class="xref" href="System.Runtime.InteropServices.Marshal.html#System_Runtime_InteropServices_Marshal_ZeroFreeGlobalAllocUnicode_System_IntPtr_">ZeroFreeGlobalAllocUnicode(IntPtr)</a> method to zero out and free the unmanaged string reference.</p>Runtime.InteropServices.Marshal.SecureStringToHGlobalUni#1
            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
            <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
            </nav>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="inner-footer">
          <p>© .NET Foundation</p>
          <p>
            <a href="https://www.github.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-github fa-stack-1x"></span>
            </span></a>
            <a href="https://twitter.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-twitter fa-stack-1x"></span>
            </span></a>
            <a href="https://www.facebook.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-facebook fa-stack-1x"></span>
            </span></a>
      
          </p>
          </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
