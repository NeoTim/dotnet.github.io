<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Class SqlCommand
   | CoreCLR site </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Class SqlCommand
   | CoreCLR site ">
    
    <link rel="shortcut icon" href="../images/Logo_DotNet.png" type="image/x-icon">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/style.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-63735192-1', 'auto');
    ga('send', 'pageview');
    </script>
  </head>  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav class="navbar navbar-inverse">
             <div class="container">
               <a href="../"><img height="50px" src="../images/Logo_DotNet.png" style="float:right;"></a>
               <div class="navbar-header ">
                 <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                   <span class="sr-only">Toggle navigation</span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                 </button>
                 <a class="navbar-brand" href="../"><span class="dotnet">.NET Core</span></a>
               </div>
               <div id="navbar" class="collapse navbar-collapse">
               </div><!--/.nav-collapse -->
             </div>
           </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content">
              
              <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="pull-right mobile-hide"><span class="fa fa-github"></span>Improve this Doc</a>
              <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L18" class="pull-right mobile-hide">View Source</a>
              <h1 id="System_Data_SqlClient_SqlCommand" data-uid="System.Data.SqlClient.SqlCommand">Class SqlCommand
              </h1>
              <div class="markdown level0 summary"><p>Represents a Transact-SQL statement or stored procedure to execute against a SQL Server database. This class cannot be inherited.</p>
</div>
              <div class="markdown level0 conceptual"></div>
              <div class="inheritance">
                <h5>Inheritance</h5>
                  <div class="level0"><a class="xref" href="System.Object.html#System_Object">Object</a></div>
                  <div class="level1"><span class="xref">SqlCommand</span></div>
              </div>
              <h6><strong>Namespace</strong>:System.Data.SqlClient</h6>
              <h6><strong>Assembly</strong>:System.Data.SqlClient.dll</h6>
              <h5 id="System_Data_SqlClient_SqlCommand_syntax">Syntax</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public sealed class SqlCommand : DbCommand</code></pre>
              </div>
              <h5 id="System_Data_SqlClient_SqlCommand_examples"><strong>Examples</strong></h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h3 id="constructors">Constructors
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand__ctor.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.%23ctor%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L203">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand__ctor" data-uid="System.Data.SqlClient.SqlCommand.#ctor">SqlCommand()</h4>
              <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> class.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The base constructor initializes all fields to their default values. The following table shows initial property values for an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>empty string (&quot;&quot;) </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>Null </p>
</td></tr></tbody></table>
<p>You can change the value for any of these properties through a separate call to the property.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlCommand()</code></pre>
              </div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The base constructor initializes all fields to their default values. The following table shows initial property values for an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>empty string (&quot;&quot;) </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>Null </p>
</td></tr></tbody></table>
<p>You can change the value for any of these properties through a separate call to the property.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and sets the <strong>CommandTimeout</strong> property.</p>Classic WebData IDbCommand.CommandTimeout Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand__ctor_System_String_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.%23ctor(System.String)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L208">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand__ctor_System_String_" data-uid="System.Data.SqlClient.SqlCommand.#ctor(System.String)">SqlCommand(String)</h4>
              <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> class with the text of the query.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> is created, the following read/write properties are set to initial values.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>
<em>cmdText</em>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>null </p>
</td></tr></tbody></table>
<p>You can change the value for any of these properties through a separate call to the property.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlCommand(string cmdText)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>cmdText</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> is created, the following read/write properties are set to initial values.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>
<em>cmdText</em>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>null </p>
</td></tr></tbody></table>
<p>You can change the value for any of these properties through a separate call to the property.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, passing in the connection string and command text.</p>Classic WebData SqlCommand.SqlCommand1 Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.%23ctor(System.String%2CSystem.Data.SqlClient.SqlConnection)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L213">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection_" data-uid="System.Data.SqlClient.SqlCommand.#ctor(System.String,System.Data.SqlClient.SqlConnection)">SqlCommand(String, SqlConnection)</h4>
              <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> class with the text of the query and a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The following table shows initial property values for an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>
<em>cmdText</em>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>A new <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> that is the value for the <em>connection</em> parameter. </p>
</td></tr></tbody></table>
<p>You can change the value for any of these parameters by setting the related property.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlCommand(string cmdText, SqlConnection connection)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>cmdText</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a></td>
                    <td><em>connection</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The following table shows initial property values for an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>
<em>cmdText</em>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>A new <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> that is the value for the <em>connection</em> parameter. </p>
</td></tr></tbody></table>
<p>You can change the value for any of these parameters by setting the related property.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and sets some of its properties.</p>Classic WebData SqlCommand.SqlCommand2 Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection_System_Data_SqlClient_SqlTransaction_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.%23ctor(System.String%2CSystem.Data.SqlClient.SqlConnection%2CSystem.Data.SqlClient.SqlTransaction)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L219">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection_System_Data_SqlClient_SqlTransaction_" data-uid="System.Data.SqlClient.SqlCommand.#ctor(System.String,System.Data.SqlClient.SqlConnection,System.Data.SqlClient.SqlTransaction)">SqlCommand(String, SqlConnection, SqlTransaction)</h4>
              <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> class with the text of the query, a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, and the <a class="xref" href="System.Data.SqlClient.SqlTransaction.html#System_Data_SqlClient_SqlTransaction">SqlTransaction</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection_System_Data_SqlClient_SqlTransaction__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The following table shows initial property values for an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>
<em>cmdText</em>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>A new <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> that is the value for the <em>connection</em> parameter. </p>
</td></tr></tbody></table>
<p>You can change the value for any of these parameters by setting the related property.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlCommand(string cmdText, SqlConnection connection, SqlTransaction transaction)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td><em>cmdText</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a></td>
                    <td><em>connection</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlTransaction.html#System_Data_SqlClient_SqlTransaction">SqlTransaction</a></td>
                    <td><em>transaction</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection_System_Data_SqlClient_SqlTransaction__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The following table shows initial property values for an instance of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
<p>Properties </p>
<p>Initial value </p>
<table><tbody><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a>
</p>
</td><td>
<p>
<em>cmdText</em>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a>
</p>
</td><td>
<p>30 </p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a>
</p>
</td><td>
<p>
<strong>CommandType.Text</strong>
</p>
</td></tr><tr><td>
<p>
<a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>
</p>
</td><td>
<p>A new <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> that is the value for the <em>connection</em> parameter. </p>
</td></tr></tbody></table>
<p>You can change the value for any of these parameters by setting the related property.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand__ctor_System_String_System_Data_SqlClient_SqlConnection_System_Data_SqlClient_SqlTransaction__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h3 id="properties">Properties
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_CommandText.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.CommandText%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L344">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_CommandText" data-uid="System.Data.SqlClient.SqlCommand.CommandText">CommandText</h4>
              <div class="markdown level1 summary"><p>Gets or sets the Transact-SQL statement, table name or stored procedure to execute at the data source.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandText_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property is set to <strong>StoredProcedure</strong>, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property should be set to the name of the stored procedure. The user may be required to use escape character syntax if the stored procedure name contains any special characters. The command executes this stored procedure when you call one of the <strong>Execute</strong> methods.</p>
<p>The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a Transact-SQL statement or a stored procedure called by a command of <strong>CommandType.Text</strong>. In this case, named parameters must be used. For example: </p>
<pre><code> SELECT * FROM dbo.Customers WHERE CustomerID = @CustomerID</code></pre>
<p>For more information, see Configuring Parameters and Parameter Data Types.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override string CommandText { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.String.html#System_String">String</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandText_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property is set to <strong>StoredProcedure</strong>, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property should be set to the name of the stored procedure. The user may be required to use escape character syntax if the stored procedure name contains any special characters. The command executes this stored procedure when you call one of the <strong>Execute</strong> methods.</p>
<p>The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a Transact-SQL statement or a stored procedure called by a command of <strong>CommandType.Text</strong>. In this case, named parameters must be used. For example: </p>
<pre><code> SELECT * FROM dbo.Customers WHERE CustomerID = @CustomerID</code></pre>
<p>For more information, see Configuring Parameters and Parameter Data Types.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandText_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and sets some of its properties.</p>Classic WebData SqlCommand.CommandText Example#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_CommandTimeout.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.CommandTimeout%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L361">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_CommandTimeout" data-uid="System.Data.SqlClient.SqlCommand.CommandTimeout">CommandTimeout</h4>
              <div class="markdown level1 summary"><p>Gets or sets the wait time before terminating the attempt to execute a command and generating an error.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandTimeout_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>A value of 0 indicates no limit (an attempt to execute a command will wait indefinitely).</p></p>
<p><p>The <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a> property will be ignored during asynchronous method calls such as <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span>.</p></p>
<p><p>
<p><a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a> has no effect when the command is executed against a context connection (a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> opened with &quot;context connection=true&quot; in the connection string).</p></p>
<p><p>This property is the cumulative time-out (for all network packets that are read during the invocation of a method) for all network reads during command execution or processing of the results. A time-out can still occur after the first row is returned, and does not include user processing time, only network read time.</p></p>
<p><p>For example, with a 30 second time out, if <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_Read">Read()</a> requires two network packets, then it has 30 seconds to read both network packets. If you call <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_Read">Read()</a> again, it will have another 30 seconds to read any data that it requires.</p></p>
<pre><code>using System;
using System.Data.SqlClient;
/// 
public class A {
/// 
public static void Main() {
string connectionString = "";
// Wait for 5 second delay in the command
string queryString = "waitfor delay '00:00:05'";
using (SqlConnection connection = new SqlConnection(connectionString)) {
 connection.Open();
 SqlCommand command = new SqlCommand(queryString, connection);
 // Setting command timeout to 1 second
 command.CommandTimeout = 1;
 try {
    command.ExecuteNonQuery();
 }
 catch (SqlException e) {
    Console.WriteLine("Got expected SqlException due to command timeout ");
    Console.WriteLine(e);
 }
}
}
}</code></pre>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override int CommandTimeout { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandTimeout_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>A value of 0 indicates no limit (an attempt to execute a command will wait indefinitely).</p></p>
<p><p>The <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a> property will be ignored during asynchronous method calls such as <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span>.</p></p>
<p><p>
<p><a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandTimeout">CommandTimeout</a> has no effect when the command is executed against a context connection (a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> opened with &quot;context connection=true&quot; in the connection string).</p></p>
<p><p>This property is the cumulative time-out (for all network packets that are read during the invocation of a method) for all network reads during command execution or processing of the results. A time-out can still occur after the first row is returned, and does not include user processing time, only network read time.</p></p>
<p><p>For example, with a 30 second time out, if <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_Read">Read()</a> requires two network packets, then it has 30 seconds to read both network packets. If you call <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_Read">Read()</a> again, it will have another 30 seconds to read any data that it requires.</p></p>
<pre><code>using System;
using System.Data.SqlClient;
/// 
public class A {
/// 
public static void Main() {
string connectionString = "";
// Wait for 5 second delay in the command
string queryString = "waitfor delay '00:00:05'";
using (SqlConnection connection = new SqlConnection(connectionString)) {
 connection.Open();
 SqlCommand command = new SqlCommand(queryString, connection);
 // Setting command timeout to 1 second
 command.CommandTimeout = 1;
 try {
    command.ExecuteNonQuery();
 }
 catch (SqlException e) {
    Console.WriteLine("Got expected SqlException due to command timeout ");
    Console.WriteLine(e);
 }
}
}
}</code></pre>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandTimeout_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_CommandType.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.CommandType%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L390">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_CommandType" data-uid="System.Data.SqlClient.SqlCommand.CommandType">CommandType</h4>
              <div class="markdown level1 summary"><p>Gets or sets a value indicating how the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property is to be interpreted.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandType_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When you set the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property to <strong>StoredProcedure</strong>, you should set the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property to the name of the stored procedure. The command executes this stored procedure when you call one of the Execute methods.</p>
<p>The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a SQL Statement or a stored procedure called with a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> of <a class="xref" href="System.Data.CommandType.html#System_Data_CommandType_Text">Text</a>. In this case, named parameters must be used. For example: </p>
<p>SELECT * FROM Customers WHERE CustomerID = @CustomerID </p>
<p>For more information, see Configuring Parameters and Parameter Data Types.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override CommandType CommandType { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandType_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When you set the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property to <strong>StoredProcedure</strong>, you should set the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property to the name of the stored procedure. The command executes this stored procedure when you call one of the Execute methods.</p>
<p>The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a SQL Statement or a stored procedure called with a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> of <a class="xref" href="System.Data.CommandType.html#System_Data_CommandType_Text">Text</a>. In this case, named parameters must be used. For example: </p>
<p>SELECT * FROM Customers WHERE CustomerID = @CustomerID </p>
<p>For more information, see Configuring Parameters and Parameter Data Types.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_CommandType_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and sets some of its properties.</p>Classic WebData IDbCommand.CommandTimeout Example#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>The value was not a valid <a class="xref" href="System.Data.CommandType.html#System_Data_CommandType">CommandType</a>. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_Connection.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.Connection%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L226">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_Connection" data-uid="System.Data.SqlClient.SqlCommand.Connection">Connection</h4>
              <div class="markdown level1 summary"><p>Gets or sets the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> used by this instance of the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_Connection_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If the command is enlisted in an existing transaction, and the connection is changed, trying to execute the command will throw an <a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a>.</p>
<p>If the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Transaction">Transaction</a> property is not null and the transaction has already been committed or rolled back, <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Transaction">Transaction</a> is set to null.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlConnection Connection { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_Connection_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If the command is enlisted in an existing transaction, and the connection is changed, trying to execute the command will throw an <a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a>.</p>
<p>If the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Transaction">Transaction</a> property is not null and the transaction has already been committed or rolled back, <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Transaction">Transaction</a> is set to null.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_Connection_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and sets some of its properties.</p>Classic WebData SqlCommand.Connection Example#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>The <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a> property was changed while the command was enlisted in a transaction.. </p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_DbConnection.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.DbConnection%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L278">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_DbConnection" data-uid="System.Data.SqlClient.SqlCommand.DbConnection">DbConnection</h4>
              <div class="markdown level1 summary"></div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">protected override DbConnection DbConnection { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_DbConnection_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_DbParameterCollection.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.DbParameterCollection%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L447">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_DbParameterCollection" data-uid="System.Data.SqlClient.SqlCommand.DbParameterCollection">DbParameterCollection</h4>
              <div class="markdown level1 summary"></div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">protected override DbParameterCollection DbParameterCollection { get; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_DbParameterCollection_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_DbTransaction.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.DbTransaction%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L332">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_DbTransaction" data-uid="System.Data.SqlClient.SqlCommand.DbTransaction">DbTransaction</h4>
              <div class="markdown level1 summary"></div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">protected override DbTransaction DbTransaction { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_DbTransaction_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_DesignTimeVisible.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.DesignTimeVisible%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L421">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_DesignTimeVisible" data-uid="System.Data.SqlClient.SqlCommand.DesignTimeVisible">DesignTimeVisible</h4>
              <div class="markdown level1 summary"><p>Gets or sets a value indicating whether the command object should be visible in a Windows Form Designer control.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override bool DesignTimeVisible { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Boolean.html#System_Boolean">Boolean</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_DesignTimeVisible_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_Parameters.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.Parameters%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L433">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_Parameters" data-uid="System.Data.SqlClient.SqlCommand.Parameters">Parameters</h4>
              <div class="markdown level1 summary"><p>Gets the <a class="xref" href="System.Data.SqlClient.SqlParameterCollection.html#System_Data_SqlClient_SqlParameterCollection">SqlParameterCollection</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_Parameters_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a SQL Statement or a stored procedure called by a command of <strong>CommandType.Text</strong>. In this case, named parameters must be used. For example: </p>
<p>SELECT * FROM Customers WHERE CustomerID = @CustomerID </p>
<p>If the parameters in the collection do not match the requirements of the query to be executed, an error may result.</p>
<p>For more information, see Configuring Parameters and Parameter Data Types.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlParameterCollection Parameters { get; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlParameterCollection.html#System_Data_SqlClient_SqlParameterCollection">SqlParameterCollection</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_Parameters_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The Microsoft .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to a SQL Statement or a stored procedure called by a command of <strong>CommandType.Text</strong>. In this case, named parameters must be used. For example: </p>
<p>SELECT * FROM Customers WHERE CustomerID = @CustomerID </p>
<p>If the parameters in the collection do not match the requirements of the query to be executed, an error may result.</p>
<p>For more information, see Configuring Parameters and Parameter Data Types.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_Parameters_examples">Examples</h5>
              
<p>The following example demonstrates how to create a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and add parameters to the <a class="xref" href="System.Data.SqlClient.SqlParameterCollection.html#System_Data_SqlClient_SqlParameterCollection">SqlParameterCollection</a>.</p>DataWorks SqlParameterCollection.AddWithValue#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_Transaction.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.Transaction%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L306">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_Transaction" data-uid="System.Data.SqlClient.SqlCommand.Transaction">Transaction</h4>
              <div class="markdown level1 summary"><p>Gets or sets the <a class="xref" href="System.Data.SqlClient.SqlTransaction.html#System_Data_SqlClient_SqlTransaction">SqlTransaction</a> within which the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> executes.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_Transaction_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You cannot set the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Transaction">Transaction</a> property if it is already set to a specific value, and the command is in the process of executing. If you set the transaction property to a <a class="xref" href="System.Data.SqlClient.SqlTransaction.html#System_Data_SqlClient_SqlTransaction">SqlTransaction</a> object that is not connected to the same <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> object, an exception is thrown the next time that you attempt to execute a statement.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlTransaction Transaction { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlTransaction.html#System_Data_SqlClient_SqlTransaction">SqlTransaction</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_Transaction_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You cannot set the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Transaction">Transaction</a> property if it is already set to a specific value, and the command is in the process of executing. If you set the transaction property to a <a class="xref" href="System.Data.SqlClient.SqlTransaction.html#System_Data_SqlClient_SqlTransaction">SqlTransaction</a> object that is not connected to the same <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> object, an exception is thrown the next time that you attempt to execute a statement.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_Transaction_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_UpdatedRowSource.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.UpdatedRowSource%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L455">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_UpdatedRowSource" data-uid="System.Data.SqlClient.SqlCommand.UpdatedRowSource">UpdatedRowSource</h4>
              <div class="markdown level1 summary"><p>Gets or sets how command results are applied to the <span class="xref">System.Data.DataRow</span> when used by the <strong>Update </strong>method of the <span class="xref">System.Data.Common.DbDataAdapter</span>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_UpdatedRowSource_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The default <a class="xref" href="System.Data.UpdateRowSource.html#System_Data_UpdateRowSource">UpdateRowSource</a> value is <strong>Both</strong> unless the command is automatically generated (as in the case of the <span class="xref">System.Data.SqlClient.SqlCommandBuilder</span>), in which case the default is <strong>None</strong>.</p>
<p>For more information about using the <strong>UpdatedRowSource</strong> property, see DataAdapter Parameters.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override UpdateRowSource UpdatedRowSource { get; set; }</code></pre>
              </div>
              <h5 class="propertyValue"></h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_UpdatedRowSource_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The default <a class="xref" href="System.Data.UpdateRowSource.html#System_Data_UpdateRowSource">UpdateRowSource</a> value is <strong>Both</strong> unless the command is automatically generated (as in the case of the <span class="xref">System.Data.SqlClient.SqlCommandBuilder</span>), in which case the default is <strong>None</strong>.</p>
<p>For more information about using the <strong>UpdatedRowSource</strong> property, see DataAdapter Parameters.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_UpdatedRowSource_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h3 id="methods">Methods
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_Cancel.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.Cancel%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L638">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_Cancel" data-uid="System.Data.SqlClient.SqlCommand.Cancel">Cancel()</h4>
              <div class="markdown level1 summary"><p>Tries to cancel the execution of a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_Cancel_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If there is nothing to cancel, nothing occurs. However, if there is a command in process, and the attempt to cancel fails, no exception is generated. </p>
<p>In some, rare, cases, if you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> then call <span class="xref">System.Data.SqlClient.SqlDataReader.Close</span> (implicitily or explicitly) before calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Cancel">Cancel()</a>, and then call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Cancel">Cancel()</a>, the cancel command will not be sent to SQL Server and the result set can continue to stream after you call <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection_Close">Close()</a>. To avoid this, make sure that you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Cancel">Cancel()</a> before closing the reader or connection.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override void Cancel()</code></pre>
              </div>
              <h5 id="System_Data_SqlClient_SqlCommand_Cancel_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If there is nothing to cancel, nothing occurs. However, if there is a command in process, and the attempt to cancel fails, no exception is generated. </p>
<p>In some, rare, cases, if you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> then call <span class="xref">System.Data.SqlClient.SqlDataReader.Close</span> (implicitily or explicitly) before calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Cancel">Cancel()</a>, and then call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Cancel">Cancel()</a>, the cancel command will not be sent to SQL Server and the result set can continue to stream after you call <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection_Close">Close()</a>. To avoid this, make sure that you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Cancel">Cancel()</a> before closing the reader or connection.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_Cancel_examples">Examples</h5>
              
<p>The following example demonstrates the use of the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Cancel">Cancel()</a> method.</p>Classic WebData SqlCommand.Cancel#1
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_CreateDbParameter.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.CreateDbParameter%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L724">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_CreateDbParameter" data-uid="System.Data.SqlClient.SqlCommand.CreateDbParameter">CreateDbParameter()</h4>
              <div class="markdown level1 summary"></div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">protected override DbParameter CreateDbParameter()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_CreateDbParameter_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_CreateParameter.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.CreateParameter%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L719">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_CreateParameter" data-uid="System.Data.SqlClient.SqlCommand.CreateParameter">CreateParameter()</h4>
              <div class="markdown level1 summary"><p>Creates a new instance of a <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter">SqlParameter</a> object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_CreateParameter_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CreateParameter">CreateParameter()</a> method is a strongly-typed version of <a class="xref" href="System.Data.IDbCommand.html#System_Data_IDbCommand_CreateParameter">CreateParameter()</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlParameter CreateParameter()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter">SqlParameter</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_CreateParameter_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CreateParameter">CreateParameter()</a> method is a strongly-typed version of <a class="xref" href="System.Data.IDbCommand.html#System_Data_IDbCommand_CreateParameter">CreateParameter()</a>.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_CreateParameter_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_Dispose_System_Boolean_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.Dispose(System.Boolean)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L729">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_Dispose_System_Boolean_" data-uid="System.Data.SqlClient.SqlCommand.Dispose(System.Boolean)">Dispose(Boolean)</h4>
              <div class="markdown level1 summary"></div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">protected override void Dispose(bool disposing)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Boolean.html#System_Boolean">Boolean</a></td>
                    <td><em>disposing</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_Dispose_System_Boolean__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteDbDataReader_System_Data_CommandBehavior_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(System.Data.CommandBehavior)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/ref/System.Data.SqlClient.cs/#L306">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteDbDataReader_System_Data_CommandBehavior_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(System.Data.CommandBehavior)">ExecuteDbDataReader(CommandBehavior)</h4>
              <div class="markdown level1 summary"></div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">protected override Common.DbDataReader ExecuteDbDataReader(CommandBehavior behavior)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a></td>
                    <td><em>behavior</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.Common.DbDataReader.html#System_Data_Common_DbDataReader">DbDataReader</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteDbDataReader_System_Data_CommandBehavior__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteDbDataReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteDbDataReaderAsync(System.Data.CommandBehavior%2CSystem.Threading.CancellationToken)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/ref/System.Data.SqlClient.cs/#L307">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteDbDataReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteDbDataReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)">ExecuteDbDataReaderAsync(CommandBehavior, CancellationToken)</h4>
              <div class="markdown level1 summary"></div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">protected override Task&lt;Common.DbDataReader&gt; ExecuteDbDataReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a></td>
                    <td><em>behavior</em></td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Threading.CancellationToken.html#System_Threading_CancellationToken">CancellationToken</a></td>
                    <td><em>cancellationToken</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.Tasks.Task%601.html#System_Threading_Tasks_Task_1">Task</a>&lt;<a class="xref" href="System.Data.Common.DbDataReader.html#System_Data_Common_DbDataReader">DbDataReader</a>&gt;</td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteDbDataReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteNonQuery.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteNonQuery%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L807">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteNonQuery" data-uid="System.Data.SqlClient.SqlCommand.ExecuteNonQuery">ExecuteNonQuery()</h4>
              <div class="markdown level1 summary"><p>Executes a Transact-SQL statement against the connection and returns the number of rows affected.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteNonQuery_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteNonQuery">ExecuteNonQuery()</a> to perform catalog operations (for example, querying the structure of a database or creating database objects such as tables), or to change the data in a database without using a <span class="xref">System.Data.DataSet</span> by executing UPDATE, INSERT, or DELETE statements.</p>
<p>Although the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteNonQuery">ExecuteNonQuery()</a> returns no rows, any output parameters or return values mapped to parameters are populated with data.</p>
<p>For UPDATE, INSERT, and DELETE statements, the return value is the number of rows affected by the command. When a trigger exists on a table being inserted or updated, the return value includes the number of rows affected by both the insert or update operation and the number of rows affected by the trigger or triggers. For all other types of statements, the return value is -1. If a rollback occurs, the return value is also -1.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override int ExecuteNonQuery()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Int32.html#System_Int32">Int32</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteNonQuery_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>You can use the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteNonQuery">ExecuteNonQuery()</a> to perform catalog operations (for example, querying the structure of a database or creating database objects such as tables), or to change the data in a database without using a <span class="xref">System.Data.DataSet</span> by executing UPDATE, INSERT, or DELETE statements.</p>
<p>Although the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteNonQuery">ExecuteNonQuery()</a> returns no rows, any output parameters or return values mapped to parameters are populated with data.</p>
<p>For UPDATE, INSERT, and DELETE statements, the return value is the number of rows affected by the command. When a trigger exists on a table being inserted or updated, the return value includes the number of rows affected by both the insert or update operation and the number of rows affected by the trigger or triggers. For all other types of statements, the return value is -1. If a rollback occurs, the return value is also -1.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteNonQuery_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and then executes it using <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteNonQuery">ExecuteNonQuery()</a>. The example is passed a string that is a Transact-SQL statement (such as UPDATE, INSERT, or DELETE) and a string to use to connect to the data source.</p>Classic WebData SqlCommand.ExecuteNonQuery Example#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>An exception occurred while executing the command against a locked row. This exception is not generated when you are using Microsoft .NET Framework version 1.0.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteNonQueryAsync_System_Threading_CancellationToken_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteNonQueryAsync(System.Threading.CancellationToken)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1512">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteNonQueryAsync_System_Threading_CancellationToken_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteNonQueryAsync(System.Threading.CancellationToken)">ExecuteNonQueryAsync(CancellationToken)</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteNonQuery">ExecuteNonQuery()</a>, which executes a Transact-SQL statement against the connection and returns the number of rows affected. The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.  Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteNonQueryAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override Task&lt;int&gt; ExecuteNonQueryAsync(CancellationToken cancellationToken)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.CancellationToken.html#System_Threading_CancellationToken">CancellationToken</a></td>
                    <td><em>cancellationToken</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.Tasks.Task%601.html#System_Threading_Tasks_Task_1">Task</a>&lt;<a class="xref" href="System.Int32.html#System_Int32">Int32</a>&gt;</td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteNonQueryAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteNonQueryAsync_System_Threading_CancellationToken__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteNonQueryAsync_System_Threading_CancellationToken_">ExecuteNonQueryAsync(CancellationToken)</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteReader.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteReader%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1325">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteReader" data-uid="System.Data.SqlClient.SqlCommand.ExecuteReader">ExecuteReader()</h4>
              <div class="markdown level1 summary"><p>Sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a> and builds a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReader_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property is set to <strong>StoredProcedure</strong>, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property should be set to the name of the stored procedure. The command executes this stored procedure when you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a>.</p>
<p>If a transaction is deadlocked, an exception may not be thrown until <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_Read">Read()</a> is called.</p>
<p>The multiple active result set (MARS) feature allows for multiple actions using the same connection.</p>
<p>If you use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> or <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each. To avoid this behavior, use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> or <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader"></see> to read FOR XML queries. For more information, see article Q310378, &quot;PRB: XML Data Is Truncated When You Use SqlDataReader,&quot; in the Microsoft Knowledge Base at <a href="http://support.microsoft.com">http://support.microsoft.com</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlDataReader ExecuteReader()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReader_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property is set to <strong>StoredProcedure</strong>, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property should be set to the name of the stored procedure. The command executes this stored procedure when you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a>.</p>
<p>If a transaction is deadlocked, an exception may not be thrown until <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_Read">Read()</a> is called.</p>
<p>The multiple active result set (MARS) feature allows for multiple actions using the same connection.</p>
<p>If you use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> or <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each. To avoid this behavior, use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> or <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader"></see> to read FOR XML queries. For more information, see article Q310378, &quot;PRB: XML Data Is Truncated When You Use SqlDataReader,&quot; in the Microsoft Knowledge Base at <a href="http://support.microsoft.com">http://support.microsoft.com</a>.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReader_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and then executes it by passing a string that is a Transact-SQL SELECT statement, and a string to use to connect to the data source.</p>Classic WebData SqlCommand.ExecuteReader Example#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>An exception occurred while executing the command against a locked row. This exception is not generated when you are using Microsoft .NET Framework version 1.0.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>The current state of the connection is closed. <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> requires an open <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteReader_System_Data_CommandBehavior_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteReader(System.Data.CommandBehavior)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/ref/System.Data.SqlClient.cs/#L311">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteReader_System_Data_CommandBehavior_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteReader(System.Data.CommandBehavior)">ExecuteReader(CommandBehavior)</h4>
              <div class="markdown level1 summary"><p>Sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>, and builds a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> using one of the <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a> values.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReader_System_Data_CommandBehavior__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property is set to <strong>StoredProcedure</strong>, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property should be set to the name of the stored procedure. The command executes this stored procedure when you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a>.</p>
<p>Use <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior_SequentialAccess">SequentialAccess</a> to retrieve large values and binary data. Otherwise, an <a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a> might occur and the connection will be closed.</p>
<p>The multiple active result set (MARS) feature allows for multiple actions using the same connection.</p>
<p>If you use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> or <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each. To avoid this behavior, use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> or <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader"></see> to read FOR XML queries. For more information, see article Q310378, &quot;PRB: XML Data Is Truncated When You Use SqlDataReader,&quot; in the Microsoft Knowledge Base at <a href="http://support.microsoft.com">http://support.microsoft.com</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public SqlDataReader ExecuteReader(CommandBehavior behavior)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a></td>
                    <td><em>behavior</em></td>
                    <td><p>One of the <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a> values.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> object.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReader_System_Data_CommandBehavior__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>When the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> property is set to <strong>StoredProcedure</strong>, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property should be set to the name of the stored procedure. The command executes this stored procedure when you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a>.</p>
<p>Use <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior_SequentialAccess">SequentialAccess</a> to retrieve large values and binary data. Otherwise, an <a class="xref" href="System.OutOfMemoryException.html#System_OutOfMemoryException">OutOfMemoryException</a> might occur and the connection will be closed.</p>
<p>The multiple active result set (MARS) feature allows for multiple actions using the same connection.</p>
<p>If you use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> or <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each. To avoid this behavior, use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> or <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader"></see> to read FOR XML queries. For more information, see article Q310378, &quot;PRB: XML Data Is Truncated When You Use SqlDataReader,&quot; in the Microsoft Knowledge Base at <a href="http://support.microsoft.com">http://support.microsoft.com</a>.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReader_System_Data_CommandBehavior__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and then executes it by passing a string that is a Transact-SQL SELECT statement, and a string to use to connect to the data source. <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a> is set to <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior_CloseConnection">CloseConnection</a>.</p>Classic WebData SqlCommand.ExecuteReader2#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteReaderAsync.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteReaderAsync%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1578">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync" data-uid="System.Data.SqlClient.SqlCommand.ExecuteReaderAsync">ExecuteReaderAsync()</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a>, which sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a> and builds a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Task&lt;SqlDataReader&gt; ExecuteReaderAsync()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.Tasks.Task%601.html#System_Threading_Tasks_Task_1">Task</a>&lt;<a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>&gt;</td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>An invalid <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a> value.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReaderAsync">ExecuteReaderAsync()</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/ref/System.Data.SqlClient.cs/#L313">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior)">ExecuteReaderAsync(CommandBehavior)</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader_System_Data_CommandBehavior_">ExecuteReader(CommandBehavior)</a>, which sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>, and builds a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Task&lt;SqlDataReader&gt; ExecuteReaderAsync(CommandBehavior behavior)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a></td>
                    <td><em>behavior</em></td>
                    <td><p>Options for statement execution and data retrieval.  When is set to <strong>Default</strong>, <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_ReadAsync_System_Threading_CancellationToken_">ReadAsync(CancellationToken)</a> reads the entire row before returning a complete Task.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.Tasks.Task%601.html#System_Threading_Tasks_Task_1">Task</a>&lt;<a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>&gt;</td>
                    <td><p>A task representing the asynchronous operation.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>An invalid <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a> value.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_">ExecuteReaderAsync(CommandBehavior)</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior%2CSystem.Threading.CancellationToken)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/ref/System.Data.SqlClient.cs/#L314">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Data.CommandBehavior,System.Threading.CancellationToken)">ExecuteReaderAsync(CommandBehavior, CancellationToken)</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader_System_Data_CommandBehavior_">ExecuteReader(CommandBehavior)</a>, which sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a>, and builds a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a></p>
<p>The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.  Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Task&lt;SqlDataReader&gt; ExecuteReaderAsync(CommandBehavior behavior, CancellationToken cancellationToken)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a></td>
                    <td><em>behavior</em></td>
                    <td><p>Options for statement execution and data retrieval.  When is set to <strong>Default</strong>, <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader_ReadAsync_System_Threading_CancellationToken_">ReadAsync(CancellationToken)</a> reads the entire row before returning a complete Task.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Threading.CancellationToken.html#System_Threading_CancellationToken">CancellationToken</a></td>
                    <td><em>cancellationToken</em></td>
                    <td><p>The cancellation instruction.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.Tasks.Task%601.html#System_Threading_Tasks_Task_1">Task</a>&lt;<a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>&gt;</td>
                    <td><p>A task representing the asynchronous operation.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>An invalid <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a> value.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_">ExecuteReaderAsync(CommandBehavior, CancellationToken)</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Threading_CancellationToken_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Threading.CancellationToken)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1588">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Threading_CancellationToken_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteReaderAsync(System.Threading.CancellationToken)">ExecuteReaderAsync(CancellationToken)</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a>, which sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a> and builds a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>.</p>
<p>The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.  Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Task&lt;SqlDataReader&gt; ExecuteReaderAsync(CancellationToken cancellationToken)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.CancellationToken.html#System_Threading_CancellationToken">CancellationToken</a></td>
                    <td><em>cancellationToken</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.Tasks.Task%601.html#System_Threading_Tasks_Task_1">Task</a>&lt;<a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>&gt;</td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Threading_CancellationToken__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ArgumentException.html#System_ArgumentException">ArgumentException</a></td>
                    <td><p>An invalid <a class="xref" href="System.Data.CommandBehavior.html#System_Data_CommandBehavior">CommandBehavior</a> value.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReaderAsync_System_Data_CommandBehavior_System_Threading_CancellationToken_">ExecuteReaderAsync(CommandBehavior, CancellationToken)</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteScalar.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteScalar%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L739">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteScalar" data-uid="System.Data.SqlClient.SqlCommand.ExecuteScalar">ExecuteScalar()</h4>
              <div class="markdown level1 summary"><p>Executes the query, and returns the first column of the first row in the result set returned by the query. Additional columns or rows are ignored.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteScalar_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>Use the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalar">ExecuteScalar()</a> method to retrieve a single value (for example, an aggregate value) from a database. This requires less code than using the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> method, and then performing the operations that you need to generate the single value using the data returned by a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>.</p></p>
<p><p>A typical <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalar">ExecuteScalar()</a> query can be formatted as in the following C# example: </p></p>
<pre><code> cmd.CommandText = "SELECT COUNT(*) FROM dbo.region";
Int32 count = (Int32) cmd.ExecuteScalar();</code></pre>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override object ExecuteScalar()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Object.html#System_Object">Object</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteScalar_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p><p>Use the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalar">ExecuteScalar()</a> method to retrieve a single value (for example, an aggregate value) from a database. This requires less code than using the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> method, and then performing the operations that you need to generate the single value using the data returned by a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>.</p></p>
<p><p>A typical <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalar">ExecuteScalar()</a> query can be formatted as in the following C# example: </p></p>
<pre><code> cmd.CommandText = "SELECT COUNT(*) FROM dbo.region";
Int32 count = (Int32) cmd.ExecuteScalar();</code></pre>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteScalar_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and then executes it using <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalar">ExecuteScalar()</a>. The example is passed a string representing a new value to be inserted into a table, and a string to use to connect to the data source. The function returns the new <strong>Identity</strong> column value if a new row was inserted, 0 on failure.</p>DataWorks SqlCommand.ExecuteScalar#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>An exception occurred while executing the command against a locked row. This exception is not generated when you are using Microsoft .NET Framework version 1.0.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1653">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteScalarAsync(System.Threading.CancellationToken)">ExecuteScalarAsync(CancellationToken)</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalar">ExecuteScalar()</a>, which executes the query asynchronously and returns the first column of the first row in the result set returned by the query. Additional columns or rows are ignored.</p>
<p>The cancellation token can be used to request that the operation be abandoned before the command timeout elapses. Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override Task&lt;object&gt; ExecuteScalarAsync(CancellationToken cancellationToken)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.CancellationToken.html#System_Threading_CancellationToken">CancellationToken</a></td>
                    <td><em>cancellationToken</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.Tasks.Task%601.html#System_Threading_Tasks_Task_1">Task</a>&lt;<a class="xref" href="System.Object.html#System_Object">Object</a>&gt;</td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken_">ExecuteScalarAsync(CancellationToken)</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteXmlReader.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteXmlReader%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1126">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReader" data-uid="System.Data.SqlClient.SqlCommand.ExecuteXmlReader">ExecuteXmlReader()</h4>
              <div class="markdown level1 summary"><p>Sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a> and builds an <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReader_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property ordinarily specifies a Transact-SQL statement with a valid FOR XML clause. However, <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> can also specify a statement that returns <strong>ntext</strong> or <strong>nvarchar</strong> data that contains valid XML, or the contents of a column defined with the <strong>xml</strong> data type. </p>
<p>A typical <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> query can be formatted as in the following Microsoft Visual C# example: </p>
<pre><code>SqlCommand command = new SqlCommand("SELECT * FROM dbo.Customers FOR XML AUTO, XMLDATA", SqlConn);</code></pre>
<p>This method can also be used to retrieve a single-row, single-column result set that contains XML data. In this case, if more than one row is returned, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> method attaches the <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> to the value on the first row, and discards the rest of the result set.</p>
<p>The multiple active result set (MARS) feature allows for multiple actions using the same connection.</p>
<p>If you use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> or <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each. To avoid this behavior, use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> or <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader"></see> to read FOR XML queries. For more information, see article Q310378, &quot;PRB: XML Data Is Truncated When You Use SqlDataReader,&quot; in the Microsoft Knowledge Base at <a href="http://support.microsoft.com">http://support.microsoft.com</a>.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public XmlReader ExecuteXmlReader()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReader_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>The <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> property ordinarily specifies a Transact-SQL statement with a valid FOR XML clause. However, <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> can also specify a statement that returns <strong>ntext</strong> or <strong>nvarchar</strong> data that contains valid XML, or the contents of a column defined with the <strong>xml</strong> data type. </p>
<p>A typical <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> query can be formatted as in the following Microsoft Visual C# example: </p>
<pre><code>SqlCommand command = new SqlCommand("SELECT * FROM dbo.Customers FOR XML AUTO, XMLDATA", SqlConn);</code></pre>
<p>This method can also be used to retrieve a single-row, single-column result set that contains XML data. In this case, if more than one row is returned, the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> method attaches the <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> to the value on the first row, and discards the rest of the result set.</p>
<p>The multiple active result set (MARS) feature allows for multiple actions using the same connection.</p>
<p>If you use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteReader">ExecuteReader()</a> or <span class="xref">System.Data.SqlClient.SqlCommand.BeginExecuteReader</span> to access XML data, SQL Server will return any XML results greater than 2,033 characters in length in multiple rows of 2,033 characters each. To avoid this behavior, use <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a> or <see cref="Overload:System.Data.SqlClient.SqlCommand.BeginExecuteXmlReader"></see> to read FOR XML queries. For more information, see article Q310378, &quot;PRB: XML Data Is Truncated When You Use SqlDataReader,&quot; in the Microsoft Knowledge Base at <a href="http://support.microsoft.com">http://support.microsoft.com</a>.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReader_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a> and then executes it using <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a>. The example is passed a string that is a Transact-SQL FOR XML SELECT statement, and a string to use to connect to the data source.</p>Classic WebData SqlCommand.ExecuteXmlReader#1
              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>An exception occurred while executing the command against a locked row. This exception is not generated when you are using Microsoft .NET Framework version 1.0.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteXmlReaderAsync%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1735">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync" data-uid="System.Data.SqlClient.SqlCommand.ExecuteXmlReaderAsync">ExecuteXmlReaderAsync()</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a>, which sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a> and builds an <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> object.</p>
<p>Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Task&lt;XmlReader&gt; ExecuteXmlReaderAsync()</code></pre>
              </div>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken_">ExecuteScalarAsync(CancellationToken)</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_System_Threading_CancellationToken_.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.ExecuteXmlReaderAsync(System.Threading.CancellationToken)%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L1740">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_System_Threading_CancellationToken_" data-uid="System.Data.SqlClient.SqlCommand.ExecuteXmlReaderAsync(System.Threading.CancellationToken)">ExecuteXmlReaderAsync(CancellationToken)</h4>
              <div class="markdown level1 summary"><p>An asynchronous version of <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteXmlReader">ExecuteXmlReader()</a>, which sends the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandText">CommandText</a> to the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Connection">Connection</a> and builds an <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> object.</p>
<p>The cancellation token can be used to request that the operation be abandoned before the command timeout elapses.  Exceptions will be reported via the returned Task object.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public Task&lt;XmlReader&gt; ExecuteXmlReaderAsync(CancellationToken cancellationToken)</code></pre>
              </div>
              <h5 class="parameters">Parameters</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Name</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Threading.CancellationToken.html#System_Threading_CancellationToken">CancellationToken</a></td>
                    <td><em>cancellationToken</em></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 class="returns">Returns</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_System_Threading_CancellationToken__remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>For more information about asynchronous programming in the .NET Framework Data Provider for SQL Server, see Asynchronous Programming.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_ExecuteXmlReaderAsync_System_Threading_CancellationToken__examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

              <h5 class="exceptions">Exceptions</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Condition</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.InvalidCastException.html#System_InvalidCastException">InvalidCastException</a></td>
                    <td><p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Binary or VarBinary was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>. For more information about streaming, see SqlClient Streaming Support.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Char, NChar, NVarChar, VarChar, or  Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a>.</p>
<p>A <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_SqlDbType">SqlDbType</a> other than Xml was used when <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Value">Value</a> was set to <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a>.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a></td>
                    <td><p>Calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_ExecuteScalarAsync_System_Threading_CancellationToken_">ExecuteScalarAsync(CancellationToken)</a> more than once for the same instance before task completion.</p>
<p>The <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> closed or dropped during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
<p>
<strong>Context Connection=true</strong> is specified in the connection string.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.Data.SqlClient.SqlException.html#System_Data_SqlClient_SqlException">SqlException</a></td>
                    <td><p>SQL Server returned an error while executing the command text.</p>
<p>A timeout occurred during a streaming operation. For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.IO.IOException.html#System_IO_IOException">IOException</a></td>
                    <td><p>An error occurred in a <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                  <tr>
                    <td><a class="xref" href="System.ObjectDisposedException.html#System_ObjectDisposedException">ObjectDisposedException</a></td>
                    <td><p>The <a class="xref" href="System.IO.Stream.html#System_IO_Stream">Stream</a>, <a class="xref" href="System.Xml.XmlReader.html#System_Xml_XmlReader">XmlReader</a> or <a class="xref" href="System.IO.TextReader.html#System_IO_TextReader">TextReader</a> object was closed during a streaming operation.  For more information about streaming, see SqlClient Streaming Support.</p>
</td>
                  </tr>
                </tbody>
              </table>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_Prepare.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.Prepare%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L516">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_Prepare" data-uid="System.Data.SqlClient.SqlCommand.Prepare">Prepare()</h4>
              <div class="markdown level1 summary"><p>Creates a prepared version of the command on an instance of SQL Server.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 id="System_Data_SqlClient_SqlCommand_Prepare_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> is set to <strong>StoredProcedure</strong>, the call to <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> should succeed, although it may cause a no-op.</p>
<p>Before you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a>, specify the data type of each parameter in the statement to be prepared. For each parameter that has a variable length data type, you must set the <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Size">Size</a> property to the maximum size needed. <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> returns an error if these conditions are not met.</p>
<p>If the database context is changed by executing the Transact-SQL <strong>USE <database></database></strong> statement, or by calling the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection_ChangeDatabase_System_String_">ChangeDatabase(String)</a> method, then <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> must be called a second time.</p>
<p>If you call an <strong>Execute</strong> method after calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a>, any parameter value that is larger than the value specified by the <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Size">Size</a> property is automatically truncated to the original specified size of the parameter, and no truncation errors are returned.</p>
<p>Output parameters (whether prepared or not) must have a user-specified data type. If you specify a variable length data type, you must also specify the maximum <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Size">Size</a>.</p>
<p>Prior to Visual Studio 2010, <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> threw an exception.  Beginning in Visual Studio 2010, this method does not throw an exception.</p>
</div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public override void Prepare()</code></pre>
              </div>
              <h5 id="System_Data_SqlClient_SqlCommand_Prepare_remarks">Remarks</h5>
              <div class="markdown level1 remarks"><p>If <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_CommandType">CommandType</a> is set to <strong>StoredProcedure</strong>, the call to <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> should succeed, although it may cause a no-op.</p>
<p>Before you call <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a>, specify the data type of each parameter in the statement to be prepared. For each parameter that has a variable length data type, you must set the <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Size">Size</a> property to the maximum size needed. <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> returns an error if these conditions are not met.</p>
<p>If the database context is changed by executing the Transact-SQL <strong>USE <database></database></strong> statement, or by calling the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection_ChangeDatabase_System_String_">ChangeDatabase(String)</a> method, then <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> must be called a second time.</p>
<p>If you call an <strong>Execute</strong> method after calling <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a>, any parameter value that is larger than the value specified by the <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Size">Size</a> property is automatically truncated to the original specified size of the parameter, and no truncation errors are returned.</p>
<p>Output parameters (whether prepared or not) must have a user-specified data type. If you specify a variable length data type, you must also specify the maximum <a class="xref" href="System.Data.SqlClient.SqlParameter.html#System_Data_SqlClient_SqlParameter_Size">Size</a>.</p>
<p>Prior to Visual Studio 2010, <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> threw an exception.  Beginning in Visual Studio 2010, this method does not throw an exception.</p>
</div>
              <h5 id="System_Data_SqlClient_SqlCommand_Prepare_examples">Examples</h5>
              
<p>The following example demonstrates the use of the <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand_Prepare">Prepare()</a> method.</p>Classic WebData SqlCommand.Prepare#1
              <h3 id="events">Events
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Data_SqlClient_SqlCommand_StatementCompleted.md&amp;value=---%0Auid%3A%20System.Data.SqlClient.SqlCommand.StatementCompleted%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Data.SqlClient/src/System/Data/SqlClient/SqlCommand.cs/#L477">View Source</a>
              </span>
              <h4 id="System_Data_SqlClient_SqlCommand_StatementCompleted" data-uid="System.Data.SqlClient.SqlCommand.StatementCompleted">StatementCompleted</h4>
              <div class="markdown level1 summary"><p>Occurs when the execution of a Transact-SQL statement completes.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public event StatementCompletedEventHandler StatementCompleted</code></pre>
              </div>
              <h5 class="eventType">Event Type</h5>
              <table class="table table-bordered table-striped table-condensed">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a class="xref" href="System.Data.StatementCompletedEventHandler.html#System_Data_StatementCompletedEventHandler">StatementCompletedEventHandler</a></td>
                    <td></td>
                  </tr>
                </tbody>
              </table>
              <h5 id="System_Data_SqlClient_SqlCommand_StatementCompleted_examples">Examples</h5>
              
<p>The following example creates a <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a>, a <a class="xref" href="System.Data.SqlClient.SqlCommand.html#System_Data_SqlClient_SqlCommand">SqlCommand</a>, and a <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a>. The example reads through the data, writing it to the console. Finally, the example closes the <a class="xref" href="System.Data.SqlClient.SqlDataReader.html#System_Data_SqlClient_SqlDataReader">SqlDataReader</a> and then the <a class="xref" href="System.Data.SqlClient.SqlConnection.html#System_Data_SqlClient_SqlConnection">SqlConnection</a> as it exits the <strong>Using</strong> code blocks.</p>Classic WebData SqlCommand Example#1
              
<p>The following sample shows how to create and execute different types of SqlCommand objects.</p>
<p>First you must create the sample database, by executing the following script: </p>
<pre><code>USE [master]
GO

CREATE DATABASE [MySchool]
GO

USE [MySchool]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[CourseExtInfo] @CourseId int
as
select c.CourseID,c.Title,c.Credits,d.Name as DepartmentName
from Course as c left outer join Department as d on c.DepartmentID=d.DepartmentID
where c.CourseID=@CourseId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create procedure [dbo].[DepartmentInfo] @DepartmentId int,@CourseCount int output
as
select @CourseCount=Count(c.CourseID)
from course as c
where c.DepartmentID=@DepartmentId

select d.DepartmentID,d.Name,d.Budget,d.StartDate,d.Administrator
from Department as d
where d.DepartmentID=@DepartmentId

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
Create PROCEDURE [dbo].[GetDepartmentsOfSpecifiedYear] 
@Year int,@BudgetSum money output
AS
BEGIN
SELECT @BudgetSum=SUM([Budget])
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year 

SELECT [DepartmentID]
,[Name]
,[Budget]
,[StartDate]
,[Administrator]
FROM [MySchool].[dbo].[Department]
Where YEAR([StartDate])=@Year

END
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Course](
[CourseID] [nvarchar](10) NOT NULL,
[Year] [smallint] NOT NULL,
[Title] [nvarchar](100) NOT NULL,
[Credits] [int] NOT NULL,
[DepartmentID] [int] NOT NULL,
CONSTRAINT [PK_Course] PRIMARY KEY CLUSTERED 
(
[CourseID] ASC,
[Year] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Department](
[DepartmentID] [int] IDENTITY(1,1) NOT NULL,
[Name] [nvarchar](50) NOT NULL,
[Budget] [money] NOT NULL,
[StartDate] [datetime] NOT NULL,
[Administrator] [int] NULL,
CONSTRAINT [PK_Department] PRIMARY KEY CLUSTERED 
(
[DepartmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Person](
[PersonID] [int] IDENTITY(1,1) NOT NULL,
[LastName] [nvarchar](50) NOT NULL,
[FirstName] [nvarchar](50) NOT NULL,
[HireDate] [datetime] NULL,
[EnrollmentDate] [datetime] NULL,
CONSTRAINT [PK_School.Student] PRIMARY KEY CLUSTERED 
(
[PersonID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StudentGrade](
[EnrollmentID] [int] IDENTITY(1,1) NOT NULL,
[CourseID] [nvarchar](10) NOT NULL,
[StudentID] [int] NOT NULL,
[Grade] [decimal](3, 2) NOT NULL,
CONSTRAINT [PK_StudentGrade] PRIMARY KEY CLUSTERED 
(
[EnrollmentID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create view [dbo].[EnglishCourse]
as
select c.CourseID,c.Title,c.Credits,c.DepartmentID
from Course as c join Department as d on c.DepartmentID=d.DepartmentID
where d.Name=N'English'

GO
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1045', 2012, N'Calculus', 4, 7)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C1061', 2012, N'Physics', 4, 1)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2021', 2012, N'Composition', 3, 2)
INSERT [dbo].[Course] ([CourseID], [Year], [Title], [Credits], [DepartmentID]) VALUES (N'C2042', 2012, N'Literature', 4, 2)
SET IDENTITY_INSERT [dbo].[Department] ON 

INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (1, N'Engineering', 350000.0000, CAST(0x0000999C00000000 AS DateTime), 2)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (2, N'English', 120000.0000, CAST(0x0000999C00000000 AS DateTime), 6)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (4, N'Economics', 200000.0000, CAST(0x0000999C00000000 AS DateTime), 4)
INSERT [dbo].[Department] ([DepartmentID], [Name], [Budget], [StartDate], [Administrator]) VALUES (7, N'Mathematics', 250024.0000, CAST(0x0000999C00000000 AS DateTime), 3)
SET IDENTITY_INSERT [dbo].[Department] OFF
SET IDENTITY_INSERT [dbo].[Person] ON 

INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (1, N'Hu', N'Nan', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (2, N'Norman', N'Laura', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (3, N'Olivotto', N'Nino', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (4, N'Anand', N'Arturo', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (5, N'Jai', N'Damien', NULL, CAST(0x0000A0BF00000000 AS DateTime))
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (6, N'Holt', N'Roger', CAST(0x000097F100000000 AS DateTime), NULL)
INSERT [dbo].[Person] ([PersonID], [LastName], [FirstName], [HireDate], [EnrollmentDate]) VALUES (7, N'Martin', N'Randall', CAST(0x00008B1A00000000 AS DateTime), NULL)
SET IDENTITY_INSERT [dbo].[Person] OFF
SET IDENTITY_INSERT [dbo].[StudentGrade] ON 

INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (1, N'C1045', 1, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (2, N'C1045', 2, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (3, N'C1045', 3, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (4, N'C1045', 4, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (5, N'C1045', 5, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (6, N'C1061', 1, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (7, N'C1061', 3, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (8, N'C1061', 4, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (9, N'C1061', 5, CAST(1.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (10, N'C2021', 1, CAST(2.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (11, N'C2021', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (12, N'C2021', 4, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (13, N'C2021', 5, CAST(3.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (14, N'C2042', 1, CAST(2.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (15, N'C2042', 2, CAST(3.50 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (16, N'C2042', 3, CAST(4.00 AS Decimal(3, 2)))
INSERT [dbo].[StudentGrade] ([EnrollmentID], [CourseID], [StudentID], [Grade]) VALUES (17, N'C2042', 5, CAST(3.00 AS Decimal(3, 2)))
SET IDENTITY_INSERT [dbo].[StudentGrade] OFF
ALTER TABLE [dbo].[Course]  WITH CHECK ADD  CONSTRAINT [FK_Course_Department] FOREIGN KEY([DepartmentID])
REFERENCES [dbo].[Department] ([DepartmentID])
GO
ALTER TABLE [dbo].[Course] CHECK CONSTRAINT [FK_Course_Department]
GO
ALTER TABLE [dbo].[StudentGrade]  WITH CHECK ADD  CONSTRAINT [FK_StudentGrade_Student] FOREIGN KEY([StudentID])
REFERENCES [dbo].[Person] ([PersonID])
GO
ALTER TABLE [dbo].[StudentGrade] CHECK CONSTRAINT [FK_StudentGrade_Student]
GO</code></pre>
<p>Next, compile and execute the following:</p>
<pre><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Threading.Tasks;

class Program {

static class SqlHelper {
// Set the connection, command, and then execute the command with non query.
public static Int32 ExecuteNonQuery(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       // There're three command types: StoredProcedure, Text, TableDirect. The TableDirect 
       // type is only for OLE DB.  
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteNonQuery();
    }
 }
}

// Set the connection, command, and then execute the command and only return one value.
public static Object ExecuteScalar(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 using (SqlConnection conn = new SqlConnection(connectionString)) {
    using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
       cmd.CommandType = commandType;
       cmd.Parameters.AddRange(parameters);

       conn.Open();
       return cmd.ExecuteScalar();
    }
 }
}

// Set the connection, command, and then execute the command with query and return the reader.
public static SqlDataReader ExecuteReader(String connectionString, String commandText,
  CommandType commandType, params SqlParameter[] parameters) {
 SqlConnection conn = new SqlConnection(connectionString);

 using (SqlCommand cmd = new SqlCommand(commandText, conn)) {
    cmd.CommandType = commandType;
    cmd.Parameters.AddRange(parameters);

    conn.Open();
    // When using CommandBehavior.CloseConnection, the connection will be closed when the 
    // IDataReader is closed.
    SqlDataReader reader = cmd.ExecuteReader(CommandBehavior.CloseConnection);

    return reader;
 }
}
}

static void Main(string[] args) {
String connectionString = "Data Source=(local);Initial Catalog=MySchool;Integrated Security=True;Asynchronous Processing=true;";

CountCourses(connectionString, 2012);
Console.WriteLine();

Console.WriteLine("Following result is the departments that started from 2007:");
GetDepartments(connectionString, 2007);
Console.WriteLine();

Console.WriteLine("Add the credits when the credits of course is lower than 4.");
AddCredits(connectionString, 4);
Console.WriteLine();

Console.WriteLine("Please press any key to exit...");
Console.ReadKey();
}

static void CountCourses(String connectionString, Int32 year) {
String commandText = "Select Count([CourseID]) FROM [MySchool].[dbo].[Course] Where Year=@Year";
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

Object oValue = SqlHelper.ExecuteScalar(connectionString, commandText, CommandType.Text, parameterYear);
Int32 count;
if (Int32.TryParse(oValue.ToString(), out count))
 Console.WriteLine("There {0} {1} course{2} in {3}.", count > 1 ? "are" : "is", count, count > 1 ? "s" : null, year);
}

// Display the Departments that start from the specified year.
static void GetDepartments(String connectionString, Int32 year) {
String commandText = "dbo.GetDepartmentsOfSpecifiedYear";

// Specify the year of StartDate
SqlParameter parameterYear = new SqlParameter("@Year", SqlDbType.Int);
parameterYear.Value = year;

// When the direction of parameter is set as Output, you can get the value after 
// executing the command.
SqlParameter parameterBudget = new SqlParameter("@BudgetSum", SqlDbType.Money);
parameterBudget.Direction = ParameterDirection.Output;

using (SqlDataReader reader = SqlHelper.ExecuteReader(connectionString, commandText,
  CommandType.StoredProcedure, parameterYear, parameterBudget)) {
 Console.WriteLine("{0,-20}{1,-20}{2,-20}{3,-20}", "Name", "Budget", "StartDate",
     "Administrator");
 while (reader.Read()) {
    Console.WriteLine("{0,-20}{1,-20:C}{2,-20:d}{3,-20}", reader["Name"],
        reader["Budget"], reader["StartDate"], reader["Administrator"]);
 }
}
Console.WriteLine("{0,-20}{1,-20:C}", "Sum:", parameterBudget.Value);
}

// If credits of course is lower than the certain value, the method will add the credits.
static void AddCredits(String connectionString, Int32 creditsLow) {
String commandText = "Update [MySchool].[dbo].[Course] Set Credits=Credits+1 Where Credits<@credits"; sqlparameter="" parametercredits="new" sqlparameter("@credits",="" creditslow);="" int32="" rows="SqlHelper.ExecuteNonQuery(connectionString," commandtext,="" commandtype.text,="" parametercredits);="" console.writeline("{0}="" row{1}="" {2}="" updated.",="" rows,="" rows=""> 1 ? "s" : null, rows > 1 ? "are" : "is");
}
}</@credits";></code></pre>

            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
            <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
            </nav>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="inner-footer">
          <p>© .NET Foundation</p>
          <p>
            <a href="https://www.github.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-github fa-stack-1x"></span>
            </span></a>
            <a href="https://twitter.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-twitter fa-stack-1x"></span>
            </span></a>
            <a href="https://www.facebook.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-facebook fa-stack-1x"></span>
            </span></a>
      
          </p>
          </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
