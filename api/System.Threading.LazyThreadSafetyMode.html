<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Enum LazyThreadSafetyMode
   | CoreCLR site </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Enum LazyThreadSafetyMode
   | CoreCLR site ">
    
    <link rel="shortcut icon" href="../images/Logo_DotNet.png" type="image/x-icon">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/style.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
    ga('create', 'UA-63735192-1', 'auto');
    ga('send', 'pageview');
    </script>
  </head>  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        
        <nav class="navbar navbar-inverse">
             <div class="container">
               <a href="../"><img height="50px" src="../images/Logo_DotNet.png" style="float:right;"></a>
               <div class="navbar-header ">
                 <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                   <span class="sr-only">Toggle navigation</span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                   <span class="icon-bar"></span>
                 </button>
                 <a class="navbar-brand" href="../"><span class="dotnet">.NET Core</span></a>
               </div>
               <div id="navbar" class="collapse navbar-collapse">
               </div><!--/.nav-collapse -->
             </div>
           </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content">
              
              <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Threading_LazyThreadSafetyMode.md&amp;value=---%0Auid%3A%20System.Threading.LazyThreadSafetyMode%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A" class="pull-right mobile-hide"><span class="fa fa-github"></span>Improve this Doc</a>
              <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime/ref/System.Runtime.cs/#L3191" class="pull-right mobile-hide">View Source</a>
              <h1 id="System_Threading_LazyThreadSafetyMode" data-uid="System.Threading.LazyThreadSafetyMode">Enum LazyThreadSafetyMode
              </h1>
              <div class="markdown level0 summary"><p>Specifies how a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance synchronizes access among multiple threads.</p>
</div>
              <div class="markdown level0 conceptual"></div>
              <h6><strong>Namespace</strong>:System.Threading</h6>
              <h6><strong>Assembly</strong>:System.Runtime.dll</h6>
              <h5 id="System_Threading_LazyThreadSafetyMode_syntax">Syntax</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">public enum LazyThreadSafetyMode</code></pre>
              </div>
              <h5 id="System_Threading_LazyThreadSafetyMode_remarks"><strong>Remarks</strong></h5>
              <div class="markdown level0 remarks"><p>Use this enumeration to specify the <em>mode</em> parameter of <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> constructors. The effects of all constructors on thread synchronization can be described in terms of this enumeration, whether or not they have <em>mode</em> parameters.</p>
<p>
    A <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance is initialized either by a user-specified initialization method or by the default constructor for <em>T</em>. The initialization method is specified by the <em>valueFactory</em> parameter of a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> constructor. The method returns an instance of <em>T</em>, which is the type that is lazily instantiated by the instance of <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a>. If a constructor does not have a <em>valueFactory</em> parameter, the default constructor for <em>T</em> is used to initialize the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance. In either case, initialization occurs the first time you call the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property.</p>
<p>
    In addition to specifying the thread safety of a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance, this enumeration affects exception caching. When exceptions are cached for a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance, you get only one chance to initialize the instance. If an exception is thrown the first time you call the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property, that exception is cached and rethrown on all subsequent calls to the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property. The advantage of caching exceptions is that any two threads always get the same result, even when errors occur.</p>
<p>
    When you specify the <a class="xref" href="System.Threading.LazyThreadSafetyMode.html#System_Threading_LazyThreadSafetyMode_PublicationOnly">PublicationOnly</a> mode, exceptions are never cached. When you specify <a class="xref" href="System.Threading.LazyThreadSafetyMode.html#System_Threading_LazyThreadSafetyMode_None">None</a> or <a class="xref" href="System.Threading.LazyThreadSafetyMode.html#System_Threading_LazyThreadSafetyMode_ExecutionAndPublication">ExecutionAndPublication</a>, caching depends on whether you specify an initialization method or allow the default constructor for <em>T</em> to be used. Specifying an initialization method enables exception caching for these two modes. The initialization method can be very simple. For example, it might call the default constructor for <em>T</em>: <code>new Lazy<contents>(() => new Contents(), mode)</contents></code> in C#, or <code>New Lazy(Of Contents)(Function() New Contents())</code> in Visual Basic. If you use a constructor that does not specify an initialization method, exceptions that are thrown by the default constructor for <em>T</em> are not cached. The following table summarizes exception caching behavior.</p>
<p>Mode</p>
<p>Using initialization method</p>
<p>Using default constructor for <em>T</em></p>
</div>
              <h3 id="fields">Fields
              </h3>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Threading_LazyThreadSafetyMode_ExecutionAndPublication.md&amp;value=---%0Auid%3A%20System.Threading.LazyThreadSafetyMode.ExecutionAndPublication%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime/ref/System.Runtime.cs/#L3193">View Source</a>
              </span>
              <h4 id="System_Threading_LazyThreadSafetyMode_ExecutionAndPublication" data-uid="System.Threading.LazyThreadSafetyMode.ExecutionAndPublication">ExecutionAndPublication</h4>
              <div class="markdown level1 summary"><p>Locks are used to ensure that only a single thread can initialize a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance in a thread-safe manner. If the initialization method (or the default constructor, if there is no initialization method) uses locks internally, deadlocks can occur. If you use a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> constructor that specifies an initialization method (<em>valueFactory</em> parameter), and if that initialization method throws an exception (or fails to handle an exception) the first time you call the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property, then the exception is cached and thrown again on subsequent calls to the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property. If you use a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> constructor that does not specify an initialization method, exceptions that are thrown by the default constructor for <em>T</em> are not cached. In that case, a subsequent call to the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property might successfully initialize the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance. If the initialization method recursively accesses the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property of the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance, an <a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a> is thrown.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">ExecutionAndPublication = 2</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Threading_LazyThreadSafetyMode_None.md&amp;value=---%0Auid%3A%20System.Threading.LazyThreadSafetyMode.None%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime/ref/System.Runtime.cs/#L3194">View Source</a>
              </span>
              <h4 id="System_Threading_LazyThreadSafetyMode_None" data-uid="System.Threading.LazyThreadSafetyMode.None">None</h4>
              <div class="markdown level1 summary"><p>The <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance is not thread safe; if the instance is accessed from multiple threads, its behavior is undefined. Use this mode only when high performance is crucial and the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance is guaranteed never to be initialized from more than one thread. If you use a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> constructor that specifies an initialization method (<em>valueFactory</em> parameter), and if that initialization method throws an exception (or fails to handle an exception) the first time you call the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property, then the exception is cached and thrown again on subsequent calls to the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property. If you use a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> constructor that does not specify an initialization method, exceptions that are thrown by the default constructor for <em>T</em> are not cached. In that case, a subsequent call to the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property might successfully initialize the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance. If the initialization method recursively accesses the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property of the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance, an <a class="xref" href="System.InvalidOperationException.html#System_InvalidOperationException">InvalidOperationException</a> is thrown.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">None = 0</code></pre>
              </div>
              <span class="small pull-right mobile-hide">
                <span class="divider">|</span>
                <a href="https://github.com/dotnet/core-docs/new/master/apispec/new?filename=System_Threading_LazyThreadSafetyMode_PublicationOnly.md&amp;value=---%0Auid%3A%20System.Threading.LazyThreadSafetyMode.PublicationOnly%0Asummary%3A%20'*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax'%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">Improve this Doc</a>
              </span>
              <span class="small pull-right mobile-hide">
                <a href="https://github.com/dotnet/corefx/blob/master/src/System.Runtime/ref/System.Runtime.cs/#L3195">View Source</a>
              </span>
              <h4 id="System_Threading_LazyThreadSafetyMode_PublicationOnly" data-uid="System.Threading.LazyThreadSafetyMode.PublicationOnly">PublicationOnly</h4>
              <div class="markdown level1 summary"><p>When multiple threads try to initialize a <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance simultaneously, all threads are allowed to run the initialization method (or the default constructor, if there is no initialization method). The first thread to complete initialization sets the value of the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance. That value is returned to any other threads that were simultaneously running the initialization method, unless the initialization method throws exceptions on those threads. Any instances of <em>T</em> that were created by the competing threads are discarded. If the initialization method throws an exception on any thread, the exception is propagated out of the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property on that thread. The exception is not cached. The value of the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_IsValueCreated">IsValueCreated</a> property remains <strong>false</strong>, and subsequent calls to the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property, either by the thread where the exception was thrown or by other threads, cause the initialization method to run again. If the initialization method recursively accesses the <a class="xref" href="System.Lazy%601.html#System_Lazy_1_Value">Value</a> property of the <a class="xref" href="System.Lazy%601.html#System_Lazy_1">Lazy<t></t></a> instance, no exception is thrown.</p>
</div>
              <div class="markdown level1 conceptual"></div>
              <h5 class="decalaration">Declaration</h5>
              <div class="codewrapper">
                <pre><code class="lang-csharp hljs">PublicationOnly = 1</code></pre>
              </div>
            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
            <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
            </nav>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="inner-footer">
          <p>© .NET Foundation</p>
          <p>
            <a href="https://www.github.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-github fa-stack-1x"></span>
            </span></a>
            <a href="https://twitter.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-twitter fa-stack-1x"></span>
            </span></a>
            <a href="https://www.facebook.com/dotnet" target="_blank"><span class="fa fa-stack fa-lg">
              <span class="fa fa-square-o fa-stack-2x"></span>
              <span class="fa fa-facebook fa-stack-1x"></span>
            </span></a>
      
          </p>
          </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>
